"use strict";(globalThis.webpackChunkappraisys_technical_documentation=globalThis.webpackChunkappraisys_technical_documentation||[]).push([[8214],{708:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>i,metadata:()=>l,toc:()=>p});const l=JSON.parse('{"id":"Code examples/table-creation","title":"Table Creation Code Examples","description":"Basic Table Creation","source":"@site/docs/05-Code examples/02-table-creation.md","sourceDirName":"05-Code examples","slug":"/Code examples/table-creation","permalink":"/docs/Code examples/table-creation","draft":false,"unlisted":false,"editUrl":"https://gitlab.devcom.com/appraisys/Atlas/docs/05-Code examples/02-table-creation.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Creating Documents from Scratch","permalink":"/docs/Code examples/creating-documents"},"next":{"title":"Troubleshooting Guide","permalink":"/docs/Appendices/troubleshooting-guide"}}');var a=n(4848),t=n(8453);const i={},d="Table Creation Code Examples",o={},p=[{value:"Basic Table Creation",id:"basic-table-creation",level:2},{value:"Simple 2x2 Table",id:"simple-2x2-table",level:3},{value:"AppraiSys Pattern: Executive Summary Table",id:"appraisys-pattern-executive-summary-table",level:2},{value:"Advanced Cell Creation",id:"advanced-cell-creation",level:2},{value:"Cell with Alignment and Formatting",id:"cell-with-alignment-and-formatting",level:3},{value:"Cell Merging",id:"cell-merging",level:2},{value:"Horizontal Merge (Spanning Columns)",id:"horizontal-merge-spanning-columns",level:3},{value:"Vertical Merge (Spanning Rows)",id:"vertical-merge-spanning-rows",level:3},{value:"Property Images Table (AppraiSys)",id:"property-images-table-appraisys",level:2},{value:"Table with Custom Borders",id:"table-with-custom-borders",level:2},{value:"Dynamic Table Generation",id:"dynamic-table-generation",level:2},{value:"Create Table from Data",id:"create-table-from-data",level:3},{value:"Nested Tables",id:"nested-tables",level:2},{value:"Table Inside Table Cell",id:"table-inside-table-cell",level:3},{value:"Helper Methods",id:"helper-methods",level:2},{value:"Create Paragraph",id:"create-paragraph",level:3},{value:"Complete Example: Comparables Table",id:"complete-example-comparables-table",level:2},{value:"Next Steps",id:"next-steps",level:2}];function s(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.header,{children:(0,a.jsx)(r.h1,{id:"table-creation-code-examples",children:"Table Creation Code Examples"})}),"\n",(0,a.jsx)(r.h2,{id:"basic-table-creation",children:"Basic Table Creation"}),"\n",(0,a.jsx)(r.h3,{id:"simple-2x2-table",children:"Simple 2x2 Table"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-csharp",children:'using DocumentFormat.OpenXml.Wordprocessing;\r\n\r\npublic static Table CreateSimpleTable()\r\n{\r\n    var table = new Table();\r\n    \r\n    // Table properties\r\n    var tableProperties = new TableProperties(\r\n        new TableWidth { Width = "5000", Type = TableWidthUnitValues.Pct },\r\n        new TableBorders(\r\n            new TopBorder { Val = BorderValues.Single, Size = 4 },\r\n            new BottomBorder { Val = BorderValues.Single, Size = 4 },\r\n            new LeftBorder { Val = BorderValues.Single, Size = 4 },\r\n            new RightBorder { Val = BorderValues.Single, Size = 4 },\r\n            new InsideHorizontalBorder { Val = BorderValues.Single, Size = 4 },\r\n            new InsideVerticalBorder { Val = BorderValues.Single, Size = 4 }\r\n        )\r\n    );\r\n    table.AppendChild(tableProperties);\r\n    \r\n    // Table grid (2 columns)\r\n    var tableGrid = new TableGrid(\r\n        new GridColumn { Width = "3000" },\r\n        new GridColumn { Width = "3000" }\r\n    );\r\n    table.AppendChild(tableGrid);\r\n    \r\n    // Row 1\r\n    var row1 = new TableRow();\r\n    row1.AppendChild(new TableRowProperties(new CantSplit()));\r\n    row1.AppendChild(CreateCell("Header 1", 3000, bold: true));\r\n    row1.AppendChild(CreateCell("Header 2", 3000, bold: true));\r\n    table.AppendChild(row1);\r\n    \r\n    // Row 2\r\n    var row2 = new TableRow();\r\n    row2.AppendChild(new TableRowProperties(new CantSplit()));\r\n    row2.AppendChild(CreateCell("Data 1", 3000));\r\n    row2.AppendChild(CreateCell("Data 2", 3000));\r\n    table.AppendChild(row2);\r\n    \r\n    return table;\r\n}\r\n\r\nprivate static TableCell CreateCell(string text, int width, bool bold = false)\r\n{\r\n    var cell = new TableCell();\r\n    \r\n    // Cell properties\r\n    cell.AppendChild(new TableCellProperties(\r\n        new TableCellWidth { Width = width.ToString(), Type = TableWidthUnitValues.Dxa }\r\n    ));\r\n    \r\n    // Paragraph with text\r\n    var paragraph = new Paragraph();\r\n    var run = new Run();\r\n    \r\n    if (bold)\r\n    {\r\n        run.AppendChild(new RunProperties(new Bold()));\r\n    }\r\n    \r\n    run.AppendChild(new Text(text));\r\n    paragraph.AppendChild(run);\r\n    cell.AppendChild(paragraph);\r\n    \r\n    return cell;\r\n}\n'})}),"\n",(0,a.jsx)(r.hr,{}),"\n",(0,a.jsx)(r.h2,{id:"appraisys-pattern-executive-summary-table",children:"AppraiSys Pattern: Executive Summary Table"}),"\n",(0,a.jsxs)(r.p,{children:["From ",(0,a.jsx)(r.code,{children:"SubjectPropertyInformationSubstitutor.cs"}),":"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-csharp",children:'private Table CreateExecutiveSummaryTable(SubjectProperty property)\r\n{\r\n    var table = new Table();\r\n    \r\n    // Table properties\r\n    var tableProperties = new TableProperties(\r\n        // 90% width\r\n        new TableWidth { Width = "4500", Type = TableWidthUnitValues.Pct },\r\n        \r\n        // Lightning borders\r\n        new TableBorders(\r\n            new TopBorder { Val = BorderValues.Lightning2 },\r\n            new LeftBorder { Val = BorderValues.Lightning2 },\r\n            new BottomBorder { Val = BorderValues.Lightning2 },\r\n            new RightBorder { Val = BorderValues.Lightning2 },\r\n            new InsideHorizontalBorder { Val = BorderValues.Lightning2 },\r\n            new InsideVerticalBorder { Val = BorderValues.None }  // No vertical borders\r\n        ),\r\n        \r\n        // Row can\'t split across pages\r\n        new TableRowProperties(new CantSplit()),\r\n        \r\n        // Fixed layout\r\n        new TableLayout { Type = TableLayoutValues.Fixed },\r\n        \r\n        // Center table\r\n        new TableJustification { Val = TableRowAlignmentValues.Center }\r\n    );\r\n    table.AppendChild(tableProperties);\r\n    \r\n    // Grid: 2 equal columns\r\n    var tableGrid = new TableGrid(\r\n        new GridColumn { Width = "3000" },\r\n        new GridColumn { Width = "3000" }\r\n    );\r\n    table.AppendChild(tableGrid);\r\n    \r\n    // Add rows\r\n    AddTableRow(table, "Property Address:", property.Address);\r\n    AddTableRow(table, "Property Type:", property.PropertyType);\r\n    AddTableRow(table, "Year Built:", property.YearBuilt?.ToString());\r\n    AddTableRow(table, "Square Footage:", property.GrossLivingArea?.ToString("N0"));\r\n    AddTableRow(table, "Lot Size:", property.LotSize?.ToString("N0") + " sq ft");\r\n    AddTableRow(table, "Appraised Value:", "$" + property.AppraisedValue?.ToString("N0"));\r\n    \r\n    return table;\r\n}\r\n\r\nprivate void AddTableRow(Table table, string label, string value)\r\n{\r\n    var row = new TableRow();\r\n    row.AppendChild(new TableRowProperties(new CantSplit()));\r\n    \r\n    // Label cell (bold)\r\n    var labelCell = CreateCell(label, 3000, bold: true, alignment: JustificationValues.Right);\r\n    row.AppendChild(labelCell);\r\n    \r\n    // Value cell\r\n    var valueCell = CreateCell(value ?? "", 3000, alignment: JustificationValues.Left);\r\n    row.AppendChild(valueCell);\r\n    \r\n    table.AppendChild(row);\r\n}\n'})}),"\n",(0,a.jsx)(r.hr,{}),"\n",(0,a.jsx)(r.h2,{id:"advanced-cell-creation",children:"Advanced Cell Creation"}),"\n",(0,a.jsx)(r.h3,{id:"cell-with-alignment-and-formatting",children:"Cell with Alignment and Formatting"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-csharp",children:"private static TableCell CreateCell(\r\n    string text, \r\n    int width, \r\n    bool bold = false,\r\n    JustificationValues alignment = JustificationValues.Left,\r\n    string backgroundColor = null,\r\n    VerticalTextAlignmentValues verticalAlign = VerticalTextAlignmentValues.Top)\r\n{\r\n    var cell = new TableCell();\r\n    \r\n    // Cell properties\r\n    var cellProperties = new TableCellProperties(\r\n        new TableCellWidth { Width = width.ToString(), Type = TableWidthUnitValues.Dxa },\r\n        new TableCellVerticalAlignment { Val = verticalAlign }\r\n    );\r\n    \r\n    // Background color\r\n    if (backgroundColor != null)\r\n    {\r\n        cellProperties.AppendChild(new Shading \r\n        { \r\n            Fill = backgroundColor, \r\n            Val = ShadingPatternValues.Clear \r\n        });\r\n    }\r\n    \r\n    cell.AppendChild(cellProperties);\r\n    \r\n    // Paragraph\r\n    var paragraph = new Paragraph();\r\n    \r\n    // Paragraph properties\r\n    var paragraphProperties = new ParagraphProperties(\r\n        new Justification { Val = alignment }\r\n    );\r\n    paragraph.AppendChild(paragraphProperties);\r\n    \r\n    // Run\r\n    var run = new Run();\r\n    \r\n    // Run properties\r\n    if (bold)\r\n    {\r\n        var runProperties = new RunProperties(new Bold());\r\n        run.AppendChild(runProperties);\r\n    }\r\n    \r\n    run.AppendChild(new Text(text));\r\n    paragraph.AppendChild(run);\r\n    cell.AppendChild(paragraph);\r\n    \r\n    return cell;\r\n}\n"})}),"\n",(0,a.jsx)(r.hr,{}),"\n",(0,a.jsx)(r.h2,{id:"cell-merging",children:"Cell Merging"}),"\n",(0,a.jsx)(r.h3,{id:"horizontal-merge-spanning-columns",children:"Horizontal Merge (Spanning Columns)"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-csharp",children:'public static Table CreateTableWithMergedCells()\r\n{\r\n    var table = new Table();\r\n    \r\n    // Properties and grid\r\n    var tableProperties = new TableProperties(\r\n        new TableWidth { Width = "5000", Type = TableWidthUnitValues.Pct }\r\n    );\r\n    table.AppendChild(tableProperties);\r\n    \r\n    var tableGrid = new TableGrid(\r\n        new GridColumn { Width = "2000" },\r\n        new GridColumn { Width = "2000" },\r\n        new GridColumn { Width = "2000" }\r\n    );\r\n    table.AppendChild(tableGrid);\r\n    \r\n    // Row 1: Merged header spanning all 3 columns\r\n    var row1 = new TableRow();\r\n    row1.AppendChild(new TableRowProperties(new CantSplit()));\r\n    \r\n    var mergedCell = new TableCell();\r\n    mergedCell.AppendChild(new TableCellProperties(\r\n        new TableCellWidth { Width = "6000", Type = TableWidthUnitValues.Dxa },\r\n        new GridSpan { Val = 3 },  // Span 3 columns\r\n        new Shading { Fill = "CCCCCC" }\r\n    ));\r\n    mergedCell.AppendChild(CreateParagraph("Merged Header", bold: true, centered: true));\r\n    row1.AppendChild(mergedCell);\r\n    table.AppendChild(row1);\r\n    \r\n    // Row 2: Normal cells\r\n    var row2 = new TableRow();\r\n    row2.AppendChild(new TableRowProperties(new CantSplit()));\r\n    row2.AppendChild(CreateCell("Cell 1", 2000));\r\n    row2.AppendChild(CreateCell("Cell 2", 2000));\r\n    row2.AppendChild(CreateCell("Cell 3", 2000));\r\n    table.AppendChild(row2);\r\n    \r\n    return table;\r\n}\n'})}),"\n",(0,a.jsx)(r.h3,{id:"vertical-merge-spanning-rows",children:"Vertical Merge (Spanning Rows)"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-csharp",children:'public static Table CreateTableWithVerticalMerge()\r\n{\r\n    var table = new Table();\r\n    \r\n    // Properties and grid\r\n    var tableProperties = new TableProperties(\r\n        new TableWidth { Width = "5000", Type = TableWidthUnitValues.Pct }\r\n    );\r\n    table.AppendChild(tableProperties);\r\n    \r\n    var tableGrid = new TableGrid(\r\n        new GridColumn { Width = "2000" },\r\n        new GridColumn { Width = "4000" }\r\n    );\r\n    table.AppendChild(tableGrid);\r\n    \r\n    // Row 1: Start vertical merge\r\n    var row1 = new TableRow();\r\n    row1.AppendChild(new TableRowProperties(new CantSplit()));\r\n    \r\n    var cell1 = new TableCell();\r\n    cell1.AppendChild(new TableCellProperties(\r\n        new TableCellWidth { Width = "2000", Type = TableWidthUnitValues.Dxa },\r\n        new VerticalMerge { Val = MergedCellValues.Restart }  // Start merge\r\n    ));\r\n    cell1.AppendChild(CreateParagraph("Merged Cell", bold: true));\r\n    row1.AppendChild(cell1);\r\n    \r\n    row1.AppendChild(CreateCell("Row 1 Data", 4000));\r\n    table.AppendChild(row1);\r\n    \r\n    // Row 2: Continue vertical merge\r\n    var row2 = new TableRow();\r\n    row2.AppendChild(new TableRowProperties(new CantSplit()));\r\n    \r\n    var cell2 = new TableCell();\r\n    cell2.AppendChild(new TableCellProperties(\r\n        new TableCellWidth { Width = "2000", Type = TableWidthUnitValues.Dxa },\r\n        new VerticalMerge { Val = MergedCellValues.Continue }  // Continue merge\r\n    ));\r\n    cell2.AppendChild(CreateParagraph(""));  // Empty paragraph required\r\n    row2.AppendChild(cell2);\r\n    \r\n    row2.AppendChild(CreateCell("Row 2 Data", 4000));\r\n    table.AppendChild(row2);\r\n    \r\n    // Row 3: Continue vertical merge\r\n    var row3 = new TableRow();\r\n    row3.AppendChild(new TableRowProperties(new CantSplit()));\r\n    \r\n    var cell3 = new TableCell();\r\n    cell3.AppendChild(new TableCellProperties(\r\n        new TableCellWidth { Width = "2000", Type = TableWidthUnitValues.Dxa },\r\n        new VerticalMerge { Val = MergedCellValues.Continue }\r\n    ));\r\n    cell3.AppendChild(CreateParagraph(""));\r\n    row3.AppendChild(cell3);\r\n    \r\n    row3.AppendChild(CreateCell("Row 3 Data", 4000));\r\n    table.AppendChild(row3);\r\n    \r\n    return table;\r\n}\n'})}),"\n",(0,a.jsx)(r.hr,{}),"\n",(0,a.jsx)(r.h2,{id:"property-images-table-appraisys",children:"Property Images Table (AppraiSys)"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-csharp",children:'public static Table CreatePropertyImagesTable(List<ImageData> images, int columns = 3)\r\n{\r\n    var table = new Table();\r\n    \r\n    // Table properties\r\n    var tableProperties = new TableProperties(\r\n        new TableStyle { Val = "PropertyImagesTable" },\r\n        new TableWidth { Width = "5000", Type = TableWidthUnitValues.Pct },\r\n        new TableJustification { Val = TableRowAlignmentValues.Center },\r\n        new TableCellSpacing { Width = "100", Type = TableWidthUnitValues.Dxa },\r\n        new TableBorders(\r\n            new TopBorder { Val = BorderValues.None },\r\n            new BottomBorder { Val = BorderValues.None },\r\n            new LeftBorder { Val = BorderValues.None },\r\n            new RightBorder { Val = BorderValues.None },\r\n            new InsideHorizontalBorder { Val = BorderValues.None },\r\n            new InsideVerticalBorder { Val = BorderValues.None }\r\n        )\r\n    );\r\n    table.AppendChild(tableProperties);\r\n    \r\n    // Grid\r\n    var columnWidth = 5000 / columns;\r\n    var tableGrid = new TableGrid();\r\n    for (int i = 0; i < columns; i++)\r\n    {\r\n        tableGrid.AppendChild(new GridColumn { Width = columnWidth.ToString() });\r\n    }\r\n    table.AppendChild(tableGrid);\r\n    \r\n    // Add rows\r\n    int imageIndex = 0;\r\n    while (imageIndex < images.Count)\r\n    {\r\n        var row = new TableRow();\r\n        row.AppendChild(new TableRowProperties(new CantSplit()));\r\n        \r\n        for (int col = 0; col < columns; col++)\r\n        {\r\n            if (imageIndex < images.Count)\r\n            {\r\n                var imageCell = CreateImageCell(images[imageIndex], columnWidth);\r\n                row.AppendChild(imageCell);\r\n                imageIndex++;\r\n            }\r\n            else\r\n            {\r\n                // Empty cell\r\n                row.AppendChild(CreateCell("", columnWidth));\r\n            }\r\n        }\r\n        \r\n        table.AppendChild(row);\r\n    }\r\n    \r\n    return table;\r\n}\r\n\r\nprivate static TableCell CreateImageCell(ImageData imageData, int width)\r\n{\r\n    var cell = new TableCell();\r\n    \r\n    cell.AppendChild(new TableCellProperties(\r\n        new TableCellWidth { Width = width.ToString(), Type = TableWidthUnitValues.Dxa },\r\n        new TableCellVerticalAlignment { Val = TableVerticalAlignmentValues.Top }\r\n    ));\r\n    \r\n    // Add image paragraph\r\n    var paragraph = new Paragraph();\r\n    paragraph.AppendChild(new ParagraphProperties(\r\n        new Justification { Val = JustificationValues.Center }\r\n    ));\r\n    \r\n    // TODO: Add actual image drawing element here\r\n    // (See Image Handling section)\r\n    \r\n    cell.AppendChild(paragraph);\r\n    \r\n    // Caption paragraph\r\n    if (!string.IsNullOrEmpty(imageData.Caption))\r\n    {\r\n        var captionParagraph = new Paragraph();\r\n        captionParagraph.AppendChild(new ParagraphProperties(\r\n            new Justification { Val = JustificationValues.Center }\r\n        ));\r\n        \r\n        var run = new Run();\r\n        run.AppendChild(new RunProperties(\r\n            new FontSize { Val = "18" },  // 9pt\r\n            new Italic()\r\n        ));\r\n        run.AppendChild(new Text(imageData.Caption));\r\n        \r\n        captionParagraph.AppendChild(run);\r\n        cell.AppendChild(captionParagraph);\r\n    }\r\n    \r\n    return cell;\r\n}\n'})}),"\n",(0,a.jsx)(r.hr,{}),"\n",(0,a.jsx)(r.h2,{id:"table-with-custom-borders",children:"Table with Custom Borders"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-csharp",children:'public static Table CreateCustomBorderTable()\r\n{\r\n    var table = new Table();\r\n    \r\n    var tableProperties = new TableProperties(\r\n        new TableWidth { Width = "5000", Type = TableWidthUnitValues.Pct },\r\n        new TableBorders(\r\n            // Thick top border\r\n            new TopBorder \r\n            { \r\n                Val = BorderValues.Single, \r\n                Size = 24,  // 3pt\r\n                Color = "000000" \r\n            },\r\n            // Thin side borders\r\n            new LeftBorder \r\n            { \r\n                Val = BorderValues.Single, \r\n                Size = 4,  // 0.5pt\r\n                Color = "CCCCCC" \r\n            },\r\n            new RightBorder \r\n            { \r\n                Val = BorderValues.Single, \r\n                Size = 4, \r\n                Color = "CCCCCC" \r\n            },\r\n            // Thick bottom border\r\n            new BottomBorder \r\n            { \r\n                Val = BorderValues.Single, \r\n                Size = 24, \r\n                Color = "000000" \r\n            },\r\n            // Dotted inside horizontal\r\n            new InsideHorizontalBorder \r\n            { \r\n                Val = BorderValues.Dotted, \r\n                Size = 4, \r\n                Color = "CCCCCC" \r\n            },\r\n            // No inside vertical\r\n            new InsideVerticalBorder { Val = BorderValues.None }\r\n        )\r\n    );\r\n    table.AppendChild(tableProperties);\r\n    \r\n    // Add grid and rows...\r\n    \r\n    return table;\r\n}\n'})}),"\n",(0,a.jsx)(r.hr,{}),"\n",(0,a.jsx)(r.h2,{id:"dynamic-table-generation",children:"Dynamic Table Generation"}),"\n",(0,a.jsx)(r.h3,{id:"create-table-from-data",children:"Create Table from Data"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-csharp",children:'public static Table CreateTableFromData<T>(\r\n    List<T> data, \r\n    Dictionary<string, Func<T, string>> columns,\r\n    bool headerRow = true)\r\n{\r\n    var table = new Table();\r\n    \r\n    // Properties\r\n    var tableProperties = new TableProperties(\r\n        new TableWidth { Width = "5000", Type = TableWidthUnitValues.Pct },\r\n        new TableBorders(\r\n            new TopBorder { Val = BorderValues.Single, Size = 4 },\r\n            new BottomBorder { Val = BorderValues.Single, Size = 4 },\r\n            new LeftBorder { Val = BorderValues.Single, Size = 4 },\r\n            new RightBorder { Val = BorderValues.Single, Size = 4 },\r\n            new InsideHorizontalBorder { Val = BorderValues.Single, Size = 4 },\r\n            new InsideVerticalBorder { Val = BorderValues.Single, Size = 4 }\r\n        )\r\n    );\r\n    table.AppendChild(tableProperties);\r\n    \r\n    // Grid\r\n    int columnCount = columns.Count;\r\n    int columnWidth = 5000 / columnCount;\r\n    \r\n    var tableGrid = new TableGrid();\r\n    for (int i = 0; i < columnCount; i++)\r\n    {\r\n        tableGrid.AppendChild(new GridColumn { Width = columnWidth.ToString() });\r\n    }\r\n    table.AppendChild(tableGrid);\r\n    \r\n    // Header row\r\n    if (headerRow)\r\n    {\r\n        var headerRow = new TableRow();\r\n        headerRow.AppendChild(new TableRowProperties(new CantSplit()));\r\n        \r\n        foreach (var column in columns.Keys)\r\n        {\r\n            var cell = CreateCell(\r\n                column, \r\n                columnWidth, \r\n                bold: true, \r\n                backgroundColor: "CCCCCC",\r\n                alignment: JustificationValues.Center\r\n            );\r\n            headerRow.AppendChild(cell);\r\n        }\r\n        \r\n        table.AppendChild(headerRow);\r\n    }\r\n    \r\n    // Data rows\r\n    foreach (var item in data)\r\n    {\r\n        var dataRow = new TableRow();\r\n        dataRow.AppendChild(new TableRowProperties(new CantSplit()));\r\n        \r\n        foreach (var columnFunc in columns.Values)\r\n        {\r\n            var value = columnFunc(item);\r\n            var cell = CreateCell(value, columnWidth);\r\n            dataRow.AppendChild(cell);\r\n        }\r\n        \r\n        table.AppendChild(dataRow);\r\n    }\r\n    \r\n    return table;\r\n}\r\n\r\n// Usage:\r\nvar comparables = GetComparableProperties();\r\nvar table = CreateTableFromData(\r\n    comparables,\r\n    new Dictionary<string, Func<Comparable, string>>\r\n    {\r\n        { "Address", c => c.Address },\r\n        { "Price", c => "$" + c.Price.ToString("N0") },\r\n        { "Sq Ft", c => c.SquareFeet.ToString("N0") },\r\n        { "Beds", c => c.Bedrooms.ToString() },\r\n        { "Baths", c => c.Bathrooms.ToString("F1") }\r\n    }\r\n);\n'})}),"\n",(0,a.jsx)(r.hr,{}),"\n",(0,a.jsx)(r.h2,{id:"nested-tables",children:"Nested Tables"}),"\n",(0,a.jsx)(r.h3,{id:"table-inside-table-cell",children:"Table Inside Table Cell"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-csharp",children:'public static Table CreateNestedTable()\r\n{\r\n    var outerTable = new Table();\r\n    \r\n    // Outer table properties\r\n    var outerTableProps = new TableProperties(\r\n        new TableWidth { Width = "5000", Type = TableWidthUnitValues.Pct }\r\n    );\r\n    outerTable.AppendChild(outerTableProps);\r\n    \r\n    var outerGrid = new TableGrid(\r\n        new GridColumn { Width = "5000" }\r\n    );\r\n    outerTable.AppendChild(outerGrid);\r\n    \r\n    // Outer row\r\n    var outerRow = new TableRow();\r\n    outerRow.AppendChild(new TableRowProperties(new CantSplit()));\r\n    \r\n    var outerCell = new TableCell();\r\n    outerCell.AppendChild(new TableCellProperties(\r\n        new TableCellWidth { Width = "5000", Type = TableWidthUnitValues.Dxa }\r\n    ));\r\n    \r\n    // Header paragraph\r\n    var headerPara = new Paragraph();\r\n    var headerRun = new Run();\r\n    headerRun.AppendChild(new RunProperties(new Bold()));\r\n    headerRun.AppendChild(new Text("Container"));\r\n    headerPara.AppendChild(headerRun);\r\n    outerCell.AppendChild(headerPara);\r\n    \r\n    // *** NESTED TABLE ***\r\n    var innerTable = new Table();\r\n    var innerTableProps = new TableProperties(\r\n        new TableWidth { Width = "4500", Type = TableWidthUnitValues.Dxa }\r\n    );\r\n    innerTable.AppendChild(innerTableProps);\r\n    \r\n    var innerGrid = new TableGrid(\r\n        new GridColumn { Width = "2250" },\r\n        new GridColumn { Width = "2250" }\r\n    );\r\n    innerTable.AppendChild(innerGrid);\r\n    \r\n    // Inner row\r\n    var innerRow = new TableRow();\r\n    innerRow.AppendChild(new TableRowProperties(new CantSplit()));\r\n    innerRow.AppendChild(CreateCell("Nested 1", 2250));\r\n    innerRow.AppendChild(CreateCell("Nested 2", 2250));\r\n    innerTable.AppendChild(innerRow);\r\n    \r\n    // Add nested table to outer cell\r\n    outerCell.AppendChild(innerTable);\r\n    \r\n    outerRow.AppendChild(outerCell);\r\n    outerTable.AppendChild(outerRow);\r\n    \r\n    return outerTable;\r\n}\n'})}),"\n",(0,a.jsx)(r.hr,{}),"\n",(0,a.jsx)(r.h2,{id:"helper-methods",children:"Helper Methods"}),"\n",(0,a.jsx)(r.h3,{id:"create-paragraph",children:"Create Paragraph"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-csharp",children:"private static Paragraph CreateParagraph(\r\n    string text, \r\n    bool bold = false, \r\n    bool centered = false)\r\n{\r\n    var paragraph = new Paragraph();\r\n    \r\n    if (centered)\r\n    {\r\n        paragraph.AppendChild(new ParagraphProperties(\r\n            new Justification { Val = JustificationValues.Center }\r\n        ));\r\n    }\r\n    \r\n    var run = new Run();\r\n    \r\n    if (bold)\r\n    {\r\n        run.AppendChild(new RunProperties(new Bold()));\r\n    }\r\n    \r\n    run.AppendChild(new Text(text));\r\n    paragraph.AppendChild(run);\r\n    \r\n    return paragraph;\r\n}\n"})}),"\n",(0,a.jsx)(r.hr,{}),"\n",(0,a.jsx)(r.h2,{id:"complete-example-comparables-table",children:"Complete Example: Comparables Table"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-csharp",children:'public static Table CreateComparablesTable(\r\n    SubjectProperty subject,\r\n    List<Comparable> comparables)\r\n{\r\n    var table = new Table();\r\n    \r\n    // Properties\r\n    var tableProperties = new TableProperties(\r\n        new TableWidth { Width = "5000", Type = TableWidthUnitValues.Pct },\r\n        new TableBorders(\r\n            new TopBorder { Val = BorderValues.Single, Size = 4 },\r\n            new BottomBorder { Val = BorderValues.Single, Size = 4 },\r\n            new LeftBorder { Val = BorderValues.Single, Size = 4 },\r\n            new RightBorder { Val = BorderValues.Single, Size = 4 },\r\n            new InsideHorizontalBorder { Val = BorderValues.Single, Size = 4 },\r\n            new InsideVerticalBorder { Val = BorderValues.Single, Size = 4 }\r\n        ),\r\n        new TableLayout { Type = TableLayoutValues.Fixed }\r\n    );\r\n    table.AppendChild(tableProperties);\r\n    \r\n    // Grid: Subject + 3 comparables\r\n    var tableGrid = new TableGrid(\r\n        new GridColumn { Width = "2000" },  // Field name\r\n        new GridColumn { Width = "1500" },  // Subject\r\n        new GridColumn { Width = "1000" },  // Comp 1\r\n        new GridColumn { Width = "1000" },  // Comp 2\r\n        new GridColumn { Width = "1000" }   // Comp 3\r\n    );\r\n    table.AppendChild(tableGrid);\r\n    \r\n    // Header row\r\n    AddHeaderRow(table, comparables.Count);\r\n    \r\n    // Data rows\r\n    AddFieldRow(table, "Address", \r\n        subject.Address,\r\n        comparables.Select(c => c.Address).ToArray());\r\n    \r\n    AddFieldRow(table, "Sale Price", \r\n        "$" + subject.AppraisedValue?.ToString("N0"),\r\n        comparables.Select(c => "$" + c.SalePrice.ToString("N0")).ToArray());\r\n    \r\n    AddFieldRow(table, "Square Feet", \r\n        subject.GrossLivingArea?.ToString("N0"),\r\n        comparables.Select(c => c.SquareFeet.ToString("N0")).ToArray());\r\n    \r\n    AddFieldRow(table, "Bedrooms", \r\n        subject.Bedrooms?.ToString(),\r\n        comparables.Select(c => c.Bedrooms.ToString()).ToArray());\r\n    \r\n    AddFieldRow(table, "Bathrooms", \r\n        subject.Bathrooms?.ToString("F1"),\r\n        comparables.Select(c => c.Bathrooms.ToString("F1")).ToArray());\r\n    \r\n    return table;\r\n}\r\n\r\nprivate static void AddHeaderRow(Table table, int comparableCount)\r\n{\r\n    var row = new TableRow();\r\n    row.AppendChild(new TableRowProperties(new CantSplit()));\r\n    \r\n    row.AppendChild(CreateCell("Item", 2000, bold: true, \r\n        backgroundColor: "CCCCCC", alignment: JustificationValues.Center));\r\n    row.AppendChild(CreateCell("Subject", 1500, bold: true, \r\n        backgroundColor: "CCCCCC", alignment: JustificationValues.Center));\r\n    \r\n    for (int i = 0; i < comparableCount; i++)\r\n    {\r\n        row.AppendChild(CreateCell($"Comp {i + 1}", 1000, bold: true, \r\n            backgroundColor: "CCCCCC", alignment: JustificationValues.Center));\r\n    }\r\n    \r\n    table.AppendChild(row);\r\n}\r\n\r\nprivate static void AddFieldRow(Table table, string fieldName, \r\n    string subjectValue, params string[] comparableValues)\r\n{\r\n    var row = new TableRow();\r\n    row.AppendChild(new TableRowProperties(new CantSplit()));\r\n    \r\n    row.AppendChild(CreateCell(fieldName, 2000, bold: true, \r\n        alignment: JustificationValues.Right));\r\n    row.AppendChild(CreateCell(subjectValue ?? "", 1500, \r\n        alignment: JustificationValues.Center));\r\n    \r\n    foreach (var value in comparableValues)\r\n    {\r\n        row.AppendChild(CreateCell(value ?? "", 1000, \r\n            alignment: JustificationValues.Center));\r\n    }\r\n    \r\n    table.AppendChild(row);\r\n}\n'})}),"\n",(0,a.jsx)(r.hr,{}),"\n",(0,a.jsx)(r.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,a.jsxs)(r.p,{children:["\u27a1\ufe0f ",(0,a.jsx)(r.strong,{children:"Next"}),": ",(0,a.jsx)(r.a,{href:"03-image-handling.md",children:"Image Handling"})]}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Related"}),":"]}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.a,{href:"../intermediate/tables-in-ooxml.md",children:"Tables in OOXML"})," - Comprehensive table guide"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.a,{href:"../reference/appraisys-patterns.md",children:"AppraiSys Patterns"})," - More examples"]}),"\n",(0,a.jsxs)(r.li,{children:[(0,a.jsx)(r.a,{href:"../fundamentals/common-fatal-mistakes.md",children:"Common Fatal Mistakes"})," - Avoid table errors"]}),"\n"]}),"\n",(0,a.jsx)(r.hr,{}),"\n",(0,a.jsxs)(r.p,{children:["\ud83d\udca1 ",(0,a.jsx)(r.strong,{children:"Remember"}),": Every table cell must contain at least one paragraph. Always use ",(0,a.jsx)(r.code,{children:"CantSplit()"})," for professional-looking tables!"]})]})}function h(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(s,{...e})}):s(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>i,x:()=>d});var l=n(6540);const a={},t=l.createContext(a);function i(e){const r=l.useContext(t);return l.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function d(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),l.createElement(t.Provider,{value:r},e.children)}}}]);