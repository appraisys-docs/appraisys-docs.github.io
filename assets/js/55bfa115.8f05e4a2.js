"use strict";(globalThis.webpackChunkappraisys_technical_documentation=globalThis.webpackChunkappraisys_technical_documentation||[]).push([[3633],{29087:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>r});var s=n(96363);const i={},a=s.createContext(i);function o(e){const t=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(a.Provider,{value:t},e.children)}},64666:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>h,contentTitle:()=>r,default:()=>l,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"OOXML-Specification/DrawingML/Shapes/drwSp-custGeom","title":"Custom Geometry","description":"Custom Geometry","source":"@site/docs/OOXML-Specification/DrawingML/Shapes/drwSp-custGeom.md","sourceDirName":"OOXML-Specification/DrawingML/Shapes","slug":"/OOXML-Specification/DrawingML/Shapes/drwSp-custGeom","permalink":"/docs/OOXML-Specification/DrawingML/Shapes/drwSp-custGeom","draft":false,"unlisted":false,"editUrl":"https://gitlab.devcom.com/appraisys/Atlas/docs/OOXML-Specification/DrawingML/Shapes/drwSp-custGeom.md","tags":[],"version":"current","frontMatter":{"title":"Custom Geometry"},"sidebar":"tutorialSidebar","previous":{"title":"Visual Properties","permalink":"/docs/OOXML-Specification/DrawingML/Shapes/drwSp-SpPr"},"next":{"title":"Effects","permalink":"/docs/OOXML-Specification/DrawingML/Shapes/drwSp-effects"}}');var i=n(47259),a=n(29087);const o={title:"Custom Geometry"},r="DrawingML Shapes",h={},c=[{value:"Defining the shape&#39;s path",id:"defining-the-shapes-path",level:2},{value:"Defining the shape&#39;s connection points",id:"defining-the-shapes-connection-points",level:2},{value:"Defining the shape&#39;s bounding box for text",id:"defining-the-shapes-bounding-box-for-text",level:2}];function d(e){const t={code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"drawingml-shapes",children:"DrawingML Shapes"})}),"\n",(0,i.jsx)(t.p,{children:"Custom Geometry"}),"\n",(0,i.jsxs)(t.p,{children:["A custom geometric shape consisting of most any series of lines and curves can be specified with a ",(0,i.jsx)(t.code,{children:"<a:custGeom>"})," element. The most important component of a ",(0,i.jsx)(t.code,{children:"<a:custGeom>"})," is the specification of the path that the shape takes. This is specified with a child ",(0,i.jsx)(t.code,{children:"<a:pathLst>"})," element. But there are also other optional components of a custom shape that can be specified. The placement of shape adjustment handles can be specified with a child ",(0,i.jsx)(t.code,{children:"<a:ahLst>"})," (not covered here). The location of connection points (locations on the object where lines or connectors can be placed) can be specified with a child ",(0,i.jsx)(t.code,{children:"<a:cxnLst>"}),". A rectangular bounding box for text within the shape can be specified with a child ",(0,i.jsx)(t.code,{children:"<a:rect>"}),". Finally, a shape's edges can be dynamically determined or adjusted based upon formulas rather than static placement. This is done using adjust values (",(0,i.jsx)(t.code,{children:"<a:avLst>"}),") and shape guides (",(0,i.jsx)(t.code,{children:"<a:gdLst>"}),"). This aspect of custom geometry is not covered here."]}),"\n",(0,i.jsx)(t.h2,{id:"defining-the-shapes-path",children:"Defining the shape's path"}),"\n",(0,i.jsxs)(t.p,{children:["A shape is specified by one or more paths contained within a ",(0,i.jsx)(t.code,{children:"<a:pathLst>"})," element. Each path is a set of moves, lines and arcs contained within a ",(0,i.jsx)(t.code,{children:"<a:path>"})," child element. Essentially each path can be thought of as a separate shape. The end point of the previous path will be connected to the first point of the new path unless the previous path specifies a ",(0,i.jsx)(t.code,{children:"<a:close>"})," element. Note that since multiple paths are allowed, later paths are drawn on top of previous paths."]}),"\n",(0,i.jsxs)(t.p,{children:["A path has a space specified by the height (h) and width (w) attributes of the ",(0,i.jsx)(t.code,{children:"<a:path>"})," element. The path is then specified with points (represented by ",(0,i.jsx)(t.code,{children:"<a:pt>"})," elements) defined within the path's space using x-y coordinates. Note the coordinate system as shown in the image. ",(0,i.jsx)(t.img,{src:"http://officeopenxml.com/drwImages%5CdrwSp-coordinateSystem.gif",alt:"Coordinate system for points in a customer shape"})," The ",(0,i.jsx)(t.code,{children:"<a:pt>"})," has x and y attributes that define the coordinates of the point. Be sure not to confuse the shape coordinate system with the path coordinate system; they are distinct The shape coordinate system or the shape bounding box is defined by the ",(0,i.jsx)(t.code,{children:"<a:ext>"})," within the ",(0,i.jsx)(t.code,{children:"<a:xfrm>"})," element and is specified in EMUs. The path coordinate system is defined by the h and w attributes of the ",(0,i.jsx)(t.code,{children:"<a:path>"})," element, which may not be in EMUs. Path points are defined in terms of the path coordinate system."]}),"\n",(0,i.jsxs)(t.p,{children:["As mentioned above, a path is defined by drawing a sequence of lines (",(0,i.jsx)(t.code,{children:"<a:lnTo>"}),"), arcs (",(0,i.jsx)(t.code,{children:"<a:arcTo>"}),"), cubic bezier curves (",(0,i.jsx)(t.code,{children:"<a:cubicBezTo>"}),"), and quadratic bezier curves (",(0,i.jsx)(t.code,{children:"<a:quadBezTo>"}),"). The drawing of lines and curves can be interrupted by moving to a new coordinate and drawing from the new location; this is specified with ",(0,i.jsx)(t.code,{children:"<a:moveTo>"})," element. Each of the elements just mentioned has one, two, or three ",(0,i.jsx)(t.code,{children:"<a:pt>"})," child elements."]}),"\n",(0,i.jsxs)(t.p,{children:["A ",(0,i.jsx)(t.code,{children:"<a:path>"})," has the following elements."]}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Element"}),(0,i.jsx)(t.th,{children:"Description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"arcTo"}),(0,i.jsx)(t.td,{children:"An empty element that specifies an arc from the current pen position to the new point. An arc is a line that is bent based on the shape of a supposed circle. The length is determined by a start angle and an ending angle. The arcTo element has four possible attributes which define the arc: hR (the height radius in EMUs or a number immediately followed by a unit identifier), stAng (the start angle in 60,000ths of a degree; positive values are clockwise), swAng (the swing angle), and wR (the width radius)."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"close"}),(0,i.jsxs)(t.td,{children:["An empty element that specifies the end of a series of lines and curves and signals to the application that that the path is closed and any further lines or curves should be ignored. When the last point does not meet the first point in the path, the application should connect the last point with the first with a straight line to create a closed shape. The ",(0,i.jsx)(t.code,{children:"<a:close>"})," also means that the subsequent path (if any) will not be connected to the previous path. If a path is not closed, then the shape will have no fill."]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"cubicBezTo"}),(0,i.jsxs)(t.td,{children:["Specifies to draw a cubic bezier curve along the specified points. There must be three child ",(0,i.jsx)(t.code,{children:"<a:pt>"})," points specified. The first two are control points used in the cubic bezier calculation and last is the ending point."]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"lnTo"}),(0,i.jsxs)(t.td,{children:["Specifies the drawing of a straight line. It contains one child ",(0,i.jsx)(t.code,{children:"<a:pt>"})," element."]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"moveTo"}),(0,i.jsxs)(t.td,{children:["Specifies a set of coordinates to move the shape cursor to. It does not draw a line or curve; it simply moves the cursor to a new position. It contains one child ",(0,i.jsx)(t.code,{children:"<a:pt>"})," element."]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"quadBezTo"}),(0,i.jsxs)(t.td,{children:["Specifies to draw a quadratic bezier curve along the specified points. There must be two child ",(0,i.jsx)(t.code,{children:"<a:pt>"})," point elements."]})]})]})]}),"\n",(0,i.jsxs)(t.p,{children:["A ",(0,i.jsx)(t.code,{children:"<a:path>"})," has the following attributes."]}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Attribute"}),(0,i.jsx)(t.th,{children:"Description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"extrusionOk"}),(0,i.jsx)(t.td,{children:"Specifies that 3D extrusions are allowed. If ommitted, it is assumed that the value is false."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"fill"}),(0,i.jsx)(t.td,{children:"Specifies how the corresponding path should be filled. Possible values are darken, darkenLess, lighten, darkenLess, none, and normal (assumed if the attribute is omitted). See the sample of two paths below. The fill of the second path has been darkened."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"h"}),(0,i.jsx)(t.td,{children:"Specifies the height or maximum y coordinate the should be used. It determines the vertical placement of all points in the path as they are all calculated using this attribute as the max y coordinate."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"stroke"}),(0,i.jsx)(t.td,{children:"Specifies if the corresponding path should have a path stroke shown. If omitted, the value is assumed to be true."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"w"}),(0,i.jsx)(t.td,{children:"Specifies the width or maximum z coordinate the should be used. It determines the horizontal placement of all points in the path as they are all calculated using this attribute as the max x coordinate."})]})]})]}),"\n",(0,i.jsxs)(t.p,{children:["Below is a sample of a custom geometrical shape with one path. First the cursor is moved to new coordinates at (0,428263) as specified by the ",(0,i.jsx)(t.code,{children:"<a:moveTo>"})," element. Then a series of three lines is drawn. In the example, a ",(0,i.jsx)(t.code,{children:"<a:close>"})," element is specified to signal to the application that that the path is closed and any further lines or curves should be ignored. When the last point does not meet the first point in the path, the application should connect the last point with the first with a straight line to create a closed shape. The ",(0,i.jsx)(t.code,{children:"<a:close>"})," also means that the subsequent path (if any) will not be connected to the previous path. If a path is not closed, then the shape will have no fill."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-xml",children:'<xdr:sp macro="" textlink="">\r\n\r\n. . .\r\n\r\n<xdr:spPr>\r\n\r\n<a:xfrm>\r\n\r\n<a:off x="1238250" y="504825"/>\r\n\r\n<a:ext cx="1685925" cy="638175"/>\r\n\r\n</a:xfrm>\r\n\r\n<a:custGeom>\r\n\r\n<a:pathLst>\r\n\r\n<a:path w="2824222" h="590309">\r\n\r\n<a:moveTo>\r\n\r\n<a:pt x="0" y="428263"/>\r\n\r\n</a:moveTo>\r\n\r\n<a:lnTo>\r\n\r\n<a:pt x="1620455" y="590309"/>\r\n\r\n</a:lnTo>\r\n\r\n<a:lnTo>\r\n\r\n<a:pt x="2824222" y="173620"/>\r\n\r\n</a:lnTo>\r\n\r\n<a:lnTo>\r\n\r\n<a:pt x="1562582" y="0"/>\r\n\r\n</a:lnTo>\r\n\r\n<a:close/>\r\n\r\n</a:path>\r\n\r\n</a:pathLst/>\r\n\r\n</a:custGeom>\r\n\r\n<a:solidFill>\r\n\r\n<a:schemeClr val="accent6"/>\r\n\r\n<a:lumMod val="75000"/>\r\n\r\n</a:schemeClr>\r\n\r\n</a:solidFill>\r\n\r\n</xdr:spPr>\r\n\r\n. . .\r\n\r\n</xdr:sp>\n'})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{src:"http://officeopenxml.com/drwImages%5CdrwSp-custGeom-onePath.gif",alt:"Shape with custom geometry"})}),"\n",(0,i.jsxs)(t.p,{children:["Below is the same shape, except that the initial ",(0,i.jsx)(t.code,{children:"<a:moveTo>"})," has been removed, so that drawing begins at the origin point."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{src:"http://officeopenxml.com/drwImages%5CdrwSp-custGeom-onePath-fromOrig.gif",alt:"Shape with custom geometry - from origin"})}),"\n",(0,i.jsx)(t.p,{children:'Below is another example of a custom shape. This time there are two paths. The first is the same as the first path shown above. It is closed, so that path and the subsequent path are not connected. The second path is darkened with the fill="darken" attribute. First the cursor is moved to (1000000,334000); the path then draws two lines. Then it moves again, this time to (500000,500000). Finally, it draws another line and closes.'}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-xml",children:'<a:pathLst>\r\n\r\n<a:path w="2824222" h="590309">\r\n\r\n<a:moveTo>\r\n\r\n<a:pt x="0" y="428263"/>\r\n\r\n</a:moveTo>\r\n\r\n<a:lnTo>\r\n\r\n<a:pt x="1620455" y="590309"/>\r\n\r\n</a:lnTo>\r\n\r\n<a:lnTo>\r\n\r\n<a:pt x="2824222" y="173620"/>\r\n\r\n</a:lnTo>\r\n\r\n<a:lnTo>\r\n\r\n<a:pt x="1562582" y="0"/>\r\n\r\n</a:lnTo>\r\n\r\n<a:close/>\r\n\r\n</a:path>\r\n\r\n</a:pathLst/>\r\n\r\n<a:path fill="darken" w="2824222" h="590309">\r\n\r\n<a:moveTo>\r\n\r\n<a:pt x="1000000" y="334000"/>\r\n\r\n</a:moveTo>\r\n\r\n<a:lnTo>\r\n\r\n<a:pt x="2900455" y="400000"/>\r\n\r\n</a:lnTo>\r\n\r\n<a:lnTo>\r\n\r\n<a:pt x="900222" y="50000"/>\r\n\r\n</a:lnTo>\r\n\r\n<a:moveTo>\r\n\r\n<a:pt x="500000" y="500000"/>\r\n\r\n</a:moveTo>\r\n\r\n<a:lnTo>\r\n\r\n<a:pt x="1500000" y="0"/>\r\n\r\n</a:lnTo>\r\n\r\n<a:close/>\r\n\r\n</a:path>\r\n\r\n</a:pathLst/>\n'})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{src:"http://officeopenxml.com/drwImages%5CdrwSp-custGeom-twoPaths.gif",alt:"Shape with custom geometry - two paths"})}),"\n",(0,i.jsx)(t.h2,{id:"defining-the-shapes-connection-points",children:"Defining the shape's connection points"}),"\n",(0,i.jsxs)(t.p,{children:["A shape can have connection sites where connectors can be attached so that the connections are maintained when the shape is repositioned. Each connection site is specified with a ",(0,i.jsx)(t.code,{children:"<a:cxn>"})," element. All of the ",(0,i.jsx)(t.code,{children:"<a:cxn>"})," elements are within a container ",(0,i.jsx)(t.code,{children:"<a:cxnLst>"})," parent element. Each connection site is positioned with a child ",(0,i.jsx)(t.code,{children:"<a:pos>"})," element, which specifies coordinates with its x and y attributes. It should be noted that the connection is placed within the bounding box using the shape coordinate system encompassing the entire shape, which is specified with the ",(0,i.jsx)(t.code,{children:"<a:ext>"})," element. The ",(0,i.jsx)(t.code,{children:"<a:pos>"})," element also has an ang attribute which specifies the incoming connector angle. This allows the connector to know where the shape is in relation to the connection site and route connectors so as to avoid placement over the shape. Below is a sample of a connection site located in the middle of the shape."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-xml",children:'<a:custGeom>\r\n\r\n<a:cxnLst>\r\n\r\n<a:cxn ang="0">\r\n\r\n<a:pos x="1000000" y="300000"/>\r\n\r\n</a:cxn>\r\n\r\n</a:cxnLst>\r\n\r\n<a:pathLst>\r\n\r\n<a:path w="2824222" h="590309">\r\n\r\n<a:path w="2824222" h="590309">\r\n\r\n<a:moveTo>\r\n\r\n<a:pt x="0" y="428263"/>\r\n\r\n</a:moveTo>\r\n\r\n<a:lnTo>\r\n\r\n<a:pt x="1620455" y="590309"/>\r\n\r\n</a:lnTo>\r\n\r\n<a:lnTo>\r\n\r\n<a:pt x="2824222" y="173620"/>\r\n\r\n</a:lnTo>\r\n\r\n<a:lnTo>\r\n\r\n<a:pt x="1562582" y="0"/>\r\n\r\n</a:lnTo>\r\n\r\n<a:close/>\r\n\r\n</a:path>\r\n\r\n</a:pathLst/>\r\n\r\n</a:custGeom>\n'})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{src:"http://officeopenxml.com/drwImages%5CdrwSp-custGeom-cxn.gif",alt:"Shape with custom geometry - two paths"})}),"\n",(0,i.jsx)(t.p,{children:"Below is an example of two connectors being attached -- one at the specified connection site in the middle of the shape and one that is not at a connection site. The image on the right is the same shape, but it has been repositioned. The connector at the connection site is maintained with the shape while the other connector has not been maintained."}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{src:"http://officeopenxml.com/drwImages%5CdrwSp-custGeom-cxn-beforeMove.gif",alt:"Shape with custom geometry - two paths"})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{src:"http://officeopenxml.com/drwImages%5CdrwSp-custGeom-cxn-afterMove.gif",alt:"Shape with custom geometry - two paths"})}),"\n",(0,i.jsx)(t.h2,{id:"defining-the-shapes-bounding-box-for-text",children:"Defining the shape's bounding box for text"}),"\n",(0,i.jsxs)(t.p,{children:["By default text within a a custom shape is placed within the bounding box for the shape. However, this can be modified with the ",(0,i.jsx)(t.code,{children:"<a:rect>"})," element, which has attributes to inset or extend the text bounding box. The attributes are b (y coordinate for the bottom edge), l (x coordinate for the left edge), r (x coordinate for the right edge), and t (y coordinate for the top edge)."]})]})}function l(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);