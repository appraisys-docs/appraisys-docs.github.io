"use strict";(globalThis.webpackChunkappraisys_technical_documentation=globalThis.webpackChunkappraisys_technical_documentation||[]).push([[2008],{2975:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>d,metadata:()=>t,toc:()=>s});const t=JSON.parse('{"id":"OOXML-Specification/DrawingML/Picture/drwPicInSpread-twoCell","title":"Two-Cell Anchoring","description":"Positioning within a Spreadsheet Document - Two-Cell Anchoring","source":"@site/docs/OOXML-Specification/DrawingML/Picture/drwPicInSpread-twoCell.md","sourceDirName":"OOXML-Specification/DrawingML/Picture","slug":"/OOXML-Specification/DrawingML/Picture/drwPicInSpread-twoCell","permalink":"/docs/OOXML-Specification/DrawingML/Picture/drwPicInSpread-twoCell","draft":false,"unlisted":false,"editUrl":"https://gitlab.devcom.com/valuationpro/documentation/docs/OOXML-Specification/DrawingML/Picture/drwPicInSpread-twoCell.md","tags":[],"version":"current","frontMatter":{"title":"Two-Cell Anchoring"},"sidebar":"tutorialSidebar","previous":{"title":"Absolute Anchoring","permalink":"/docs/OOXML-Specification/DrawingML/Picture/drwPicInSpread-absolute"},"next":{"title":"Positioning within a Spreadsheet Document","permalink":"/docs/OOXML-Specification/DrawingML/Picture/drwPicInSpread"}}');var i=r(47259),o=r(29087);const d={title:"Two-Cell Anchoring"},a="DrawingML Object Positioning",c={},s=[{value:"Attributes:",id:"attributes",level:3},{value:"Elements:",id:"elements",level:3},{value:"Defining the starting and ending anchors",id:"defining-the-starting-and-ending-anchors",level:2},{value:"Starting anchor (<code>&lt;xdr:from&gt;</code>)",id:"starting-anchor-xdrfrom",level:3},{value:"Ending anchor (<code>&lt;xdr:to&gt;</code>)",id:"ending-anchor-xdrto",level:3}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"drawingml-object-positioning",children:"DrawingML Object Positioning"})}),"\n",(0,i.jsx)(n.p,{children:"Positioning within a Spreadsheet Document - Two-Cell Anchoring"}),"\n",(0,i.jsxs)(n.p,{children:["An object can be anchored to two cells in a spreadsheet using the ",(0,i.jsx)(n.code,{children:"<xdr:twoCellAnchor>"})," element. The top and left sides (the starting anchor) are anchored with a child element ",(0,i.jsx)(n.code,{children:"<xdr:from>"})," and the bottom and right sides (ending anchor) are anchored with a child ",(0,i.jsx)(n.code,{children:"<xdr:to>"})," element. The picture will (or will not) then be moved and/or resized when the cells between the starting and ending anchors are moved or resized, based upon the value of the editAs attribute on ",(0,i.jsx)(n.code,{children:"<xdr:twoCellAnchor>"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<xdr:wsDr . . .>\r\n\r\n<xdr:twoCellAnchor editAs="absolute">\r\n\r\n<xdr:from>\r\n\r\n<xdr:col>1</xdr:col>\r\n\r\n<xdr:colOff>0</xdr:colOff>\r\n\r\n<xdr:row>2</xdr:row>\r\n\r\n<xdr:rowOff>0</xdr:rowOff>\r\n\r\n</xdr:from>\r\n\r\n<xdr:to>\r\n\r\n<xdr:col>5</xdr:col>\r\n\r\n<xdr:colOff>0</xdr:colOff>\r\n\r\n<xdr:row>11</xdr:row>\r\n\r\n<xdr:rowOff>114300</xdr:rowOff>\r\n\r\n</xdr:to>\r\n\r\n<xdr:pic>\r\n\r\n. . .\r\n\r\n</xdr:pic>\r\n\r\n<xdr:clientData/>\r\n\r\n</xdr:twoCellAnchor>\r\n\r\n</xdr:wsDr>\n'})}),"\n",(0,i.jsx)(n.p,{children:"Reference: ECMA-376, 3rd Edition (June, 2011), Fundamentals and Markup Language Reference \xa7 20.5.2.33."}),"\n",(0,i.jsx)(n.p,{children:"Word 2007 Example:"}),"\n",(0,i.jsx)(n.p,{children:"Below is an example of a picture that is anchored at two cells."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"http://officeopenxml.com/drwImages%5CdrwInSpread-TwoAnchor.gif",alt:"Spreadsheet Picture - Two Anchors"})}),"\n",(0,i.jsxs)(n.p,{children:["Below are the child elements and attribute of ",(0,i.jsx)(n.code,{children:"<xdr:twoCellAnchor>"})]}),"\n",(0,i.jsx)(n.h3,{id:"attributes",children:"Attributes:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Attribute"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"editAs"}),(0,i.jsx)(n.td,{children:'Specifies how the object should be moved and/or resized when the rows and columns between the start and end anchors are resized, or when additional rows or columns are added. Possible values are   * absolute - do not move or resize with the underlying rows/columns. The current start and end positions are maintained; if additional rows or columns are added, the object anchors are moved as needed to maintain the same position. * oneCell - move with the cells but do not resize. If additional rows or columns are added, the object anchors are moved as needed to maintain the same position. * twoCell - move and resize with the anchor cells.   Below is an example of a resizing of column E with editAs="absolute". Note that the image is not resized.  Spreadsheet Picture - Two Anchors - editAs absolute  Below is an example of a resizing of column E with editAs="twoCell". Note that the image IS resized.  Spreadsheet Picture - Two Anchors - editAs absolute'})]})})]}),"\n",(0,i.jsxs)(n.p,{children:["Below are the possible child elements of ",(0,i.jsx)(n.code,{children:"<xdr:twoCellAnchor>"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"elements",children:"Elements:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Element"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"clientData"}),(0,i.jsx)(n.td,{children:"An empty element which specifies (via attributes) certain properties related to printing and selection of the drawing object. The fLocksWithSheet attribute (either true or false) determines whether to disable selection when the sheet is protected, and fPrintsWithSheet attribute (either true or false) determines whether the object is printed when the sheet is printed. Reference: ECMA-376, 3rd Edition (June, 2011), Fundamentals and Markup Language Reference \xa7 20.5.2.3."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"contentPart"}),(0,i.jsx)(n.td,{children:"Specifies a reference to XML content in a format not defined by the ECMA-376 specification, such as MathML or SVG content. Reference: ECMA-376, 3rd Edition (June, 2011), Fundamentals and Markup Language Reference \xa7 20.5.2.12."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"cxnSp"}),(0,i.jsx)(n.td,{children:"Specifies the properties for a connection shape, such as a line, which connects two other shapes. Not discussed here. Reference: ECMA-376, 3rd Edition (June, 2011), Fundamentals and Markup Language Reference \xa7 20.5.2.13."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"from"}),(0,i.jsx)(n.td,{children:"Specifies the starting anchor. See below for more on defining the anchors. Reference: ECMA-376, 3rd Edition (June, 2011), Fundamentals and Markup Language Reference \xa7 20.5.2.15."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"graphicFrame"}),(0,i.jsx)(n.td,{children:"Specifies a graphical object frame for a spreadsheet that contains a graphical object (e.g., chart, diagram or table). Not discussed here. Reference: ECMA-376, 3rd Edition (June, 2011), Fundamentals and Markup Language Reference \xa7 20.5.2.16."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"grpSp"}),(0,i.jsx)(n.td,{children:"Specifies a group shape. Not discussed here. Reference: ECMA-376, 3rd Edition (June, 2011), Fundamentals and Markup Language Reference \xa7 20.5.2.17."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"pic"}),(0,i.jsxs)(n.td,{children:["Specifies the existence of a picture within a spreadsheet. See ",(0,i.jsx)(n.a,{href:"/docs/OOXML-Specification/DrawingML/Picture/",children:"Drawing - Pictures - Overview"}),". Reference: ECMA-376, 3rd Edition (June, 2011), Fundamentals and Markup Language Reference \xa7 20.5.2.25."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"sp"}),(0,i.jsx)(n.td,{children:"Specifies a shape. Not discussed here. Reference: ECMA-376, 3rd Edition (June, 2011), Fundamentals and Markup Language Reference \xa7 20.5.2.29."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"to"}),(0,i.jsx)(n.td,{children:"Specifies the ending anchor. See below for more on defining the anchors. Reference: ECMA-376, 3rd Edition (June, 2011), Fundamentals and Markup Language Reference \xa7 20.5.2.32."})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"defining-the-starting-and-ending-anchors",children:"Defining the starting and ending anchors"}),"\n",(0,i.jsxs)(n.h3,{id:"starting-anchor-xdrfrom",children:["Starting anchor (",(0,i.jsx)(n.code,{children:"<xdr:from>"}),")"]}),"\n",(0,i.jsxs)(n.p,{children:["The starting anchor determines where the top and left sides of the object are and is specified with the ",(0,i.jsx)(n.code,{children:"<xdr:from>"})," element. The anchor is specified by listing a column and a row for the starting point, and these are specified with ",(0,i.jsx)(n.code,{children:"<xdr:col>"})," and a ",(0,i.jsx)(n.code,{children:"<xdr:row>"})," elements. The contents of each of these elements is a zero-based index for the column and row. However, the starting anchor does not have to be exactly at the intersection of the column and row. It can fall within a cell, and that is defined by specifying an offset from the column (",(0,i.jsx)(n.code,{children:"<xdr:colOff>"}),") and row (",(0,i.jsx)(n.code,{children:"<xdr:rowOff>"}),"); both are in either EMUs or as a number immediately followed by a unit identifier (e.g., 2in). Keep in mind the drawingML coordinate system. The origin is at the top left; the x axis increases left to right and the y axis increases top to bottom. So a complete specification for a starting anchor contains both a ",(0,i.jsx)(n.code,{children:"<xdr:col>"})," and ",(0,i.jsx)(n.code,{children:"<xdr:colOff>"}),", and a ",(0,i.jsx)(n.code,{children:"<xdr:row>"})," and ",(0,i.jsx)(n.code,{children:"<xdr:rowOff>"}),". Below is an example of a starting anchor at the second column and third row, with no offsets."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<xdr:twoCellAnchor editAs="absolute">\r\n\r\n<xdr:from>\r\n\r\n<xdr:col>1</xdr:col>\r\n\r\n<xdr:colOff>0</xdr:colOff>\r\n\r\n<xdr:row>2</xdr:row>\r\n\r\n<xdr:rowOff>0</xdr:rowOff>\r\n\r\n</xdr:from>\r\n\r\n. . .\r\n\r\n</xdr:twoCellAnchor>\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"http://officeopenxml.com/drwImages%5CdrwInSpread-TwoAnchor-from1.gif",alt:"Spreadsheet Picture - Starting Anchor - No Offset"})}),"\n",(0,i.jsx)(n.p,{children:"Below is an example of a starting anchor at the second column and third row, with offsets from both the column and row."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<xdr:twoCellAnchor editAs="absolute">\r\n\r\n<xdr:from>\r\n\r\n<xdr:col>1</xdr:col>\r\n\r\n<xdr:colOff>314325</xdr:colOff>\r\n\r\n<xdr:row>2</xdr:row>\r\n\r\n<xdr:rowOff>95250</xdr:rowOff>\r\n\r\n</xdr:from>\r\n\r\n. . .\r\n\r\n</xdr:twoCellAnchor>\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"http://officeopenxml.com/drwImages%5CdrwInSpread-TwoAnchor-from2.gif",alt:"Spreadsheet Picture - Starting Anchor - No Offset"})}),"\n",(0,i.jsxs)(n.h3,{id:"ending-anchor-xdrto",children:["Ending anchor (",(0,i.jsx)(n.code,{children:"<xdr:to>"}),")"]}),"\n",(0,i.jsxs)(n.p,{children:["The ending anchor defines the bottom and right sides and is specified with a ",(0,i.jsx)(n.code,{children:"<xdr:to>"})," element. ",(0,i.jsx)(n.code,{children:"<xdr:to>"})," element is defined just as the ",(0,i.jsx)(n.code,{children:"<xdr:from>"})," element--with ",(0,i.jsx)(n.code,{children:"<xdr:col>"})," and ",(0,i.jsx)(n.code,{children:"<xdr:colOff>"}),", and a ",(0,i.jsx)(n.code,{children:"<xdr:row>"})," and ",(0,i.jsx)(n.code,{children:"<xdr:rowOff>"})," elements. Note that if the editAs of ",(0,i.jsx)(n.code,{children:"<xdr:twoCellAnchor>"})," is absolute and the anchoring column or row is adjusted, then the values for the column and row elements will change. However, if the attribute value is twoCell, then the values for the column and row elements won't change, but the object size will. Below is an example of an ending anchor at the fifth column and eleventh row, with offsets for both."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<xdr:twoCellAnchor editAs="absolute">\r\n\r\n. . .\r\n\r\n<xdr:to>\r\n\r\n<xdr:col>4</xdr:col>\r\n\r\n<xdr:colOff>609600</xdr:colOff>\r\n\r\n<xdr:row>10</xdr:row>\r\n\r\n<xdr:rowOff>114300</xdr:rowOff>\r\n\r\n</xdr:to>\r\n\r\n. . .\r\n\r\n</xdr:twoCellAnchor>\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"http://officeopenxml.com/drwImages%5CdrwInSpread-TwoAnchor-to1.gif",alt:"Spreadsheet Picture - Starting Anchor - No Offset"})})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},29087:(e,n,r)=>{r.d(n,{R:()=>d,x:()=>a});var t=r(96363);const i={},o=t.createContext(i);function d(e){const n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);