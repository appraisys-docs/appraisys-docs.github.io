"use strict";(globalThis.webpackChunkappraisys_technical_documentation=globalThis.webpackChunkappraisys_technical_documentation||[]).push([[8595],{5079:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"Fundamentals/relationship-files","title":"Relationship Files (.rels)","description":"What Are Relationship Files?","source":"@site/docs/01-Fundamentals/02-relationship-files.md","sourceDirName":"01-Fundamentals","slug":"/Fundamentals/relationship-files","permalink":"/docs/Fundamentals/relationship-files","draft":false,"unlisted":false,"editUrl":"https://gitlab.devcom.com/appraisys/Atlas/docs/01-Fundamentals/02-relationship-files.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Document Structure Basics","permalink":"/docs/Fundamentals/document-structure-basics"},"next":{"title":"WordprocessingML Core Elements","permalink":"/docs/Fundamentals/wordprocessingml-core"}}');var s=r(4848),l=r(8453);const t={},d="Relationship Files (.rels)",a={},o=[{value:"What Are Relationship Files?",id:"what-are-relationship-files",level:2},{value:"Why Relationships Exist",id:"why-relationships-exist",level:2},{value:"The Problem They Solve",id:"the-problem-they-solve",level:3},{value:"The Solution: Indirect References",id:"the-solution-indirect-references",level:3},{value:"Relationship File Structure",id:"relationship-file-structure",level:2},{value:"Two Types of Relationship Files",id:"two-types-of-relationship-files",level:3},{value:"1. <strong>Package Relationships</strong> (<code>/_rels/.rels</code>)",id:"1-package-relationships-_relsrels",level:4},{value:"2. <strong>Part Relationships</strong> (<code>/word/_rels/*.xml.rels</code>)",id:"2-part-relationships-word_relsxmlrels",level:4},{value:"Anatomy of a Relationship",id:"anatomy-of-a-relationship",level:2},{value:"1. <strong>Id Attribute</strong> - The Reference Key",id:"1-id-attribute---the-reference-key",level:3},{value:"2. <strong>Type Attribute</strong> - What Kind of Resource",id:"2-type-attribute---what-kind-of-resource",level:3},{value:"3. <strong>Target Attribute</strong> - Where to Find It",id:"3-target-attribute---where-to-find-it",level:3},{value:"4. <strong>TargetMode Attribute</strong> - Internal or External",id:"4-targetmode-attribute---internal-or-external",level:3},{value:"Common Relationship Types in Detail",id:"common-relationship-types-in-detail",level:2},{value:"Images",id:"images",level:3},{value:"Hyperlinks",id:"hyperlinks",level:3},{value:"Headers and Footers",id:"headers-and-footers",level:3},{value:"Styles",id:"styles",level:3},{value:"Relationship ID Management",id:"relationship-id-management",level:2},{value:"How IDs Are Generated",id:"how-ids-are-generated",level:3},{value:"Manual ID Assignment (Advanced)",id:"manual-id-assignment-advanced",level:3},{value:"Relationship File Flow",id:"relationship-file-flow",level:2},{value:"Common Relationship Errors",id:"common-relationship-errors",level:2},{value:"Error 1: Missing Relationship",id:"error-1-missing-relationship",level:3},{value:"Error 2: Wrong Target Path",id:"error-2-wrong-target-path",level:3},{value:"Error 3: Duplicate IDs",id:"error-3-duplicate-ids",level:3},{value:"Error 4: Missing TargetMode for External Links",id:"error-4-missing-targetmode-for-external-links",level:3},{value:"Relationship Files in AppraiSys",id:"relationship-files-in-appraisys",level:2},{value:"When Images Are Added",id:"when-images-are-added",level:3},{value:"When Documents Are Merged",id:"when-documents-are-merged",level:3},{value:"Visualizing Relationships",id:"visualizing-relationships",level:2},{value:"Practical Example: Adding an Image",id:"practical-example-adding-an-image",level:2},{value:"Step-by-Step Process",id:"step-by-step-process",level:3},{value:"Debugging Relationship Issues",id:"debugging-relationship-issues",level:2},{value:"Using OpenXML SDK Productivity Tool",id:"using-openxml-sdk-productivity-tool",level:3},{value:"Manual Inspection",id:"manual-inspection",level:3},{value:"Using Validator",id:"using-validator",level:3},{value:"Quick Reference: Relationship Types",id:"quick-reference-relationship-types",level:2},{value:"Next Steps",id:"next-steps",level:2},{value:"Test Your Understanding",id:"test-your-understanding",level:2},{value:"Question 1",id:"question-1",level:3},{value:"Question 2",id:"question-2",level:3},{value:"Question 3",id:"question-3",level:3}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components},{Details:r}=n;return r||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"relationship-files-rels",children:"Relationship Files (.rels)"})}),"\n",(0,s.jsx)(n.h2,{id:"what-are-relationship-files",children:"What Are Relationship Files?"}),"\n",(0,s.jsxs)(n.p,{children:["Relationship files (",(0,s.jsx)(n.code,{children:".rels"}),") are the ",(0,s.jsx)(n.strong,{children:"glue that holds a DOCX document together"}),". They define how different parts of the document connect to each other."]}),"\n",(0,s.jsx)(n.p,{children:"Think of them as a map that tells Word:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:['"When you see ',(0,s.jsx)(n.code,{children:"rId5"})," in the document, it refers to ",(0,s.jsx)(n.code,{children:"media/image2.png"}),'"']}),"\n",(0,s.jsxs)(n.li,{children:['"This hyperlink with ',(0,s.jsx)(n.code,{children:"rId12"})," goes to ",(0,s.jsx)(n.code,{children:"https://example.com"}),'"']}),"\n",(0,s.jsxs)(n.li,{children:['"The header for this section is in ',(0,s.jsx)(n.code,{children:"header1.xml"}),'"']}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"why-relationships-exist",children:"Why Relationships Exist"}),"\n",(0,s.jsx)(n.h3,{id:"the-problem-they-solve",children:"The Problem They Solve"}),"\n",(0,s.jsx)(n.p,{children:"Imagine if every time you referenced an image, you had to write the full path in your document XML:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'\x3c!-- Without relationships (doesn\'t actually work this way) --\x3e\r\n<w:drawing>\r\n  <pic:pic source="/word/media/image1.png">\r\n</w:drawing>\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Problems"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Path changes break everything"}),"\n",(0,s.jsx)(n.li,{children:"Can't have external links"}),"\n",(0,s.jsx)(n.li,{children:"Hard to track what resources are used"}),"\n",(0,s.jsx)(n.li,{children:"Difficult to reuse resources"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"the-solution-indirect-references",children:"The Solution: Indirect References"}),"\n",(0,s.jsx)(n.p,{children:"Instead, OOXML uses relationship IDs:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'\x3c!-- In document.xml --\x3e\r\n<w:drawing>\r\n  <a:blip r:embed="rId5"/>  \x3c!-- Just an ID --\x3e\r\n</w:drawing>\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'\x3c!-- In word/_rels/document.xml.rels --\x3e\r\n<Relationship Id="rId5"\r\n              Type="http://...relationships/image"\r\n              Target="media/image1.png"/>\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Benefits"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Change the target without touching document content"}),"\n",(0,s.jsx)(n.li,{children:"Track all dependencies in one place"}),"\n",(0,s.jsx)(n.li,{children:"Support external resources"}),"\n",(0,s.jsx)(n.li,{children:"Reuse relationships across document"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"relationship-file-structure",children:"Relationship File Structure"}),"\n",(0,s.jsx)(n.mermaid,{value:'graph TD\r\n    A[Document Package] --\x3e B[Root .rels]\r\n    A --\x3e C[Part-specific .rels]\r\n    \r\n    B --\x3e B1["/_rels/.rels"]\r\n    B1 -.->|Links to| D["/word/document.xml"]\r\n    B1 -.->|Links to| E["/docProps/"]\r\n    \r\n    C --\x3e C1["/word/_rels/<br/>document.xml.rels"]\r\n    C1 -.->|Links to| F[Images]\r\n    C1 -.->|Links to| G[Headers/Footers]\r\n    C1 -.->|Links to| H[Hyperlinks]\r\n    C1 -.->|Links to| I[Styles/Numbering]\r\n    \r\n    style B1 fill:#fff3cd\r\n    style C1 fill:#d4edda'}),"\n",(0,s.jsx)(n.h3,{id:"two-types-of-relationship-files",children:"Two Types of Relationship Files"}),"\n",(0,s.jsxs)(n.h4,{id:"1-package-relationships-_relsrels",children:["1. ",(0,s.jsx)(n.strong,{children:"Package Relationships"})," (",(0,s.jsx)(n.code,{children:"/_rels/.rels"}),")"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Purpose"}),": Root-level relationships for the entire package"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": ",(0,s.jsx)(n.code,{children:"/_rels/.rels"})," (always at root)"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"What it links"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Main document part (",(0,s.jsx)(n.code,{children:"/word/document.xml"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:["Core properties (",(0,s.jsx)(n.code,{children:"/docProps/core.xml"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:["Extended properties (",(0,s.jsx)(n.code,{children:"/docProps/app.xml"}),")"]}),"\n",(0,s.jsx)(n.li,{children:"Custom properties (if any)"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Example"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\r\n  \r\n  \x3c!-- Main document --\x3e\r\n  <Relationship \r\n    Id="rId1" \r\n    Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" \r\n    Target="word/document.xml"/>\r\n  \r\n  \x3c!-- Document properties --\x3e\r\n  <Relationship \r\n    Id="rId2" \r\n    Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" \r\n    Target="docProps/core.xml"/>\r\n  \r\n  <Relationship \r\n    Id="rId3" \r\n    Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" \r\n    Target="docProps/app.xml"/>\r\n  \r\n</Relationships>\n'})}),"\n",(0,s.jsxs)(n.h4,{id:"2-part-relationships-word_relsxmlrels",children:["2. ",(0,s.jsx)(n.strong,{children:"Part Relationships"})," (",(0,s.jsx)(n.code,{children:"/word/_rels/*.xml.rels"}),")"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Purpose"}),": Relationships for a specific part"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": Parallel to the part, in ",(0,s.jsx)(n.code,{children:"_rels"})," subfolder"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Example"}),": For ",(0,s.jsx)(n.code,{children:"/word/document.xml"}),", relationships are in ",(0,s.jsx)(n.code,{children:"/word/_rels/document.xml.rels"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"What it links"}),": Everything the document content references:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Images"}),"\n",(0,s.jsx)(n.li,{children:"Hyperlinks"}),"\n",(0,s.jsx)(n.li,{children:"Headers and footers"}),"\n",(0,s.jsx)(n.li,{children:"Footnotes and endnotes"}),"\n",(0,s.jsx)(n.li,{children:"Comments"}),"\n",(0,s.jsx)(n.li,{children:"Embedded objects"}),"\n",(0,s.jsx)(n.li,{children:"Charts"}),"\n",(0,s.jsx)(n.li,{children:"Styles"}),"\n",(0,s.jsx)(n.li,{children:"Numbering"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"anatomy-of-a-relationship",children:"Anatomy of a Relationship"}),"\n",(0,s.jsx)(n.p,{children:"Each relationship has three key attributes:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<Relationship \r\n  Id="rId5"                                    \x3c!-- 1. Unique ID --\x3e\r\n  Type="http://...relationships/image"         \x3c!-- 2. Type --\x3e\r\n  Target="media/image1.png"                    \x3c!-- 3. Target --\x3e\r\n  TargetMode="Internal"/>                      \x3c!-- 4. Mode (optional) --\x3e\n'})}),"\n",(0,s.jsxs)(n.h3,{id:"1-id-attribute---the-reference-key",children:["1. ",(0,s.jsx)(n.strong,{children:"Id Attribute"})," - The Reference Key"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Unique within this relationships file"}),"\n",(0,s.jsxs)(n.li,{children:["Convention: ",(0,s.jsx)(n.code,{children:"rId1"}),", ",(0,s.jsx)(n.code,{children:"rId2"}),", etc. (but can be anything)"]}),"\n",(0,s.jsx)(n.li,{children:"Referenced from the parent part's content"}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Must be unique"})," within the file"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u26a0\ufe0f ",(0,s.jsx)(n.strong,{children:"Common Pitfall"}),": Duplicate IDs in the same ",(0,s.jsx)(n.code,{children:".rels"})," file cause corruption!"]}),"\n",(0,s.jsxs)(n.h3,{id:"2-type-attribute---what-kind-of-resource",children:["2. ",(0,s.jsx)(n.strong,{children:"Type Attribute"})," - What Kind of Resource"]}),"\n",(0,s.jsx)(n.p,{children:"Defines the relationship type using a URI. Common types:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Type URI Suffix"}),(0,s.jsx)(n.th,{children:"Purpose"}),(0,s.jsx)(n.th,{children:"Example Usage"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/image"})}),(0,s.jsx)(n.td,{children:"Embedded image"}),(0,s.jsx)(n.td,{children:"Photos, diagrams"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/hyperlink"})}),(0,s.jsx)(n.td,{children:"External hyperlink"}),(0,s.jsx)(n.td,{children:"URLs, email links"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/header"})}),(0,s.jsx)(n.td,{children:"Header XML"}),(0,s.jsx)(n.td,{children:"Page headers"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/footer"})}),(0,s.jsx)(n.td,{children:"Footer XML"}),(0,s.jsx)(n.td,{children:"Page footers"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/styles"})}),(0,s.jsx)(n.td,{children:"Styles XML"}),(0,s.jsx)(n.td,{children:"Document styles"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/numbering"})}),(0,s.jsx)(n.td,{children:"Numbering XML"}),(0,s.jsx)(n.td,{children:"List definitions"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/footnotes"})}),(0,s.jsx)(n.td,{children:"Footnotes XML"}),(0,s.jsx)(n.td,{children:"Document footnotes"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/comments"})}),(0,s.jsx)(n.td,{children:"Comments XML"}),(0,s.jsx)(n.td,{children:"Reviewer comments"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/chart"})}),(0,s.jsx)(n.td,{children:"Chart part"}),(0,s.jsx)(n.td,{children:"Embedded charts"})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Full URIs"})," (namespace prefix omitted above):"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/[type]\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"3-target-attribute---where-to-find-it",children:["3. ",(0,s.jsx)(n.strong,{children:"Target Attribute"})," - Where to Find It"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Relative path from the part's location"}),"\n",(0,s.jsx)(n.li,{children:"For internal resources: path within the ZIP"}),"\n",(0,s.jsx)(n.li,{children:"For external resources: full URL"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Examples"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'\x3c!-- Internal: relative path --\x3e\r\n<Relationship Target="media/image1.png"/>\r\n\r\n\x3c!-- Internal: absolute path from package root --\x3e\r\n<Relationship Target="/word/media/image1.png"/>\r\n\r\n\x3c!-- External: full URL --\x3e\r\n<Relationship Target="https://example.com" TargetMode="External"/>\n'})}),"\n",(0,s.jsxs)(n.h3,{id:"4-targetmode-attribute---internal-or-external",children:["4. ",(0,s.jsx)(n.strong,{children:"TargetMode Attribute"})," - Internal or External"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Internal"})," (default): Resource is inside the DOCX package"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"External"}),": Resource is outside (e.g., web URL)"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"When external"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<Relationship \r\n  Id="rId10" \r\n  Type="http://...relationships/hyperlink" \r\n  Target="https://www.appraisys.com"\r\n  TargetMode="External"/>\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"common-relationship-types-in-detail",children:"Common Relationship Types in Detail"}),"\n",(0,s.jsx)(n.h3,{id:"images",children:"Images"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Type"}),": ",(0,s.jsx)(n.code,{children:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"In document.xml"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<w:drawing>\r\n  <wp:inline>\r\n    <a:graphic>\r\n      <a:graphicData>\r\n        <pic:pic>\r\n          <pic:blipFill>\r\n            <a:blip r:embed="rId5"/>  \x3c!-- References relationship --\x3e\r\n          </pic:blipFill>\r\n        </pic:pic>\r\n      </a:graphicData>\r\n    </a:graphic>\r\n  </wp:inline>\r\n</w:drawing>\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"In document.xml.rels"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<Relationship \r\n  Id="rId5" \r\n  Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image" \r\n  Target="media/image1.png"/>\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\ud83d\udca1 ",(0,s.jsx)(n.strong,{children:"Pro Tip"}),": In AppraiSys, images for property photos use this pattern. Check ",(0,s.jsx)(n.code,{children:"DefaultDocument.cs"})," for image embedding code."]}),"\n",(0,s.jsx)(n.h3,{id:"hyperlinks",children:"Hyperlinks"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Type"}),": ",(0,s.jsx)(n.code,{children:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"In document.xml"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<w:hyperlink r:id="rId7">\r\n  <w:r>\r\n    <w:t>Click here</w:t>\r\n  </w:r>\r\n</w:hyperlink>\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"In document.xml.rels"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<Relationship \r\n  Id="rId7" \r\n  Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink" \r\n  Target="https://www.example.com"\r\n  TargetMode="External"/>\n'})}),"\n",(0,s.jsx)(n.h3,{id:"headers-and-footers",children:"Headers and Footers"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Type"}),": ",(0,s.jsx)(n.code,{children:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header"})," (or ",(0,s.jsx)(n.code,{children:"/footer"}),")"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"In document.xml"})," (within section properties):"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<w:sectPr>\r\n  <w:headerReference w:type="default" r:id="rId8"/>\r\n  <w:footerReference w:type="default" r:id="rId9"/>\r\n</w:sectPr>\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"In document.xml.rels"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<Relationship \r\n  Id="rId8" \r\n  Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/header" \r\n  Target="header1.xml"/>\r\n\r\n<Relationship \r\n  Id="rId9" \r\n  Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer" \r\n  Target="footer1.xml"/>\n'})}),"\n",(0,s.jsx)(n.h3,{id:"styles",children:"Styles"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Type"}),": ",(0,s.jsx)(n.code,{children:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"In document.xml.rels"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<Relationship \r\n  Id="rId1" \r\n  Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" \r\n  Target="styles.xml"/>\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note"}),": Usually ",(0,s.jsx)(n.code,{children:"rId1"})," because styles are fundamental to the document."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"relationship-id-management",children:"Relationship ID Management"}),"\n",(0,s.jsx)(n.h3,{id:"how-ids-are-generated",children:"How IDs Are Generated"}),"\n",(0,s.jsx)(n.p,{children:"In AppraiSys codebase, when you add a part:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'// Adding an image part\r\nvar imagePart = mainPart.AddImagePart(ImagePartType.Png);\r\nimagePart.FeedData(imageStream);\r\n\r\n// OpenXML SDK automatically creates relationship and assigns ID\r\nstring relationshipId = mainPart.GetIdOfPart(imagePart);\r\n// Returns something like "rId5"\n'})}),"\n",(0,s.jsx)(n.p,{children:"The SDK handles:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Generating unique IDs"}),"\n",(0,s.jsx)(n.li,{children:"Creating the relationship entry"}),"\n",(0,s.jsxs)(n.li,{children:["Updating the ",(0,s.jsx)(n.code,{children:".rels"})," file"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"manual-id-assignment-advanced",children:"Manual ID Assignment (Advanced)"}),"\n",(0,s.jsx)(n.p,{children:"If creating relationships manually (rare):"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'var relationship = mainPart.AddExternalRelationship(\r\n    "http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",\r\n    new Uri("https://example.com"),\r\n    "rId10"  // Explicitly specify ID\r\n);\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u26a0\ufe0f ",(0,s.jsx)(n.strong,{children:"Warning"}),": Make sure the ID is unique! Duplicates will corrupt the document."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"relationship-file-flow",children:"Relationship File Flow"}),"\n",(0,s.jsx)(n.mermaid,{value:'sequenceDiagram\r\n    participant W as Word\r\n    participant D as document.xml\r\n    participant R as document.xml.rels\r\n    participant I as media/image1.png\r\n    \r\n    W->>D: Read document\r\n    D->>D: Find <a:blip r:embed="rId5"/>\r\n    D->>R: Look up rId5\r\n    R->>R: Find Target="media/image1.png"\r\n    R->>I: Load image file\r\n    I->>W: Display image'}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"common-relationship-errors",children:"Common Relationship Errors"}),"\n",(0,s.jsx)(n.h3,{id:"error-1-missing-relationship",children:"Error 1: Missing Relationship"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Symptom"}),': Image doesn\'t appear, or Word shows "repair" dialog']}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"In document.xml"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<a:blip r:embed="rId99"/>  \x3c!-- References rId99 --\x3e\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"In document.xml.rels"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'\x3c!-- rId99 doesn\'t exist! --\x3e\r\n<Relationship Id="rId5" ... />\r\n<Relationship Id="rId6" ... />\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Fix"}),': Create the relationship with Id="rId99"']}),"\n",(0,s.jsx)(n.h3,{id:"error-2-wrong-target-path",children:"Error 2: Wrong Target Path"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Symptom"}),": Image doesn't load, broken content"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"In document.xml.rels"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<Relationship \r\n  Id="rId5" \r\n  Type="...relationships/image" \r\n  Target="media/image1.png"/>  \x3c!-- File is at media/photo1.png --\x3e\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Fix"}),": Ensure target path matches actual file location in ZIP"]}),"\n",(0,s.jsx)(n.h3,{id:"error-3-duplicate-ids",children:"Error 3: Duplicate IDs"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Symptom"}),": Document corruption, unpredictable behavior"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"In document.xml.rels"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<Relationship Id="rId5" Target="media/image1.png"/>\r\n<Relationship Id="rId5" Target="media/image2.png"/>  \x3c!-- Duplicate! --\x3e\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Fix"}),": Use unique IDs for each relationship"]}),"\n",(0,s.jsx)(n.h3,{id:"error-4-missing-targetmode-for-external-links",children:"Error 4: Missing TargetMode for External Links"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Symptom"}),": Hyperlink treated as internal path, doesn't work"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Wrong"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<Relationship \r\n  Id="rId7" \r\n  Type="...relationships/hyperlink" \r\n  Target="https://example.com"/>  \x3c!-- Missing TargetMode --\x3e\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Correct"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<Relationship \r\n  Id="rId7" \r\n  Type="...relationships/hyperlink" \r\n  Target="https://example.com"\r\n  TargetMode="External"/>  \x3c!-- Explicit external mode --\x3e\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"relationship-files-in-appraisys",children:"Relationship Files in AppraiSys"}),"\n",(0,s.jsx)(n.h3,{id:"when-images-are-added",children:"When Images Are Added"}),"\n",(0,s.jsxs)(n.p,{children:["From your codebase (",(0,s.jsx)(n.code,{children:"DefaultDocument.cs"}),"):"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"public static void AddImageToBodyFromPixels(\r\n    this WordprocessingDocument wordDoc, \r\n    string relationshipId,\r\n    int imageWidthPixels, \r\n    int imageHeightPixels, \r\n    ...)\r\n{\r\n    // Relationship already created before this method\r\n    // Just use the relationshipId in the drawing element\r\n    var element = new Drawing(\r\n        new DW.Inline(\r\n            ...\r\n            new A.Blip { Embed = relationshipId },  // Uses the relationship\r\n            ...\r\n        )\r\n    );\r\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"The relationship is created earlier:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"// In your image processing pipeline\r\nvar imagePart = mainPart.AddImagePart(ImagePartType.Png);\r\nimagePart.FeedData(imageStream);\r\nstring relationshipId = mainPart.GetIdOfPart(imagePart);\r\n\r\n// This automatically creates entry in document.xml.rels\n"})}),"\n",(0,s.jsx)(n.h3,{id:"when-documents-are-merged",children:"When Documents Are Merged"}),"\n",(0,s.jsxs)(n.p,{children:["From ",(0,s.jsx)(n.code,{children:"MergeReportSectionsConsumer"})," pattern:"]}),"\n",(0,s.jsx)(n.p,{children:"When merging multiple sections:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Each section has its own relationships"}),"\n",(0,s.jsxs)(n.li,{children:["IDs might conflict (both use ",(0,s.jsx)(n.code,{children:"rId5"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:["Must ",(0,s.jsx)(n.strong,{children:"renumber relationships"})," to avoid conflicts"]}),"\n",(0,s.jsx)(n.li,{children:"Update all references in content"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Strategy"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"// Pseudo-code from your merge logic\r\nforeach (var section in sections)\r\n{\r\n    var idMap = new Dictionary<string, string>();\r\n    \r\n    foreach (var rel in section.Relationships)\r\n    {\r\n        string newId = GenerateUniqueId();  // e.g., rId100, rId101...\r\n        idMap[rel.Id] = newId;\r\n        \r\n        // Create relationship with new ID\r\n        targetDoc.AddRelationship(rel.Type, rel.Target, newId);\r\n    }\r\n    \r\n    // Update all r:id references in content\r\n    UpdateRelationshipReferences(section.Content, idMap);\r\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\ud83d\udd17 ",(0,s.jsx)(n.strong,{children:"See Also"}),": ",(0,s.jsx)(n.a,{href:"../advanced/document-assembly.md",children:"Document Assembly"})," for complete merging patterns"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"visualizing-relationships",children:"Visualizing Relationships"}),"\n",(0,s.jsx)(n.mermaid,{value:"graph TD\r\n    A[document.xml] --\x3e|r:embed=rId5| B[document.xml.rels]\r\n    A --\x3e|r:id=rId7| B\r\n    A --\x3e|r:id=rId8| B\r\n    \r\n    B --\x3e|Id=rId5<br/>Type=image| C[media/image1.png]\r\n    B --\x3e|Id=rId7<br/>Type=hyperlink| D[https://example.com]\r\n    B --\x3e|Id=rId8<br/>Type=header| E[header1.xml]\r\n    \r\n    E --\x3e|r:embed=rId1| F[header1.xml.rels]\r\n    F --\x3e|Id=rId1<br/>Type=image| G[media/logo.png]\r\n    \r\n    style A fill:#e1f5ff\r\n    style B fill:#fff3cd\r\n    style C fill:#d4edda\r\n    style D fill:#ffe6e6\r\n    style E fill:#e1f5ff\r\n    style F fill:#fff3cd\r\n    style G fill:#d4edda"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Key Insight"}),": Relationships can chain! A header can have its own relationships to images."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"practical-example-adding-an-image",children:"Practical Example: Adding an Image"}),"\n",(0,s.jsx)(n.h3,{id:"step-by-step-process",children:"Step-by-Step Process"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["Add image file to ",(0,s.jsx)(n.code,{children:"/word/media/"})]})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"/word/media/property_photo.jpg\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["Create relationship in ",(0,s.jsx)(n.code,{children:"/word/_rels/document.xml.rels"})]})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<Relationship \r\n  Id="rId15" \r\n  Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image" \r\n  Target="media/property_photo.jpg"/>\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["Reference in ",(0,s.jsx)(n.code,{children:"/word/document.xml"})]})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<w:p>\r\n  <w:r>\r\n    <w:drawing>\r\n      <wp:inline>\r\n        <a:graphic>\r\n          <a:graphicData>\r\n            <pic:pic>\r\n              <pic:blipFill>\r\n                <a:blip r:embed="rId15"/>  \x3c!-- References relationship --\x3e\r\n              </pic:blipFill>\r\n            </pic:pic>\r\n          </a:graphicData>\r\n        </a:graphic>\r\n      </wp:inline>\r\n    </w:drawing>\r\n  </w:r>\r\n</w:p>\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsxs)(n.strong,{children:["Update ",(0,s.jsx)(n.code,{children:"[Content_Types].xml"})]})," (if file type not already listed)"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<Default Extension="jpg" ContentType="image/jpeg"/>\n'})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Miss any step?"})," \u2192 Image won't appear or document corrupts!"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"debugging-relationship-issues",children:"Debugging Relationship Issues"}),"\n",(0,s.jsx)(n.h3,{id:"using-openxml-sdk-productivity-tool",children:"Using OpenXML SDK Productivity Tool"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Open your DOCX in the tool"}),"\n",(0,s.jsxs)(n.li,{children:["Navigate to ",(0,s.jsx)(n.strong,{children:"Document Parts"})]}),"\n",(0,s.jsxs)(n.li,{children:["Find ",(0,s.jsx)(n.code,{children:"/_rels/.rels"})," and ",(0,s.jsx)(n.code,{children:"/word/_rels/document.xml.rels"})]}),"\n",(0,s.jsx)(n.li,{children:"Inspect relationships visually"}),"\n",(0,s.jsx)(n.li,{children:"Validate for errors"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"manual-inspection",children:"Manual Inspection"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-powershell",children:"# Extract DOCX\r\nExpand-Archive document.docx -DestinationPath extracted\r\n\r\n# View relationships file\r\ncat extracted/word/_rels/document.xml.rels\n"})}),"\n",(0,s.jsx)(n.p,{children:"Look for:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Duplicate IDs"}),"\n",(0,s.jsx)(n.li,{children:"Missing targets"}),"\n",(0,s.jsx)(n.li,{children:"Incorrect types"}),"\n",(0,s.jsx)(n.li,{children:"Missing TargetMode for external links"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"using-validator",children:"Using Validator"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'using DocumentFormat.OpenXml.Packaging;\r\nusing DocumentFormat.OpenXml.Validation;\r\n\r\nvar validator = new OpenXmlValidator();\r\nvar errors = validator.Validate(wordDoc);\r\n\r\nforeach (var error in errors)\r\n{\r\n    if (error.Description.Contains("relationship"))\r\n    {\r\n        Console.WriteLine($"Relationship error: {error.Description}");\r\n        Console.WriteLine($"Location: {error.Path.XPath}");\r\n    }\r\n}\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"quick-reference-relationship-types",children:"Quick Reference: Relationship Types"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Resource"}),(0,s.jsx)(n.th,{children:"Type URI Suffix"}),(0,s.jsx)(n.th,{children:"TargetMode"}),(0,s.jsx)(n.th,{children:"Example Target"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Image"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/image"})}),(0,s.jsx)(n.td,{children:"Internal"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"media/image1.png"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Hyperlink"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/hyperlink"})}),(0,s.jsx)(n.td,{children:"External"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"https://example.com"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Header"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/header"})}),(0,s.jsx)(n.td,{children:"Internal"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"header1.xml"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Footer"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/footer"})}),(0,s.jsx)(n.td,{children:"Internal"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"footer1.xml"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Styles"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/styles"})}),(0,s.jsx)(n.td,{children:"Internal"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"styles.xml"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Numbering"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/numbering"})}),(0,s.jsx)(n.td,{children:"Internal"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"numbering.xml"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Footnotes"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/footnotes"})}),(0,s.jsx)(n.td,{children:"Internal"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"footnotes.xml"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Comments"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/comments"})}),(0,s.jsx)(n.td,{children:"Internal"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"comments.xml"})})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Full Type URI"}),": ",(0,s.jsx)(n.code,{children:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/[suffix]"})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,s.jsx)(n.p,{children:"Now that you understand how document parts connect, learn about the actual content structure:"}),"\n",(0,s.jsxs)(n.p,{children:["\u27a1\ufe0f ",(0,s.jsx)(n.strong,{children:"Next"}),": ",(0,s.jsx)(n.a,{href:"/docs/Fundamentals/wordprocessingml-core",children:"WordprocessingML Core"})," - Paragraphs, runs, and text"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Related Topics"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/docs/Fundamentals/element-hierarchy-rules",children:"Element Hierarchy Rules"})," - Valid nesting"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"../code-examples/image-handling.md",children:"Image Handling"})," - Code examples"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"test-your-understanding",children:"Test Your Understanding"}),"\n",(0,s.jsx)(n.h3,{id:"question-1",children:"Question 1"}),"\n",(0,s.jsxs)(n.p,{children:["You add an image to ",(0,s.jsx)(n.code,{children:"/word/media/photo.jpg"})," but forget to create a relationship. What happens?"]}),"\n",(0,s.jsxs)(r,{children:[(0,s.jsx)("summary",{children:"Answer"}),(0,s.jsx)(n.p,{children:"The image file exists in the DOCX archive, but Word can't display it because there's no relationship mapping an ID to the file. The document will open, but the image location will be blank or show an error placeholder."})]}),"\n",(0,s.jsx)(n.h3,{id:"question-2",children:"Question 2"}),"\n",(0,s.jsx)(n.p,{children:"Can two different images share the same relationship ID?"}),"\n",(0,s.jsxs)(r,{children:[(0,s.jsx)("summary",{children:"Answer"}),(0,s.jsxs)(n.p,{children:["No! Each relationship ID must be unique within a ",(0,s.jsx)(n.code,{children:".rels"})," file. However, the same image file can be referenced by multiple relationship IDs if you want to use the same image in different places."]})]}),"\n",(0,s.jsx)(n.h3,{id:"question-3",children:"Question 3"}),"\n",(0,s.jsxs)(n.p,{children:["What's the difference between ",(0,s.jsx)(n.code,{children:'Target="image.png"'})," and ",(0,s.jsx)(n.code,{children:'Target="media/image.png"'}),"?"]}),"\n",(0,s.jsxs)(r,{children:[(0,s.jsx)("summary",{children:"Answer"}),(0,s.jsxs)(n.p,{children:["Both are relative paths from the location of the ",(0,s.jsx)(n.code,{children:".rels"})," file. If the ",(0,s.jsx)(n.code,{children:".rels"})," file is at ",(0,s.jsx)(n.code,{children:"/word/_rels/document.xml.rels"}),":"]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:'Target="image.png"'})," \u2192 looks for ",(0,s.jsx)(n.code,{children:"/word/image.png"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:'Target="media/image.png"'})," \u2192 looks for ",(0,s.jsx)(n.code,{children:"/word/media/image.png"})]}),"\n"]}),(0,s.jsx)(n.p,{children:"Always use paths relative to the part, not the package root."})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.p,{children:["\ud83d\udca1 ",(0,s.jsx)(n.strong,{children:"Remember"}),": Relationships are the glue! Break them, and your document falls apart. Master them, and you control how every part connects!"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>d});var i=r(6540);const s={},l=i.createContext(s);function t(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);