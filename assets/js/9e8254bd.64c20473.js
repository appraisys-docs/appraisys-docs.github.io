"use strict";(globalThis.webpackChunkappraisys_technical_documentation=globalThis.webpackChunkappraisys_technical_documentation||[]).push([[1458],{8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>o});var r=s(6540);const i={},l=r.createContext(i);function t(e){const n=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),r.createElement(l.Provider,{value:n},e.children)}},9386:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"Appendices/troubleshooting-guide","title":"Troubleshooting Guide","description":"Document Won\'t Open in Word","source":"@site/docs/06-Appendices/01-troubleshooting-guide.md","sourceDirName":"06-Appendices","slug":"/Appendices/troubleshooting-guide","permalink":"/docs/Appendices/troubleshooting-guide","draft":false,"unlisted":false,"editUrl":"https://gitlab.devcom.com/appraisys/Atlas/docs/06-Appendices/01-troubleshooting-guide.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Table Creation Code Examples","permalink":"/docs/Code examples/table-creation"},"next":{"title":"Documentation Progress Report","permalink":"/docs/PROGRESS"}}');var i=s(4848),l=s(8453);const t={},o="Troubleshooting Guide",a={},d=[{value:"Document Won&#39;t Open in Word",id:"document-wont-open-in-word",level:2},{value:"Symptom: &quot;Word found unreadable content&quot;",id:"symptom-word-found-unreadable-content",level:3},{value:"Possible Causes",id:"possible-causes",level:4},{value:"Diagnosis Steps",id:"diagnosis-steps",level:4},{value:"Common Fixes",id:"common-fixes",level:4},{value:"Images Not Displaying",id:"images-not-displaying",level:2},{value:"Symptom: Empty boxes or &quot;X&quot; placeholders",id:"symptom-empty-boxes-or-x-placeholders",level:3},{value:"Possible Causes",id:"possible-causes-1",level:4},{value:"Diagnosis Steps",id:"diagnosis-steps-1",level:4},{value:"Common Fixes",id:"common-fixes-1",level:4},{value:"Table Layout Issues",id:"table-layout-issues",level:2},{value:"Symptom: Cells wrong width, text cut off",id:"symptom-cells-wrong-width-text-cut-off",level:3},{value:"Possible Causes",id:"possible-causes-2",level:4},{value:"Diagnosis Steps",id:"diagnosis-steps-2",level:4},{value:"Common Fixes",id:"common-fixes-2",level:4},{value:"Content Controls Not Working",id:"content-controls-not-working",level:2},{value:"Symptom: Fields not populating, SDT missing",id:"symptom-fields-not-populating-sdt-missing",level:3},{value:"Possible Causes",id:"possible-causes-3",level:4},{value:"Diagnosis Steps",id:"diagnosis-steps-3",level:4},{value:"Common Fixes",id:"common-fixes-3",level:4},{value:"Formatting Lost After Conversion",id:"formatting-lost-after-conversion",level:2},{value:"Symptom: Styles missing after DOCX \u2192 SFDT \u2192 DOCX",id:"symptom-styles-missing-after-docx--sfdt--docx",level:3},{value:"Possible Causes",id:"possible-causes-4",level:4},{value:"Diagnosis Steps",id:"diagnosis-steps-4",level:4},{value:"Common Fixes",id:"common-fixes-4",level:4},{value:"Validation Errors",id:"validation-errors",level:2},{value:"Common Validation Messages",id:"common-validation-messages",level:3},{value:"Error: &quot;Attribute &#39;val&#39; is required&quot;",id:"error-attribute-val-is-required",level:4},{value:"Error: &quot;Element X cannot be child of element Y&quot;",id:"error-element-x-cannot-be-child-of-element-y",level:4},{value:"Error: &quot;Required element missing&quot;",id:"error-required-element-missing",level:4},{value:"Performance Issues",id:"performance-issues",level:2},{value:"Symptom: Document generation slow",id:"symptom-document-generation-slow",level:3},{value:"Possible Causes",id:"possible-causes-5",level:4},{value:"Common Fixes",id:"common-fixes-5",level:4},{value:"Syncfusion-Specific Issues",id:"syncfusion-specific-issues",level:2},{value:"Issue: Extra Blank Paragraphs",id:"issue-extra-blank-paragraphs",level:3},{value:"Issue: TOC Not Updating",id:"issue-toc-not-updating",level:3},{value:"Issue: Image URLs Not Working",id:"issue-image-urls-not-working",level:3},{value:"Debugging Checklist",id:"debugging-checklist",level:2},{value:"Before Reporting Bug",id:"before-reporting-bug",level:3},{value:"Information to Provide",id:"information-to-provide",level:3},{value:"Quick Fixes Reference",id:"quick-fixes-reference",level:2},{value:"Useful Commands",id:"useful-commands",level:2},{value:"Validate Document (PowerShell)",id:"validate-document-powershell",level:3},{value:"Extract DOCX (Command Line)",id:"extract-docx-command-line",level:3},{value:"Resources",id:"resources",level:2},{value:"Next Steps",id:"next-steps",level:2}];function c(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"troubleshooting-guide",children:"Troubleshooting Guide"})}),"\n",(0,i.jsx)(n.h2,{id:"document-wont-open-in-word",children:"Document Won't Open in Word"}),"\n",(0,i.jsx)(n.h3,{id:"symptom-word-found-unreadable-content",children:'Symptom: "Word found unreadable content"'}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Error Dialog"}),":"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:'"Word found unreadable content in [filename].docx. Do you want to recover the contents of this document?"'}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"possible-causes",children:"Possible Causes"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Malformed XML"})," - Syntax errors in document.xml"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Invalid Element Nesting"})," - Wrong hierarchy"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Missing Required Elements"})," - Elements without required children"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Broken Relationships"})," - Missing or invalid .rels entries"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"diagnosis-steps",children:"Diagnosis Steps"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Step 1: Use OpenXML SDK Tool"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'1. Open OpenXML SDK Productivity Tool\r\n2. File \u2192 Open \u2192 Select DOCX\r\n3. Click "Validate"\r\n4. Review errors in bottom panel\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Step 2: Manual XML Inspection"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"1. Rename .docx to .zip\r\n2. Extract contents\r\n3. Open word/document.xml in text editor\r\n4. Look for XML syntax errors\n"})}),"\n",(0,i.jsx)(n.h4,{id:"common-fixes",children:"Common Fixes"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Fix 1: Text Without Run"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:"\x3c!-- WRONG --\x3e\r\n<w:p>\r\n  <w:t>Text</w:t>\r\n</w:p>\r\n\r\n\x3c!-- CORRECT --\x3e\r\n<w:p>\r\n  <w:r><w:t>Text</w:t></w:r>\r\n</w:p>\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Fix 2: Table in Wrong Location"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:"\x3c!-- WRONG --\x3e\r\n<w:r>\r\n  <w:tbl>...</w:tbl>\r\n</w:r>\r\n\r\n\x3c!-- CORRECT --\x3e\r\n<w:body>\r\n  <w:tbl>...</w:tbl>\r\n</w:body>\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Fix 3: Missing Table Grid"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'\x3c!-- WRONG --\x3e\r\n<w:tbl>\r\n  <w:tblPr>...</w:tblPr>\r\n  <w:tr>...</w:tr>\r\n</w:tbl>\r\n\r\n\x3c!-- CORRECT --\x3e\r\n<w:tbl>\r\n  <w:tblPr>...</w:tblPr>\r\n  <w:tblGrid>\r\n    <w:gridCol w:w="5000"/>\r\n  </w:tblGrid>\r\n  <w:tr>...</w:tr>\r\n</w:tbl>\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"images-not-displaying",children:"Images Not Displaying"}),"\n",(0,i.jsx)(n.h3,{id:"symptom-empty-boxes-or-x-placeholders",children:'Symptom: Empty boxes or "X" placeholders'}),"\n",(0,i.jsx)(n.h4,{id:"possible-causes-1",children:"Possible Causes"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Missing Image File"})," - File not in /word/media/"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Broken Relationship"})," - Invalid relationship ID"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Incorrect Path"})," - Wrong target in .rels file"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Corrupted Image"})," - Invalid image data"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"diagnosis-steps-1",children:"Diagnosis Steps"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Step 1: Check if Image Files Exist"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"1. Rename .docx to .zip\r\n2. Open archive\r\n3. Navigate to /word/media/\r\n4. Verify image files present\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Step 2: Check Relationships"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"1. Open /word/_rels/document.xml.rels\r\n2. Find image relationships\r\n3. Verify Target path matches actual file\n"})}),"\n",(0,i.jsx)(n.p,{children:"Example relationship:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<Relationship Id="rId5" \r\n              Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"\r\n              Target="media/image1.png"/>\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Step 3: Check Image Reference in Document"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<a:blip r:embed="rId5"/>  \x3c!-- Must match relationship ID --\x3e\n'})}),"\n",(0,i.jsx)(n.h4,{id:"common-fixes-1",children:"Common Fixes"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Fix 1: Missing Image Part"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'// Add image to document\r\nImagePart imagePart = mainPart.AddImagePart(ImagePartType.Png);\r\n\r\nusing (FileStream stream = new FileStream("image.png", FileMode.Open))\r\n{\r\n    imagePart.FeedData(stream);\r\n}\r\n\r\nstring relationshipId = mainPart.GetIdOfPart(imagePart);\r\n\r\n// Use relationshipId in drawing element\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Fix 2: Wrong Relationship ID"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"// Get correct relationship ID\r\nstring relationshipId = mainPart.GetIdOfPart(imagePart);\r\n\r\n// Update blip reference\r\nvar blip = drawing.Descendants<Blip>().First();\r\nblip.Embed = relationshipId;\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"table-layout-issues",children:"Table Layout Issues"}),"\n",(0,i.jsx)(n.h3,{id:"symptom-cells-wrong-width-text-cut-off",children:"Symptom: Cells wrong width, text cut off"}),"\n",(0,i.jsx)(n.h4,{id:"possible-causes-2",children:"Possible Causes"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Grid/Cell Width Mismatch"})," - Cell width doesn't match grid"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Missing gridSpan"})," - Merged cells not defined"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Percentage vs Absolute"})," - Mixing width types"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Cell Content Too Large"})," - Content exceeds cell width"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"diagnosis-steps-2",children:"Diagnosis Steps"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Step 1: Check Table Grid"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<w:tblGrid>\r\n  <w:gridCol w:w="3000"/>  \x3c!-- Column 1: 3000 twips --\x3e\r\n  <w:gridCol w:w="3000"/>  \x3c!-- Column 2: 3000 twips --\x3e\r\n</w:tblGrid>\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Step 2: Check Cell Widths"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<w:tc>\r\n  <w:tcPr>\r\n    <w:tcW w:w="3000" w:type="dxa"/>  \x3c!-- Must match grid --\x3e\r\n  </w:tcPr>\r\n  ...\r\n</w:tc>\n'})}),"\n",(0,i.jsx)(n.h4,{id:"common-fixes-2",children:"Common Fixes"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Fix 1: Recalculate Cell Widths"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"// Total table width\r\nint totalWidth = 5000;  // twips\r\n\r\n// Number of columns\r\nint columnCount = 3;\r\n\r\n// Width per column\r\nint columnWidth = totalWidth / columnCount;\r\n\r\n// Apply to grid\r\nvar tableGrid = new TableGrid();\r\nfor (int i = 0; i < columnCount; i++)\r\n{\r\n    tableGrid.AppendChild(new GridColumn { Width = columnWidth.ToString() });\r\n}\r\n\r\n// Apply to cells\r\nforeach (var cell in row.Elements<TableCell>())\r\n{\r\n    var cellProps = cell.GetFirstChild<TableCellProperties>();\r\n    if (cellProps == null)\r\n    {\r\n        cellProps = new TableCellProperties();\r\n        cell.InsertAt(cellProps, 0);\r\n    }\r\n    \r\n    cellProps.AppendChild(new TableCellWidth \r\n    { \r\n        Width = columnWidth.ToString(), \r\n        Type = TableWidthUnitValues.Dxa \r\n    });\r\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Fix 2: Handle Merged Cells"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"// Cell spanning 2 columns\r\nvar mergedCell = new TableCell();\r\nmergedCell.AppendChild(new TableCellProperties(\r\n    new TableCellWidth { Width = (columnWidth * 2).ToString(), Type = TableWidthUnitValues.Dxa },\r\n    new GridSpan { Val = 2 }  // Spans 2 columns\r\n));\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"content-controls-not-working",children:"Content Controls Not Working"}),"\n",(0,i.jsx)(n.h3,{id:"symptom-fields-not-populating-sdt-missing",children:"Symptom: Fields not populating, SDT missing"}),"\n",(0,i.jsx)(n.h4,{id:"possible-causes-3",children:"Possible Causes"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Wrong SDT Type"})," - Block vs Inline mismatch"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Missing sdtContent"})," - No content wrapper"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Mail Merge Settings"})," - ClearFields = true"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Syncfusion Bug"})," - Content control flattened"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"diagnosis-steps-3",children:"Diagnosis Steps"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Step 1: Check SDT Structure"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<w:sdt>\r\n  <w:sdtPr>\r\n    <w:tag w:val="FieldName"/>\r\n  </w:sdtPr>\r\n  <w:sdtContent>\r\n    \x3c!-- Content here --\x3e\r\n  </w:sdtContent>\r\n</w:sdt>\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Step 2: Check Mail Merge Settings"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"// In AppraiSys pattern\r\nDestinationDocument.MailMerge.ClearFields = false;  // Don't remove fields\n"})}),"\n",(0,i.jsx)(n.h4,{id:"common-fixes-3",children:"Common Fixes"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Fix 1: Use Correct SDT Type"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"// Block-level (for paragraphs/tables)\r\nvar sdtBlock = new SdtBlock();\r\n\r\n// Inline (for text within paragraph)\r\nvar sdtRun = new SdtRun();\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Fix 2: Preserve Content Controls"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"// Before mail merge\r\ndocument.MailMerge.ClearFields = false;\r\n\r\n// Process fields\r\ndocument.MailMerge.Execute(data);\r\n\r\n// Content controls retained\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"formatting-lost-after-conversion",children:"Formatting Lost After Conversion"}),"\n",(0,i.jsx)(n.h3,{id:"symptom-styles-missing-after-docx--sfdt--docx",children:"Symptom: Styles missing after DOCX \u2192 SFDT \u2192 DOCX"}),"\n",(0,i.jsx)(n.h4,{id:"possible-causes-4",children:"Possible Causes"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Styles Not Defined"})," - Style referenced but not in styles.xml"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Syncfusion Simplification"})," - Some formatting simplified"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Conversion Bugs"})," - Known Syncfusion limitations"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Local Overrides Lost"})," - Direct formatting removed"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"diagnosis-steps-4",children:"Diagnosis Steps"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Step 1: Check Styles Exist"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'// Verify style exists\r\nvar styleExists = stylesPart.Styles.Elements<Style>()\r\n    .Any(s => s.StyleId == "Heading1");\r\n\r\nif (!styleExists)\r\n{\r\n    // Style missing - create it\r\n    CreateParagraphStyle(stylesPart.Styles, "Heading1", "Heading 1", 98);\r\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Step 2: Compare Before/After"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'// Original\r\nvar originalDoc = WordprocessingDocument.Open("original.docx", false);\r\n\r\n// After conversion\r\nvar sfdt = DocumentToSfdtFormat.Convert(originalStream);\r\nvar convertedStream = ConvertSfdtToDocx(sfdt);\r\nvar convertedDoc = WordprocessingDocument.Open(convertedStream, false);\r\n\r\n// Compare styles\r\nCompareStyles(originalDoc, convertedDoc);\n'})}),"\n",(0,i.jsx)(n.h4,{id:"common-fixes-4",children:"Common Fixes"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Fix 1: Re-apply Styles After Conversion"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"// After SFDT \u2192 DOCX conversion\r\nusing (var doc = WordprocessingDocument.Open(stream, true))\r\n{\r\n    var mainPart = doc.MainDocumentPart;\r\n    \r\n    // Ensure styles part exists\r\n    if (mainPart.StyleDefinitionsPart == null)\r\n    {\r\n        var stylesPart = mainPart.AddNewPart<StyleDefinitionsPart>();\r\n        CreateDefaultStyles(stylesPart.Styles);\r\n    }\r\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Fix 2: Use Direct Formatting for Critical Elements"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'// Don\'t rely on styles for critical formatting\r\nvar run = new Run();\r\nvar runProps = new RunProperties(\r\n    new Bold(),\r\n    new FontSize { Val = "28" },\r\n    new Color { Val = "FF0000" }\r\n);\r\nrun.AppendChild(runProps);\r\nrun.AppendChild(new Text("Critical Text"));\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"validation-errors",children:"Validation Errors"}),"\n",(0,i.jsx)(n.h3,{id:"common-validation-messages",children:"Common Validation Messages"}),"\n",(0,i.jsx)(n.h4,{id:"error-attribute-val-is-required",children:"Error: \"Attribute 'val' is required\""}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Meaning"}),": Element missing required attribute"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Example"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'\x3c!-- WRONG --\x3e\r\n<w:b/>  \x3c!-- Some elements need val attribute --\x3e\r\n\r\n\x3c!-- CORRECT --\x3e\r\n<w:b w:val="true"/>\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Fix"}),": Add required attribute (check ECMA-376 spec)"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h4,{id:"error-element-x-cannot-be-child-of-element-y",children:'Error: "Element X cannot be child of element Y"'}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Meaning"}),": Invalid element nesting"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Example"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:"\x3c!-- WRONG --\x3e\r\n<w:p>\r\n  <w:tbl>...</w:tbl>\r\n</w:p>\r\n\r\n\x3c!-- CORRECT --\x3e\r\n<w:body>\r\n  <w:p>...</w:p>\r\n  <w:tbl>...</w:tbl>\r\n</w:body>\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Fix"}),": Review element hierarchy rules"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h4,{id:"error-required-element-missing",children:'Error: "Required element missing"'}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Meaning"}),": Parent element missing required child"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Example"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:"\x3c!-- WRONG --\x3e\r\n<w:tc>\r\n  \x3c!-- Missing paragraph --\x3e\r\n</w:tc>\r\n\r\n\x3c!-- CORRECT --\x3e\r\n<w:tc>\r\n  <w:p/>  \x3c!-- Required --\x3e\r\n</w:tc>\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Fix"}),": Add required child element"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"performance-issues",children:"Performance Issues"}),"\n",(0,i.jsx)(n.h3,{id:"symptom-document-generation-slow",children:"Symptom: Document generation slow"}),"\n",(0,i.jsx)(n.h4,{id:"possible-causes-5",children:"Possible Causes"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Large Images"})," - Uncompressed images"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Too Many Elements"})," - Document too complex"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Inefficient Code"})," - Repeated lookups"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Memory Leaks"})," - Not disposing objects"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"common-fixes-5",children:"Common Fixes"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Fix 1: Compress Images"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"// Resize/compress before embedding\r\nusing (var image = Image.Load(imageBytes))\r\n{\r\n    image.Mutate(x => x.Resize(new ResizeOptions\r\n    {\r\n        Size = new Size(800, 600),\r\n        Mode = ResizeMode.Max\r\n    }));\r\n    \r\n    image.Save(outputStream, new JpegEncoder { Quality = 85 });\r\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Fix 2: Batch Operations"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"// Instead of repeated lookups\r\nvar paragraphs = body.Elements<Paragraph>().ToList();\r\n\r\nforeach (var para in paragraphs)\r\n{\r\n    // Process\r\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Fix 3: Dispose Properly"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"// AppraiSys pattern\r\nusing (var doc = new WordDocument(stream, FormatType.Docx))\r\n{\r\n    // Process\r\n    doc.Save(outputStream, FormatType.Docx);\r\n}  // Automatically disposed\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"syncfusion-specific-issues",children:"Syncfusion-Specific Issues"}),"\n",(0,i.jsx)(n.h3,{id:"issue-extra-blank-paragraphs",children:"Issue: Extra Blank Paragraphs"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Symptom"}),": Blank paragraphs appear after conversion"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Cause"}),": Syncfusion SFDT adds spacing paragraphs"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Fix"}),": Post-process to remove empty blocks"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"// Remove empty paragraphs\r\nvar emptyParas = body.Elements<Paragraph>()\r\n    .Where(p => !p.Elements<Run>().Any())\r\n    .ToList();\r\n\r\nforeach (var para in emptyParas)\r\n{\r\n    para.Remove();\r\n}\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"issue-toc-not-updating",children:"Issue: TOC Not Updating"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Symptom"}),": Table of contents shows placeholder text"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Cause"}),": SFDT doesn't support automatic TOC update"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Fix"}),": Update TOC after final DOCX generation"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"// After SFDT \u2192 DOCX\r\nusing (var doc = WordprocessingDocument.Open(stream, true))\r\n{\r\n    // TOC must be updated in Word or via automation\r\n    // Flag TOC for update\r\n    var updateFields = new UpdateFieldsOnOpen { Val = true };\r\n    doc.MainDocumentPart.DocumentSettingsPart.Settings.Append(updateFields);\r\n}\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"issue-image-urls-not-working",children:"Issue: Image URLs Not Working"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Symptom"}),": External image URLs don't display"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Cause"}),": Syncfusion requires base64 for reliable rendering"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Fix"}),": Download and encode images (AppraiSys pattern)"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'// From DocumentToPdfConverter.cs\r\nvar imagesToDownload = sfdtWrapper?.Images\r\n    .Where(x => x.Value.FirstOrDefault()?.StartsWith("http") ?? false)\r\n    .ToList();\r\n\r\nforeach (var imageUrl in imagesToDownload)\r\n{\r\n    var bytes = await httpClient.GetByteArrayAsync(imageUrl);\r\n    var base64 = Convert.ToBase64String(bytes);\r\n    \r\n    sfdtWrapper.Images[key].Insert(0, \r\n        $"data:image/png;base64,{base64}"\r\n    );\r\n}\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"debugging-checklist",children:"Debugging Checklist"}),"\n",(0,i.jsx)(n.h3,{id:"before-reporting-bug",children:"Before Reporting Bug"}),"\n",(0,i.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Validated with OpenXML SDK tool"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Checked element hierarchy"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Verified all required elements present"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Checked relationships intact"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Tested in clean Word installation"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Reproduced on another machine"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Checked AppraiSys patches applied"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Reviewed similar issues in docs"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"information-to-provide",children:"Information to Provide"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Error Message"}),": Exact text"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Document ID"}),": Report/template ID"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Steps to Reproduce"}),": Detailed steps"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Expected vs Actual"}),": What should happen vs what happens"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Validation Errors"}),": Output from OpenXML SDK tool"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Screenshots"}),": Visual evidence"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Sample File"}),": Minimal example demonstrating issue"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"quick-fixes-reference",children:"Quick Fixes Reference"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Problem"}),(0,i.jsx)(n.th,{children:"Quick Check"}),(0,i.jsx)(n.th,{children:"Quick Fix"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Document won't open"}),(0,i.jsx)(n.td,{children:"Validate XML"}),(0,i.jsx)(n.td,{children:"Fix element hierarchy"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Images missing"}),(0,i.jsx)(n.td,{children:"Check /word/media/"}),(0,i.jsx)(n.td,{children:"Add image parts"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Table layout broken"}),(0,i.jsx)(n.td,{children:"Check grid vs cells"}),(0,i.jsx)(n.td,{children:"Recalculate widths"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Formatting lost"}),(0,i.jsx)(n.td,{children:"Check styles.xml exists"}),(0,i.jsx)(n.td,{children:"Re-create styles"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Content control missing"}),(0,i.jsx)(n.td,{children:"Check mail merge settings"}),(0,i.jsx)(n.td,{children:"Set ClearFields = false"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Extra blank pages"}),(0,i.jsx)(n.td,{children:"Show formatting marks"}),(0,i.jsx)(n.td,{children:"Remove empty paragraphs"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Slow generation"}),(0,i.jsx)(n.td,{children:"Check image sizes"}),(0,i.jsx)(n.td,{children:"Compress images"})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"useful-commands",children:"Useful Commands"}),"\n",(0,i.jsx)(n.h3,{id:"validate-document-powershell",children:"Validate Document (PowerShell)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-powershell",children:'# Using OpenXML SDK\r\n[Reflection.Assembly]::LoadFrom("C:\\path\\to\\DocumentFormat.OpenXml.dll")\r\n$doc = [DocumentFormat.OpenXml.Packaging.WordprocessingDocument]::Open("file.docx", $false)\r\n$validator = New-Object DocumentFormat.OpenXml.Validation.OpenXmlValidator\r\n$errors = $validator.Validate($doc)\r\n$errors | ForEach-Object { Write-Host $_.Description }\r\n$doc.Close()\n'})}),"\n",(0,i.jsx)(n.h3,{id:"extract-docx-command-line",children:"Extract DOCX (Command Line)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Extract to folder\r\nunzip document.docx -d extracted/\r\n\r\n# View document.xml\r\ncat extracted/word/document.xml | xmllint --format -\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"resources",children:"Resources"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"http://www.ecma-international.org/publications/standards/Ecma-376.htm",children:"ECMA-376 Specification"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/office/open-xml/open-xml-sdk",children:"OpenXML SDK Documentation"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://help.syncfusion.com/",children:"Syncfusion Documentation"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://stackoverflow.com/questions/tagged/openxml",children:"Stack Overflow: openxml tag"})}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,i.jsx)(n.p,{children:"If issue not resolved:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Check ",(0,i.jsx)(n.a,{href:"/docs/Fundamentals/common-fatal-mistakes",children:"Common Fatal Mistakes"})]}),"\n",(0,i.jsxs)(n.li,{children:["Review ",(0,i.jsx)(n.a,{href:"/docs/Fundamentals/element-hierarchy-rules",children:"Element Hierarchy Rules"})]}),"\n",(0,i.jsxs)(n.li,{children:["Consult ",(0,i.jsx)(n.a,{href:"/docs/Intermediate/qa-testing-workflow",children:"QA Testing Workflow"})]}),"\n",(0,i.jsx)(n.li,{children:"Contact development team with detailed report"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.p,{children:["\ud83d\udca1 ",(0,i.jsx)(n.strong,{children:"Remember"}),": 90% of OOXML errors are hierarchy problems. Check THE BIG THREE first!"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);