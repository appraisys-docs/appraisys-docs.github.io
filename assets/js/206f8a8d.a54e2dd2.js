"use strict";(globalThis.webpackChunkappraisys_technical_documentation=globalThis.webpackChunkappraisys_technical_documentation||[]).push([[2320],{29087:(n,e,r)=>{r.d(e,{R:()=>a,x:()=>l});var s=r(96363);const i={},t=s.createContext(i);function a(n){const e=s.useContext(t);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:a(n.components),s.createElement(t.Provider,{value:e},n.children)}},85476:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"Intermediate/syncfusion-sfdt-format","title":"Syncfusion SFDT Format","description":"What is SFDT?","source":"@site/docs/02-Intermediate/05-syncfusion-sfdt-format.md","sourceDirName":"02-Intermediate","slug":"/Intermediate/syncfusion-sfdt-format","permalink":"/docs/Intermediate/syncfusion-sfdt-format","draft":false,"unlisted":false,"editUrl":"https://gitlab.devcom.com/appraisys/Atlas/docs/02-Intermediate/05-syncfusion-sfdt-format.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Styles In Depth","permalink":"/docs/Intermediate/styles-in-depth"},"next":{"title":"QA Testing Workflow","permalink":"/docs/Intermediate/qa-testing-workflow"}}');var i=r(47259),t=r(29087);const a={},l="Syncfusion SFDT Format",o={},d=[{value:"What is SFDT?",id:"what-is-sfdt",level:2},{value:"Why SFDT Exists",id:"why-sfdt-exists",level:3},{value:"In AppraiSys",id:"in-appraisys",level:3},{value:"SFDT Structure Overview",id:"sfdt-structure-overview",level:2},{value:"Complete SFDT Document",id:"complete-sfdt-document",level:3},{value:"Sections",id:"sections",level:2},{value:"Section Structure",id:"section-structure",level:3},{value:"Blocks (Paragraphs and Tables)",id:"blocks-paragraphs-and-tables",level:2},{value:"Paragraph Block",id:"paragraph-block",level:3},{value:"Table Block",id:"table-block",level:3},{value:"Inlines (Content)",id:"inlines-content",level:2},{value:"Text Inline",id:"text-inline",level:3},{value:"Line Break Inline",id:"line-break-inline",level:3},{value:"Image Inline",id:"image-inline",level:3},{value:"Styles",id:"styles",level:2},{value:"Paragraph Style",id:"paragraph-style",level:3},{value:"Character Style",id:"character-style",level:3},{value:"Lists and Numbering",id:"lists-and-numbering",level:2},{value:"List Format",id:"list-format",level:3},{value:"List Definition",id:"list-definition",level:3},{value:"AppraiSys Usage Patterns",id:"appraisys-usage-patterns",level:2},{value:"Converting DOCX to SFDT",id:"converting-docx-to-sfdt",level:3},{value:"Converting SFDT to DOCX",id:"converting-sfdt-to-docx",level:3},{value:"Mail Merge with SFDT",id:"mail-merge-with-sfdt",level:3},{value:"SFDT Limitations and Bugs",id:"sfdt-limitations-and-bugs",level:2},{value:"Known Issues (from AppraiSys experience)",id:"known-issues-from-appraisys-experience",level:3},{value:"1. <strong>Blank Paragraph Artifacts</strong>",id:"1-blank-paragraph-artifacts",level:4},{value:"2. <strong>Section Break Oddities</strong>",id:"2-section-break-oddities",level:4},{value:"3. <strong>Image Embedding Issues</strong>",id:"3-image-embedding-issues",level:4},{value:"4. <strong>Header/Footer Preservation</strong>",id:"4-headerfooter-preservation",level:4},{value:"5. <strong>Content Control Flattening</strong>",id:"5-content-control-flattening",level:4},{value:"6. <strong>TOC Refresh</strong>",id:"6-toc-refresh",level:4},{value:"AppraiSys Patches",id:"appraisys-patches",level:3},{value:"SFDT vs OOXML Comparison",id:"sfdt-vs-ooxml-comparison",level:2},{value:"Working with SFDT Programmatically",id:"working-with-sfdt-programmatically",level:2},{value:"Parse SFDT JSON",id:"parse-sfdt-json",level:3},{value:"Modify SFDT",id:"modify-sfdt",level:3},{value:"Find Text in SFDT",id:"find-text-in-sfdt",level:3},{value:"SFDT Best Practices",id:"sfdt-best-practices",level:2},{value:"\u2705 DO:",id:"-do",level:3},{value:"\u274c DON&#39;T:",id:"-dont",level:3},{value:"Debugging SFDT",id:"debugging-sfdt",level:2},{value:"Visualize Structure",id:"visualize-structure",level:3},{value:"Compare DOCX vs SFDT",id:"compare-docx-vs-sfdt",level:3},{value:"SFDT Schema Reference",id:"sfdt-schema-reference",level:2},{value:"Root Level",id:"root-level",level:3},{value:"Quick Reference",id:"quick-reference",level:2},{value:"Common SFDT Modifications",id:"common-sfdt-modifications",level:3},{value:"Next Steps",id:"next-steps",level:2}];function c(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"syncfusion-sfdt-format",children:"Syncfusion SFDT Format"})}),"\n",(0,i.jsx)(e.h2,{id:"what-is-sfdt",children:"What is SFDT?"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"SFDT"})," (Syncfusion Document Format) is a ",(0,i.jsx)(e.strong,{children:"JSON-based"})," document representation format created by Syncfusion for their Document Editor component."]}),"\n",(0,i.jsx)(e.h3,{id:"why-sfdt-exists",children:"Why SFDT Exists"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Web-friendly"}),": JSON is native to JavaScript"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Easy manipulation"}),": Modify documents in browser"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Lightweight"}),": Smaller than full OOXML XML"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Editor optimized"}),": Built for Syncfusion Document Editor"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"in-appraisys",children:"In AppraiSys"}),"\n",(0,i.jsxs)(e.p,{children:["SFDT is used as an ",(0,i.jsx)(e.strong,{children:"intermediate format"}),":"]}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"Templates stored as DOCX"}),"\n",(0,i.jsx)(e.li,{children:"Convert to SFDT for mail merge"}),"\n",(0,i.jsx)(e.li,{children:"Manipulate in Syncfusion"}),"\n",(0,i.jsx)(e.li,{children:"Convert back to DOCX for delivery"}),"\n"]}),"\n",(0,i.jsx)(e.mermaid,{value:"graph LR\r\n    A[Template<br/>DOCX] --\x3e|Convert| B[SFDT<br/>JSON]\r\n    B --\x3e|Mail Merge| C[Populated<br/>SFDT]\r\n    C --\x3e|Convert| D[Final<br/>DOCX]\r\n    D --\x3e|Render| E[PDF]\r\n    \r\n    style A fill:#e1f5ff\r\n    style B fill:#fff3cd\r\n    style C fill:#fff3cd\r\n    style D fill:#e1f5ff\r\n    style E fill:#d4edda"}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"sfdt-structure-overview",children:"SFDT Structure Overview"}),"\n",(0,i.jsx)(e.h3,{id:"complete-sfdt-document",children:"Complete SFDT Document"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'{\r\n  "sections": [\r\n    {\r\n      "sectionFormat": {\r\n        "pageWidth": 612,\r\n        "pageHeight": 792,\r\n        "leftMargin": 72,\r\n        "rightMargin": 72,\r\n        "topMargin": 72,\r\n        "bottomMargin": 72\r\n      },\r\n      "blocks": [\r\n        {\r\n          "paragraphFormat": {},\r\n          "characterFormat": {},\r\n          "inlines": []\r\n        }\r\n      ],\r\n      "headersFooters": {\r\n        "header": {},\r\n        "footer": {}\r\n      }\r\n    }\r\n  ],\r\n  "characterFormat": {},\r\n  "paragraphFormat": {},\r\n  "defaultTabWidth": 36,\r\n  "trackChanges": false,\r\n  "enforcement": false,\r\n  "hashValue": "",\r\n  "saltValue": "",\r\n  "formatting": false,\r\n  "protectionType": "NoProtection",\r\n  "dontUseHTMLParagraphAutoSpacing": false,\r\n  "formFieldShading": true,\r\n  "styles": [],\r\n  "lists": [],\r\n  "abstractLists": [],\r\n  "comments": [],\r\n  "revisions": [],\r\n  "customXml": []\r\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"sections",children:"Sections"}),"\n",(0,i.jsx)(e.h3,{id:"section-structure",children:"Section Structure"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'{\r\n  "sections": [\r\n    {\r\n      "sectionFormat": {\r\n        "pageWidth": 612,          // 8.5 inches * 72 points\r\n        "pageHeight": 792,         // 11 inches * 72 points\r\n        "leftMargin": 72,          // 1 inch\r\n        "rightMargin": 72,\r\n        "topMargin": 72,\r\n        "bottomMargin": 72,\r\n        "differentFirstPage": false,\r\n        "different OddAndEvenPages": false,\r\n        "headerDistance": 36,      // 0.5 inch\r\n        "footerDistance": 36,\r\n        "bidi": false\r\n      },\r\n      "blocks": [...],\r\n      "headersFooters": {}\r\n    }\r\n  ]\r\n}\n'})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Key properties"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["All measurements in ",(0,i.jsx)(e.strong,{children:"points"})," (72 per inch)"]}),"\n",(0,i.jsx)(e.li,{children:"Multiple sections supported"}),"\n",(0,i.jsx)(e.li,{children:"Headers/footers per section"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"blocks-paragraphs-and-tables",children:"Blocks (Paragraphs and Tables)"}),"\n",(0,i.jsx)(e.h3,{id:"paragraph-block",children:"Paragraph Block"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'{\r\n  "paragraphFormat": {\r\n    "leftIndent": 0,\r\n    "rightIndent": 0,\r\n    "firstLineIndent": 0,\r\n    "textAlignment": "Left",      // Left, Center, Right, Justify\r\n    "beforeSpacing": 0,\r\n    "afterSpacing": 8,\r\n    "lineSpacing": 1.15,\r\n    "lineSpacingType": "Multiple", // Multiple, AtLeast, Exactly\r\n    "styleName": "Normal",\r\n    "listFormat": {},\r\n    "bidi": false\r\n  },\r\n  "characterFormat": {\r\n    "bold": false,\r\n    "italic": false,\r\n    "fontSize": 11,\r\n    "fontFamily": "Calibri",\r\n    "fontColor": "#000000FF",      // RGBA format\r\n    "fontFamilyBidi": "Calibri"\r\n  },\r\n  "inlines": [\r\n    {\r\n      "text": "Hello World",\r\n      "characterFormat": {}\r\n    }\r\n  ]\r\n}\n'})}),"\n",(0,i.jsx)(e.h3,{id:"table-block",children:"Table Block"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'{\r\n  "table": {\r\n    "rows": [\r\n      {\r\n        "cells": [\r\n          {\r\n            "blocks": [\r\n              {\r\n                "inlines": [\r\n                  { "text": "Cell content" }\r\n                ]\r\n              }\r\n            ],\r\n            "cellFormat": {\r\n              "cellWidth": 150,\r\n              "columnSpan": 1,\r\n              "rowSpan": 1,\r\n              "preferredWidth": 150,\r\n              "preferredWidthType": "Point",\r\n              "verticalAlignment": "Top",\r\n              "borders": {},\r\n              "shading": {}\r\n            }\r\n          }\r\n        ],\r\n        "rowFormat": {\r\n          "height": 0,\r\n          "heightType": "AtLeast",\r\n          "isHeader": false,\r\n          "allowBreakAcrossPages": true\r\n        }\r\n      }\r\n    ],\r\n    "grid": [150, 150],  // Column widths\r\n    "tableFormat": {\r\n      "borders": {},\r\n      "cellSpacing": 0,\r\n      "leftIndent": 0,\r\n      "preferredWidth": 100,\r\n      "preferredWidthType": "Percent",\r\n      "bidi": false\r\n    }\r\n  }\r\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"inlines-content",children:"Inlines (Content)"}),"\n",(0,i.jsx)(e.h3,{id:"text-inline",children:"Text Inline"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'{\r\n  "text": "Sample text",\r\n  "characterFormat": {\r\n    "bold": true,\r\n    "italic": false,\r\n    "fontSize": 12,\r\n    "fontFamily": "Times New Roman",\r\n    "fontColor": "#000000FF",\r\n    "underline": "Single",        // None, Single, Double, etc.\r\n    "strikethrough": "None",\r\n    "baselineAlignment": "Normal", // Superscript, Subscript\r\n    "highlightColor": "NoColor"\r\n  }\r\n}\n'})}),"\n",(0,i.jsx)(e.h3,{id:"line-break-inline",children:"Line Break Inline"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'{\r\n  "breakType": "LineBreak",\r\n  "breakClearType": "None"\r\n}\n'})}),"\n",(0,i.jsx)(e.h3,{id:"image-inline",children:"Image Inline"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'{\r\n  "imageString": "data:image/png;base64,iVBORw0KGgo...",\r\n  "width": 72,              // Points\r\n  "height": 72,\r\n  "name": "image1.png",\r\n  "alternateText": "",\r\n  "title": "",\r\n  "visible": true,\r\n  "widthScale": 100,\r\n  "heightScale": 100,\r\n  "verticalPosition": 0,\r\n  "verticalOrigin": "Paragraph",\r\n  "verticalAlignment": "None",\r\n  "horizontalPosition": 0,\r\n  "horizontalOrigin": "Column",\r\n  "horizontalAlignment": "None",\r\n  "allowOverlap": true,\r\n  "textWrappingStyle": "Inline",\r\n  "textWrappingType": "Both",\r\n  "distanceBottom": 0,\r\n  "distanceLeft": 9,\r\n  "distanceRight": 9,\r\n  "distanceTop": 0,\r\n  "layoutInCell": true,\r\n  "lockAnchor": false,\r\n  "zOrderPosition": 0,\r\n  "isInlineImage": true\r\n}\n'})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Image formats"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["Base64 encoded: ",(0,i.jsx)(e.code,{children:"data:image/png;base64,..."})]}),"\n",(0,i.jsxs)(e.li,{children:["URL: ",(0,i.jsx)(e.code,{children:"https://example.com/image.png"})]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"From AppraiSys"})," (",(0,i.jsx)(e.code,{children:"DocumentToPdfConverter.cs"}),"):"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-csharp",children:'// Download images and convert to base64\r\nvar imagesToDownload = sfdtWrapper?.Images\r\n    .Where(x => x.Value.FirstOrDefault()?.StartsWith("http") ?? false)\r\n    .ToList();\r\n\r\nforeach (var downloadedImage in downloadedImages)\r\n{\r\n    sfdtWrapper.Images[key].Insert(0,\r\n        $"data:{contentType};base64,{Convert.ToBase64String(bytes)}"\r\n    );\r\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"styles",children:"Styles"}),"\n",(0,i.jsx)(e.h3,{id:"paragraph-style",children:"Paragraph Style"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'{\r\n  "name": "Heading 1",\r\n  "type": "Paragraph",\r\n  "paragraphFormat": {\r\n    "leftIndent": 0,\r\n    "rightIndent": 0,\r\n    "firstLineIndent": 0,\r\n    "textAlignment": "Left",\r\n    "beforeSpacing": 12,\r\n    "afterSpacing": 6,\r\n    "lineSpacing": 1.15,\r\n    "lineSpacingType": "Multiple",\r\n    "outlineLevel": "Level1"\r\n  },\r\n  "characterFormat": {\r\n    "fontSize": 16,\r\n    "fontFamily": "Calibri Light",\r\n    "fontColor": "#2F5496FF",\r\n    "bold": false,\r\n    "italic": false\r\n  },\r\n  "basedOn": "Normal",\r\n  "link": "Heading 1 Char",\r\n  "next": "Normal"\r\n}\n'})}),"\n",(0,i.jsx)(e.h3,{id:"character-style",children:"Character Style"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'{\r\n  "name": "Emphasis",\r\n  "type": "Character",\r\n  "characterFormat": {\r\n    "italic": true,\r\n    "fontColor": "#000000FF"\r\n  }\r\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"lists-and-numbering",children:"Lists and Numbering"}),"\n",(0,i.jsx)(e.h3,{id:"list-format",children:"List Format"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'{\r\n  "listFormat": {\r\n    "listId": 0,\r\n    "listLevelNumber": 0\r\n  }\r\n}\n'})}),"\n",(0,i.jsx)(e.h3,{id:"list-definition",children:"List Definition"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'{\r\n  "abstractListId": 0,\r\n  "levels": [\r\n    {\r\n      "characterFormat": {},\r\n      "paragraphFormat": {\r\n        "leftIndent": 36,\r\n        "firstLineIndent": -18\r\n      },\r\n      "followCharacter": "Tab",\r\n      "listLevelPattern": "Arabic",    // Arabic, UpperRoman, LowerLetter, etc.\r\n      "numberFormat": "%1.",\r\n      "restartLevel": 0,\r\n      "startAt": 1\r\n    }\r\n  ]\r\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"appraisys-usage-patterns",children:"AppraiSys Usage Patterns"}),"\n",(0,i.jsx)(e.h3,{id:"converting-docx-to-sfdt",children:"Converting DOCX to SFDT"}),"\n",(0,i.jsxs)(e.p,{children:["From ",(0,i.jsx)(e.code,{children:"DocumentToSfdtFormat.cs"}),":"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-csharp",children:"public static string Convert(MemoryStream stream)\r\n{\r\n    // Load DOCX using Syncfusion DocIO\r\n    var doc = new Syncfusion.DocIO.DLS.WordDocument(\r\n        stream, \r\n        Syncfusion.DocIO.FormatType.Docx\r\n    );\r\n    \r\n    // Convert to SFDT using EJ2 DocumentEditor\r\n    var sfdtDocument = Syncfusion.EJ2.DocumentEditor.WordDocument.Load(doc);\r\n    \r\n    // Optimize output\r\n    sfdtDocument.OptimizeSfdt = true;\r\n    \r\n    // Serialize to JSON\r\n    var sfdt = Newtonsoft.Json.JsonConvert.SerializeObject(sfdtDocument);\r\n    \r\n    // Cleanup\r\n    sfdtDocument.Dispose();\r\n    doc.Dispose();\r\n    \r\n    return sfdt;\r\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"converting-sfdt-to-docx",children:"Converting SFDT to DOCX"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-csharp",children:"// From DocumentToPdfConverter.cs\r\nvar sfdtDocument = Syncfusion.EJ2.DocumentEditor.WordDocument.Save(\r\n    mergedSfdt,\r\n    Syncfusion.EJ2.DocumentEditor.FormatType.Docx\r\n);\r\n\r\nusing var wordDocument = new Syncfusion.DocIO.DLS.WordDocument(\r\n    sfdtDocument, \r\n    Syncfusion.DocIO.FormatType.Docx\r\n);\n"})}),"\n",(0,i.jsx)(e.h3,{id:"mail-merge-with-sfdt",children:"Mail Merge with SFDT"}),"\n",(0,i.jsxs)(e.p,{children:["From ",(0,i.jsx)(e.code,{children:"SyncfusionFieldsPipelineStep.cs"}),":"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-csharp",children:'// Document is in DOCX format\r\nDestinationDocument = new WordDocument(input.DocumentData, FormatType.Docx);\r\n\r\n// Configure mail merge\r\nDestinationDocument.MailMerge.ClearFields = false;\r\nDestinationDocument.MailMerge.BeforeClearField += BeforeClearFieldWrapper;\r\n\r\n// Execute merge (internal conversion to SFDT happens)\r\nDestinationDocument.MailMerge.Execute(new List<string> { "" });\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"sfdt-limitations-and-bugs",children:"SFDT Limitations and Bugs"}),"\n",(0,i.jsx)(e.h3,{id:"known-issues-from-appraisys-experience",children:"Known Issues (from AppraiSys experience)"}),"\n",(0,i.jsxs)(e.h4,{id:"1-blank-paragraph-artifacts",children:["1. ",(0,i.jsx)(e.strong,{children:"Blank Paragraph Artifacts"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Problem"}),": Extra blank paragraphs appear after conversion"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Cause"}),": Syncfusion adds spacing paragraphs"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Workaround"}),": Clean empty blocks post-conversion"]}),"\n",(0,i.jsxs)(e.h4,{id:"2-section-break-oddities",children:["2. ",(0,i.jsx)(e.strong,{children:"Section Break Oddities"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Problem"}),": Section breaks don't convert cleanly"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Cause"}),": SFDT section model differs from OOXML"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Workaround"}),": Test section-heavy documents carefully"]}),"\n",(0,i.jsxs)(e.h4,{id:"3-image-embedding-issues",children:["3. ",(0,i.jsx)(e.strong,{children:"Image Embedding Issues"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Problem"}),": External image URLs don't always work"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Cause"}),": Syncfusion requires base64 for reliable rendering"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Solution"}),": Download and encode images (as in AppraiSys)"]}),"\n",(0,i.jsxs)(e.h4,{id:"4-headerfooter-preservation",children:["4. ",(0,i.jsx)(e.strong,{children:"Header/Footer Preservation"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Problem"}),": Complex headers/footers may lose formatting"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Cause"}),": SFDT header model simplified"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Workaround"}),": Keep headers/footers simple"]}),"\n",(0,i.jsxs)(e.h4,{id:"5-content-control-flattening",children:["5. ",(0,i.jsx)(e.strong,{children:"Content Control Flattening"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Problem"}),": SDTs sometimes removed after conversion"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Cause"}),": Syncfusion mail merge behavior"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Solution"}),": Set ",(0,i.jsx)(e.code,{children:"ClearFields = false"})]}),"\n",(0,i.jsxs)(e.h4,{id:"6-toc-refresh",children:["6. ",(0,i.jsx)(e.strong,{children:"TOC Refresh"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Problem"}),": Table of contents doesn't update"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Cause"}),": SFDT doesn't support automatic TOC update"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Workaround"}),": Regenerate TOC in final DOCX"]}),"\n",(0,i.jsx)(e.h3,{id:"appraisys-patches",children:"AppraiSys Patches"}),"\n",(0,i.jsxs)(e.p,{children:["From ",(0,i.jsx)(e.code,{children:"AppraiSys.Atlas.SyncfusionDep"}),":"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-csharp",children:'public static void PatchSyncfusion()\r\n{\r\n    var harmony = new Harmony("appraisys.syncfusion.patches");\r\n    \r\n    // Apply null guards for internal Syncfusion access\r\n    ApplyNullGuardsPatch(harmony);\r\n    \r\n    // Remove embedded image versions\r\n    ApplyRemoveEmbeddedVersionsOfImagesPatch(harmony);\r\n}\n'})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Purpose"}),": Work around Syncfusion bugs using Harmony runtime patching"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"sfdt-vs-ooxml-comparison",children:"SFDT vs OOXML Comparison"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"Feature"}),(0,i.jsx)(e.th,{children:"OOXML"}),(0,i.jsx)(e.th,{children:"SFDT"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"Format"})}),(0,i.jsx)(e.td,{children:"XML in ZIP"}),(0,i.jsx)(e.td,{children:"JSON"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"Size"})}),(0,i.jsx)(e.td,{children:"Larger"}),(0,i.jsx)(e.td,{children:"Smaller"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"Human readable"})}),(0,i.jsx)(e.td,{children:"Somewhat"}),(0,i.jsx)(e.td,{children:"More readable"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"Web friendly"})}),(0,i.jsx)(e.td,{children:"No"}),(0,i.jsx)(e.td,{children:"Yes"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"Images"})}),(0,i.jsx)(e.td,{children:"Separate files"}),(0,i.jsx)(e.td,{children:"Base64 inline"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"Relationships"})}),(0,i.jsx)(e.td,{children:".rels files"}),(0,i.jsx)(e.td,{children:"Embedded"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"Validation"})}),(0,i.jsx)(e.td,{children:"XML schema"}),(0,i.jsx)(e.td,{children:"JSON schema"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"Editing"})}),(0,i.jsx)(e.td,{children:"Complex"}),(0,i.jsx)(e.td,{children:"Easier"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"Browser support"})}),(0,i.jsx)(e.td,{children:"No"}),(0,i.jsx)(e.td,{children:"Yes (with editor)"})]})]})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"working-with-sfdt-programmatically",children:"Working with SFDT Programmatically"}),"\n",(0,i.jsx)(e.h3,{id:"parse-sfdt-json",children:"Parse SFDT JSON"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-csharp",children:'using Newtonsoft.Json;\r\nusing Newtonsoft.Json.Linq;\r\n\r\nvar sfdtObject = JObject.Parse(sfdtJson);\r\n\r\n// Access sections\r\nvar sections = sfdtObject["sections"] as JArray;\r\n\r\n// Access first block\r\nvar firstBlock = sections[0]["blocks"][0];\r\n\r\n// Check if it\'s a paragraph\r\nif (firstBlock["inlines"] != null)\r\n{\r\n    // It\'s a paragraph\r\n    var inlines = firstBlock["inlines"] as JArray;\r\n}\r\nelse if (firstBlock["table"] != null)\r\n{\r\n    // It\'s a table\r\n    var table = firstBlock["table"];\r\n}\n'})}),"\n",(0,i.jsx)(e.h3,{id:"modify-sfdt",children:"Modify SFDT"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-csharp",children:'// Add text to first paragraph\r\nvar sections = sfdtObject["sections"] as JArray;\r\nvar firstBlock = sections[0]["blocks"][0];\r\nvar inlines = firstBlock["inlines"] as JArray;\r\n\r\ninlines.Add(new JObject\r\n{\r\n    ["text"] = " Additional text",\r\n    ["characterFormat"] = new JObject()\r\n});\r\n\r\n// Serialize back\r\nvar modifiedSfdt = sfdtObject.ToString();\n'})}),"\n",(0,i.jsx)(e.h3,{id:"find-text-in-sfdt",children:"Find Text in SFDT"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-csharp",children:'public List<string> FindAllText(JObject sfdt)\r\n{\r\n    var texts = new List<string>();\r\n    \r\n    foreach (var section in sfdt["sections"])\r\n    {\r\n        foreach (var block in section["blocks"])\r\n        {\r\n            if (block["inlines"] != null)\r\n            {\r\n                foreach (var inline in block["inlines"])\r\n                {\r\n                    if (inline["text"] != null)\r\n                    {\r\n                        texts.Add(inline["text"].ToString());\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    return texts;\r\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"sfdt-best-practices",children:"SFDT Best Practices"}),"\n",(0,i.jsx)(e.h3,{id:"-do",children:"\u2705 DO:"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Optimize SFDT"}),": Always set ",(0,i.jsx)(e.code,{children:"OptimizeSfdt = true"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Validate JSON"}),": Parse to verify valid JSON"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Handle images"}),": Convert to base64 for reliability"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Test conversions"}),": Always round-trip test DOCX \u2192 SFDT \u2192 DOCX"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Clean empty blocks"}),": Remove artifact paragraphs"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"-dont",children:"\u274c DON'T:"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Don't edit SFDT manually"}),": Use Syncfusion APIs"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Don't trust external image URLs"}),": Download and encode"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Don't ignore validation errors"}),": Fix structure issues"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Don't skip round-trip testing"}),": Conversions can lose data"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Don't assume OOXML equivalence"}),": Some features differ"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"debugging-sfdt",children:"Debugging SFDT"}),"\n",(0,i.jsx)(e.h3,{id:"visualize-structure",children:"Visualize Structure"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-javascript",children:"// In browser console\r\nconst sfdt = JSON.parse(sfdtString);\r\nconsole.table(sfdt.sections[0].blocks.map((b, i) => ({\r\n  index: i,\r\n  type: b.inlines ? 'paragraph' : 'table',\r\n  content: b.inlines ? b.inlines.length + ' inlines' : b.table.rows.length + ' rows'\r\n})));\n"})}),"\n",(0,i.jsx)(e.h3,{id:"compare-docx-vs-sfdt",children:"Compare DOCX vs SFDT"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-csharp",children:'// 1. Convert DOCX to SFDT\r\nvar sfdt = DocumentToSfdtFormat.Convert(docxStream);\r\n\r\n// 2. Parse and inspect\r\nvar sfdtObj = JObject.Parse(sfdt);\r\nvar blockCount = sfdtObj["sections"][0]["blocks"].Count();\r\n\r\nConsole.WriteLine($"SFDT has {blockCount} blocks");\r\n\r\n// 3. Convert back and compare\r\nvar docx2Stream = ConvertSfdtToDocx(sfdt);\r\n// Visual comparison in Word\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"sfdt-schema-reference",children:"SFDT Schema Reference"}),"\n",(0,i.jsx)(e.h3,{id:"root-level",children:"Root Level"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'{\r\n  "sections": [],           // Required: Document sections\r\n  "characterFormat": {},    // Optional: Default character format\r\n  "paragraphFormat": {},    // Optional: Default paragraph format\r\n  "defaultTabWidth": 36,    // Optional: Default tab width in points\r\n  "trackChanges": false,    // Optional: Track changes enabled\r\n  "styles": [],             // Optional: Style definitions\r\n  "lists": [],              // Optional: List instances\r\n  "abstractLists": [],      // Optional: List templates\r\n  "comments": [],           // Optional: Comments\r\n  "revisions": [],          // Optional: Tracked changes\r\n  "customXml": []           // Optional: Custom XML data\r\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"quick-reference",children:"Quick Reference"}),"\n",(0,i.jsx)(e.h3,{id:"common-sfdt-modifications",children:"Common SFDT Modifications"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Change text color"}),":"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'"characterFormat": {\r\n  "fontColor": "#FF0000FF"  // Red (RGBA)\r\n}\n'})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Center paragraph"}),":"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'"paragraphFormat": {\r\n  "textAlignment": "Center"\r\n}\n'})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Bold text"}),":"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'"characterFormat": {\r\n  "bold": true\r\n}\n'})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Add spacing"}),":"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'"paragraphFormat": {\r\n  "beforeSpacing": 12,\r\n  "afterSpacing": 12\r\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,i.jsxs)(e.p,{children:["\u27a1\ufe0f ",(0,i.jsx)(e.strong,{children:"Next"}),": ",(0,i.jsx)(e.a,{href:"/docs/Intermediate/qa-testing-workflow",children:"QA Testing Workflow"})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Related"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.a,{href:"/docs/Advanced/ooxml-sfdt-element-mapping",children:"OOXML \u2194 SFDT Mapping"})," - Complete transformation guide"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.a,{href:"../03-Advanced/advanced-syncfusion.md",children:"Advanced Syncfusion"})," - Deep dive"]}),"\n",(0,i.jsx)(e.li,{children:"[Syncfusion Patterns](../05-Code examples/syncfusion-patterns.md) - Code examples"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsxs)(e.p,{children:["\ud83d\udca1 ",(0,i.jsx)(e.strong,{children:"Remember"}),": SFDT is JSON-based and web-friendly, but has limitations compared to full OOXML. Test conversions thoroughly!"]})]})}function h(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(c,{...n})}):c(n)}}}]);