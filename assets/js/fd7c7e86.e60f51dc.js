"use strict";(globalThis.webpackChunkappraisys_technical_documentation=globalThis.webpackChunkappraisys_technical_documentation||[]).push([[5729],{6061:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>p,frontMatter:()=>i,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"Intermediate/content-controls-sdt","title":"Content Controls (SDT)","description":"What Are Content Controls?","source":"@site/docs/02-Intermediate/01-content-controls-sdt.md","sourceDirName":"02-Intermediate","slug":"/Intermediate/content-controls-sdt","permalink":"/docs/Intermediate/content-controls-sdt","draft":false,"unlisted":false,"editUrl":"https://gitlab.devcom.com/appraisys/Atlas/docs/02-Intermediate/01-content-controls-sdt.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Practice Exercises - Fundamentals","permalink":"/docs/Fundamentals/practice-exercises"},"next":{"title":"Tables in OOXML","permalink":"/docs/Intermediate/tables-in-ooxml"}}');var s=r(4848),l=r(8453);const i={},d="Content Controls (SDT)",a={},c=[{value:"What Are Content Controls?",id:"what-are-content-controls",level:2},{value:"SDT Structure",id:"sdt-structure",level:2},{value:"Complete SDT Anatomy",id:"complete-sdt-anatomy",level:3},{value:"Block-Level vs Inline SDTs",id:"block-level-vs-inline-sdts",level:2},{value:"Block-Level SDT",id:"block-level-sdt",level:3},{value:"Inline SDT",id:"inline-sdt",level:3},{value:"SDT Types",id:"sdt-types",level:2},{value:"1. Plain Text Control",id:"1-plain-text-control",level:3},{value:"2. Rich Text Control",id:"2-rich-text-control",level:3},{value:"3. Drop-down List",id:"3-drop-down-list",level:3},{value:"4. Date Picker",id:"4-date-picker",level:3},{value:"5. Picture Content Control",id:"5-picture-content-control",level:3},{value:"6. Repeating Section",id:"6-repeating-section",level:3},{value:"7. Checkbox",id:"7-checkbox",level:3},{value:"SDT Properties Explained",id:"sdt-properties-explained",level:2},{value:"ID (<code>w:id</code>)",id:"id-wid",level:3},{value:"Tag (<code>w:tag</code>)",id:"tag-wtag",level:3},{value:"Alias (<code>w:alias</code>)",id:"alias-walias",level:3},{value:"Lock Settings (<code>w:lock</code>)",id:"lock-settings-wlock",level:3},{value:"SDTs in Mail Merge",id:"sdts-in-mail-merge",level:2},{value:"AppraiSys Pattern",id:"appraisys-pattern",level:3},{value:"Creating SDT for Mail Merge",id:"creating-sdt-for-mail-merge",level:3},{value:"Merge Field Mapping",id:"merge-field-mapping",level:3},{value:"Common SDT Mistakes",id:"common-sdt-mistakes",level:2},{value:"\u274c Mistake 1: SDT Inside Run",id:"-mistake-1-sdt-inside-run",level:3},{value:"\u274c Mistake 2: Empty SDT Content",id:"-mistake-2-empty-sdt-content",level:3},{value:"\u274c Mistake 3: Duplicate IDs",id:"-mistake-3-duplicate-ids",level:3},{value:"Working with SDTs Programmatically",id:"working-with-sdts-programmatically",level:2},{value:"Finding SDTs by Tag",id:"finding-sdts-by-tag",level:3},{value:"Creating Inline SDT",id:"creating-inline-sdt",level:3},{value:"Creating Block SDT",id:"creating-block-sdt",level:3},{value:"Nested SDTs",id:"nested-sdts",level:2},{value:"When Valid",id:"when-valid",level:3},{value:"When Invalid",id:"when-invalid",level:3},{value:"SDT Persistence After Merge",id:"sdt-persistence-after-merge",level:2},{value:"Problem",id:"problem",level:3},{value:"Solution in AppraiSys",id:"solution-in-appraisys",level:3},{value:"Repeating Sections",id:"repeating-sections",level:2},{value:"Structure",id:"structure",level:3},{value:"In AppraiSys",id:"in-appraisys",level:3},{value:"Visual Summary",id:"visual-summary",level:2},{value:"Quick Reference",id:"quick-reference",level:2},{value:"Block SDT Template",id:"block-sdt-template",level:3},{value:"Inline SDT Template",id:"inline-sdt-template",level:3},{value:"Next Steps",id:"next-steps",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"content-controls-sdt",children:"Content Controls (SDT)"})}),"\n",(0,s.jsx)(n.h2,{id:"what-are-content-controls",children:"What Are Content Controls?"}),"\n",(0,s.jsxs)(n.p,{children:["Content controls (Structured Document Tags or SDT) are ",(0,s.jsx)(n.strong,{children:"containers"})," in Word documents that can hold content and have special properties. They're commonly used for:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Mail merge fields"})," - Placeholders for dynamic content"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Form fields"})," - Input areas in forms"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Repeating sections"})," - Dynamic lists"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Drop-down lists"})," - Selection options"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Date pickers"})," - Date selection"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Rich text areas"})," - Formatted content input"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"In AppraiSys, SDTs are heavily used for mail merge in appraisal reports."}),"\n",(0,s.jsx)(n.mermaid,{value:"graph TD\r\n    A[Content Control<br/>SDT] --\x3e B[Properties<br/>sdtPr]\r\n    A --\x3e C[Content<br/>sdtContent]\r\n    \r\n    B --\x3e B1[ID]\r\n    B --\x3e B2[Tag/Name]\r\n    B --\x3e B3[Lock Settings]\r\n    B --\x3e B4[Type]\r\n    \r\n    C --\x3e C1[Paragraphs]\r\n    C --\x3e C2[Tables]\r\n    C --\x3e C3[Runs]\r\n    \r\n    style A fill:#d4edda\r\n    style B fill:#fff3cd\r\n    style C fill:#e1f5ff"}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"sdt-structure",children:"SDT Structure"}),"\n",(0,s.jsx)(n.h3,{id:"complete-sdt-anatomy",children:"Complete SDT Anatomy"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<w:sdt>\r\n  \x3c!-- 1. Properties (required) --\x3e\r\n  <w:sdtPr>\r\n    <w:id w:val="123456"/>              \x3c!-- Unique ID --\x3e\r\n    <w:tag w:val="MergeField1"/>        \x3c!-- Tag for identification --\x3e\r\n    <w:alias w:val="Customer Name"/>     \x3c!-- Display name --\x3e\r\n    <w:lock w:val="sdtContentLocked"/>  \x3c!-- Lock behavior --\x3e\r\n    <w:placeholder>                      \x3c!-- Placeholder text --\x3e\r\n      <w:docPart w:val="DefaultPlaceholder"/>\r\n    </w:placeholder>\r\n    <w:text/>                           \x3c!-- Plain text control (optional) --\x3e\r\n  </w:sdtPr>\r\n  \r\n  \x3c!-- 2. End Properties (optional) --\x3e\r\n  <w:sdtEndPr/>\r\n  \r\n  \x3c!-- 3. Content (required) --\x3e\r\n  <w:sdtContent>\r\n    <w:p>\r\n      <w:r>\r\n        <w:t>Content goes here</w:t>\r\n      </w:r>\r\n    </w:p>\r\n  </w:sdtContent>\r\n</w:sdt>\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"block-level-vs-inline-sdts",children:"Block-Level vs Inline SDTs"}),"\n",(0,s.jsx)(n.h3,{id:"block-level-sdt",children:"Block-Level SDT"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": Direct child of body, table cell, or another block container"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Can contain"}),": Paragraphs, tables, other block elements"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Use case"}),": Multi-paragraph content, tables, sections"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'\x3c!-- \u2705 Block SDT in body --\x3e\r\n<w:body>\r\n  <w:sdt>\r\n    <w:sdtPr>\r\n      <w:tag w:val="PropertyDescription"/>\r\n    </w:sdtPr>\r\n    <w:sdtContent>\r\n      <w:p>\r\n        <w:r><w:t>First paragraph</w:t></w:r>\r\n      </w:p>\r\n      <w:p>\r\n        <w:r><w:t>Second paragraph</w:t></w:r>\r\n      </w:p>\r\n      <w:tbl>\r\n        \x3c!-- Table content --\x3e\r\n      </w:tbl>\r\n    </w:sdtContent>\r\n  </w:sdt>\r\n</w:body>\n'})}),"\n",(0,s.jsx)(n.mermaid,{value:"graph LR\r\n    A[w:body] --\x3e B[w:sdt Block]\r\n    B --\x3e C[w:sdtContent]\r\n    C --\x3e D[w:p]\r\n    C --\x3e E[w:tbl]\r\n    \r\n    style B fill:#d4edda"}),"\n",(0,s.jsx)(n.h3,{id:"inline-sdt",children:"Inline SDT"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": Inside a paragraph"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Can contain"}),": Only runs (inline content)"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Use case"}),": Single values, inline fields, short text"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'\x3c!-- \u2705 Inline SDT in paragraph --\x3e\r\n<w:p>\r\n  <w:r><w:t>The property value is </w:t></w:r>\r\n  \r\n  <w:sdt>\r\n    <w:sdtPr>\r\n      <w:tag w:val="AppraisedValue"/>\r\n    </w:sdtPr>\r\n    <w:sdtContent>\r\n      <w:r>\r\n        <w:t>$450,000</w:t>\r\n      </w:r>\r\n    </w:sdtContent>\r\n  </w:sdt>\r\n  \r\n  <w:r><w:t>.</w:t></w:r>\r\n</w:p>\n'})}),"\n",(0,s.jsx)(n.mermaid,{value:"graph LR\r\n    A[w:p] --\x3e B[w:r Text before]\r\n    A --\x3e C[w:sdt Inline]\r\n    A --\x3e D[w:r Text after]\r\n    \r\n    C --\x3e E[w:sdtContent]\r\n    E --\x3e F[w:r Value]\r\n    \r\n    style C fill:#ffe6cc"}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"sdt-types",children:"SDT Types"}),"\n",(0,s.jsx)(n.h3,{id:"1-plain-text-control",children:"1. Plain Text Control"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Purpose"}),": Single-line or multi-line plain text"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Properties"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<w:sdtPr>\r\n  <w:text w:multiLine="true"/>  \x3c!-- Allow multiple lines --\x3e\r\n  <w:tag w:val="TextField"/>\r\n</w:sdtPr>\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Use in AppraiSys"}),": Property addresses, description fields"]}),"\n",(0,s.jsx)(n.h3,{id:"2-rich-text-control",children:"2. Rich Text Control"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Purpose"}),": Formatted text with styles"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Properties"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<w:sdtPr>\r\n  <w:richText/>\r\n  <w:tag w:val="NotesField"/>\r\n</w:sdtPr>\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Use in AppraiSys"}),": Appraiser notes, comments"]}),"\n",(0,s.jsx)(n.h3,{id:"3-drop-down-list",children:"3. Drop-down List"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Purpose"}),": Selection from predefined options"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Properties"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<w:sdtPr>\r\n  <w:dropDownList>\r\n    <w:listItem w:displayText="Single Family" w:value="SF"/>\r\n    <w:listItem w:displayText="Condo" w:value="CONDO"/>\r\n    <w:listItem w:displayText="Multi-Family" w:value="MF"/>\r\n  </w:dropDownList>\r\n  <w:tag w:val="PropertyType"/>\r\n</w:sdtPr>\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Use in AppraiSys"}),": Property type selection, condition ratings"]}),"\n",(0,s.jsx)(n.h3,{id:"4-date-picker",children:"4. Date Picker"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Purpose"}),": Date selection with calendar"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Properties"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<w:sdtPr>\r\n  <w:date>\r\n    <w:dateFormat w:val="MM/dd/yyyy"/>\r\n    <w:calendar w:val="gregorian"/>\r\n  </w:date>\r\n  <w:tag w:val="InspectionDate"/>\r\n</w:sdtPr>\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Use in AppraiSys"}),": Inspection dates, sale dates"]}),"\n",(0,s.jsx)(n.h3,{id:"5-picture-content-control",children:"5. Picture Content Control"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Purpose"}),": Placeholder for images"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Properties"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<w:sdtPr>\r\n  <w:picture/>\r\n  <w:tag w:val="PropertyPhoto"/>\r\n</w:sdtPr>\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Use in AppraiSys"}),": Property photos, comparable photos"]}),"\n",(0,s.jsx)(n.h3,{id:"6-repeating-section",children:"6. Repeating Section"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Purpose"}),": Dynamic lists that repeat"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Properties"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<w:sdtPr>\r\n  <w:repeatingSectionItem/>\r\n  <w:tag w:val="ComparableItem"/>\r\n</w:sdtPr>\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Use in AppraiSys"}),": Comparable properties list"]}),"\n",(0,s.jsx)(n.h3,{id:"7-checkbox",children:"7. Checkbox"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Purpose"}),": Boolean selection"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Properties"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<w:sdtPr>\r\n  <w14:checkbox>\r\n    <w14:checked w14:val="1"/>  \x3c!-- 1 = checked, 0 = unchecked --\x3e\r\n    <w14:checkedState w14:val="2612" w14:font="Segoe UI Symbol"/>\r\n  </w14:checkbox>\r\n  <w:tag w:val="HasGarage"/>\r\n</w:sdtPr>\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"sdt-properties-explained",children:"SDT Properties Explained"}),"\n",(0,s.jsxs)(n.h3,{id:"id-wid",children:["ID (",(0,s.jsx)(n.code,{children:"w:id"}),")"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Purpose"}),": Unique identifier for the content control"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Value"}),": Integer (automatically generated)"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<w:id w:val="123456"/>\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Important"}),": Must be unique within the document"]}),"\n",(0,s.jsxs)(n.h3,{id:"tag-wtag",children:["Tag (",(0,s.jsx)(n.code,{children:"w:tag"}),")"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Purpose"}),": Machine-readable identifier for mail merge"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Value"}),": String (your field name)"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<w:tag w:val="PropertyAddress"/>\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"In AppraiSys"}),": This maps to your merge field names in the template"]}),"\n",(0,s.jsxs)(n.h3,{id:"alias-walias",children:["Alias (",(0,s.jsx)(n.code,{children:"w:alias"}),")"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Purpose"}),": Human-readable display name"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Value"}),": String (displayed to users)"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<w:alias w:val="Property Street Address"/>\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Use"}),": Shows up in Word's Developer tab"]}),"\n",(0,s.jsxs)(n.h3,{id:"lock-settings-wlock",children:["Lock Settings (",(0,s.jsx)(n.code,{children:"w:lock"}),")"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Purpose"}),": Control editing behavior"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Values"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"unlocked"})," - Can edit and delete"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"sdtLocked"})," - Can edit content but not delete SDT"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"contentLocked"})," - Cannot edit content but can delete SDT"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"sdtContentLocked"})," - Cannot edit or delete"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<w:lock w:val="sdtContentLocked"/>\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Common in AppraiSys"}),": Lock SDTs after mail merge to prevent accidental changes"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"sdts-in-mail-merge",children:"SDTs in Mail Merge"}),"\n",(0,s.jsx)(n.h3,{id:"appraisys-pattern",children:"AppraiSys Pattern"}),"\n",(0,s.jsxs)(n.p,{children:["From ",(0,s.jsx)(n.code,{children:"SyncfusionFieldsPipelineStep.cs"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'// Document has SDTs with tags like "PropertyAddress", "AppraisedValue"\r\nDestinationDocument = new WordDocument(input.DocumentData, FormatType.Docx);\r\n\r\n// Mail merge clears and fills SDTs\r\nDestinationDocument.MailMerge.ClearFields = false;\r\nDestinationDocument.MailMerge.BeforeClearField += BeforeClearFieldWrapper;\r\n\r\n// Execute merge\r\nDestinationDocument.MailMerge.Execute(new List<string> { "" });\n'})}),"\n",(0,s.jsx)(n.h3,{id:"creating-sdt-for-mail-merge",children:"Creating SDT for Mail Merge"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'// Create block SDT with tag\r\nvar sdt = new SdtBlock();\r\n\r\n// Properties\r\nvar sdtProperties = new SdtProperties(\r\n    new Tag { Val = "PropertyAddress" },  // Match merge field\r\n    new Alias { Val = "Property Address" }\r\n);\r\nsdt.Append(sdtProperties);\r\n\r\n// Content with placeholder\r\nvar sdtContent = new SdtContentBlock();\r\nvar paragraph = new Paragraph();\r\nvar run = new Run();\r\nrun.Append(new RunProperties(new Color { Val = "0B5394" }));  // Blue placeholder\r\nrun.Append(new Text("[Property Address]"));\r\n\r\nparagraph.Append(run);\r\nsdtContent.Append(paragraph);\r\nsdt.Append(sdtContent);\r\n\r\nbody.Append(sdt);\n'})}),"\n",(0,s.jsx)(n.h3,{id:"merge-field-mapping",children:"Merge Field Mapping"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'\x3c!-- Template SDT --\x3e\r\n<w:sdt>\r\n  <w:sdtPr>\r\n    <w:tag w:val="AppraisedValue"/>\r\n  </w:sdtPr>\r\n  <w:sdtContent>\r\n    <w:p>\r\n      <w:r>\r\n        <w:rPr><w:color w:val="0B5394"/></w:rPr>\r\n        <w:t>[Value will be inserted]</w:t>\r\n      </w:r>\r\n    </w:p>\r\n  </w:sdtContent>\r\n</w:sdt>\r\n\r\n\x3c!-- After mail merge --\x3e\r\n<w:sdt>\r\n  <w:sdtPr>\r\n    <w:tag w:val="AppraisedValue"/>\r\n  </w:sdtPr>\r\n  <w:sdtContent>\r\n    <w:p>\r\n      <w:r>\r\n        <w:t>$450,000</w:t>\r\n      </w:r>\r\n    </w:p>\r\n  </w:sdtContent>\r\n</w:sdt>\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"common-sdt-mistakes",children:"Common SDT Mistakes"}),"\n",(0,s.jsx)(n.h3,{id:"-mistake-1-sdt-inside-run",children:"\u274c Mistake 1: SDT Inside Run"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"\x3c!-- WRONG --\x3e\r\n<w:p>\r\n  <w:r>\r\n    <w:sdt>...</w:sdt>\r\n  </w:r>\r\n</w:p>\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Fix"}),": Place SDT inside paragraph (for inline) or at body level (for block)"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"\x3c!-- CORRECT Inline --\x3e\r\n<w:p>\r\n  <w:sdt>\r\n    <w:sdtContent>\r\n      <w:r>...</w:r>\r\n    </w:sdtContent>\r\n  </w:sdt>\r\n</w:p>\r\n\r\n\x3c!-- CORRECT Block --\x3e\r\n<w:body>\r\n  <w:sdt>\r\n    <w:sdtContent>\r\n      <w:p>...</w:p>\r\n    </w:sdtContent>\r\n  </w:sdt>\r\n</w:body>\n"})}),"\n",(0,s.jsx)(n.h3,{id:"-mistake-2-empty-sdt-content",children:"\u274c Mistake 2: Empty SDT Content"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"\x3c!-- PROBLEMATIC --\x3e\r\n<w:sdt>\r\n  <w:sdtPr>...</w:sdtPr>\r\n  <w:sdtContent/>  \x3c!-- Empty! --\x3e\r\n</w:sdt>\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Fix"}),": Always have at least one paragraph"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"\x3c!-- CORRECT --\x3e\r\n<w:sdt>\r\n  <w:sdtPr>...</w:sdtPr>\r\n  <w:sdtContent>\r\n    <w:p/>  \x3c!-- Empty paragraph OK --\x3e\r\n  </w:sdtContent>\r\n</w:sdt>\n"})}),"\n",(0,s.jsx)(n.h3,{id:"-mistake-3-duplicate-ids",children:"\u274c Mistake 3: Duplicate IDs"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'\x3c!-- WRONG: Same ID used twice --\x3e\r\n<w:sdt>\r\n  <w:sdtPr>\r\n    <w:id w:val="123"/>\r\n  </w:sdtPr>\r\n  ...\r\n</w:sdt>\r\n\r\n<w:sdt>\r\n  <w:sdtPr>\r\n    <w:id w:val="123"/>  \x3c!-- Duplicate! --\x3e\r\n  </w:sdtPr>\r\n  ...\r\n</w:sdt>\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Fix"}),": Use unique IDs (SDK generates them automatically)"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"working-with-sdts-programmatically",children:"Working with SDTs Programmatically"}),"\n",(0,s.jsx)(n.h3,{id:"finding-sdts-by-tag",children:"Finding SDTs by Tag"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'using DocumentFormat.OpenXml.Packaging;\r\nusing DocumentFormat.OpenXml.Wordprocessing;\r\n\r\npublic SdtBlock FindSdtByTag(WordprocessingDocument doc, string tag)\r\n{\r\n    var sdts = doc.MainDocumentPart.Document.Body\r\n        .Descendants<SdtBlock>()\r\n        .Where(sdt => sdt.SdtProperties\r\n            .GetFirstChild<Tag>()?.Val == tag);\r\n    \r\n    return sdts.FirstOrDefault();\r\n}\r\n\r\n// Usage\r\nvar addressSdt = FindSdtByTag(doc, "PropertyAddress");\r\nif (addressSdt != null)\r\n{\r\n    // Update content\r\n    var content = addressSdt.SdtContentBlock;\r\n    content.RemoveAllChildren<Paragraph>();\r\n    content.Append(new Paragraph(\r\n        new Run(new Text("123 Main Street"))\r\n    ));\r\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"creating-inline-sdt",children:"Creating Inline SDT"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'public SdtRun CreateInlineSdt(string tag, string text)\r\n{\r\n    var sdt = new SdtRun();\r\n    \r\n    // Properties\r\n    sdt.SdtProperties = new SdtProperties(\r\n        new Tag { Val = tag },\r\n        new SdtId { Val = GenerateUniqueId() }\r\n    );\r\n    \r\n    // Content\r\n    var content = new SdtContentRun();\r\n    content.Append(new Run(new Text(text)));\r\n    sdt.Append(content);\r\n    \r\n    return sdt;\r\n}\r\n\r\n// Usage in paragraph\r\nparagraph.Append(new Run(new Text("Value: ")));\r\nparagraph.Append(CreateInlineSdt("Amount", "$450,000"));\n'})}),"\n",(0,s.jsx)(n.h3,{id:"creating-block-sdt",children:"Creating Block SDT"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'public SdtBlock CreateBlockSdt(string tag, params Paragraph[] paragraphs)\r\n{\r\n    var sdt = new SdtBlock();\r\n    \r\n    // Properties\r\n    sdt.SdtProperties = new SdtProperties(\r\n        new Tag { Val = tag },\r\n        new SdtId { Val = GenerateUniqueId() },\r\n        new Lock { Val = LockingValues.SdtContentLocked }\r\n    );\r\n    \r\n    // Content\r\n    var content = new SdtContentBlock();\r\n    foreach (var para in paragraphs)\r\n    {\r\n        content.Append(para);\r\n    }\r\n    sdt.Append(content);\r\n    \r\n    return sdt;\r\n}\r\n\r\n// Usage\r\nvar sdt = CreateBlockSdt(\r\n    "PropertyDescription",\r\n    new Paragraph(new Run(new Text("Line 1"))),\r\n    new Paragraph(new Run(new Text("Line 2")))\r\n);\r\nbody.Append(sdt);\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"nested-sdts",children:"Nested SDTs"}),"\n",(0,s.jsx)(n.h3,{id:"when-valid",children:"When Valid"}),"\n",(0,s.jsx)(n.p,{children:"SDTs can be nested if they're at different levels:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'\x3c!-- \u2705 VALID: Block SDT contains paragraph with inline SDT --\x3e\r\n<w:sdt>  \x3c!-- Block SDT --\x3e\r\n  <w:sdtPr><w:tag w:val="Section"/></w:sdtPr>\r\n  <w:sdtContent>\r\n    <w:p>\r\n      <w:r><w:t>Name: </w:t></w:r>\r\n      \r\n      <w:sdt>  \x3c!-- Inline SDT --\x3e\r\n        <w:sdtPr><w:tag w:val="Name"/></w:sdtPr>\r\n        <w:sdtContent>\r\n          <w:r><w:t>John</w:t></w:r>\r\n        </w:sdtContent>\r\n      </w:sdt>\r\n    </w:p>\r\n  </w:sdtContent>\r\n</w:sdt>\n'})}),"\n",(0,s.jsx)(n.h3,{id:"when-invalid",children:"When Invalid"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"\x3c!-- \u274c WRONG: Run inside SDT inside run --\x3e\r\n<w:p>\r\n  <w:r>\r\n    <w:sdt>...</w:sdt>  \x3c!-- Invalid! --\x3e\r\n  </w:r>\r\n</w:p>\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"sdt-persistence-after-merge",children:"SDT Persistence After Merge"}),"\n",(0,s.jsx)(n.h3,{id:"problem",children:"Problem"}),"\n",(0,s.jsx)(n.p,{children:'After mail merge, SDTs may be removed or "flattened":'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'\x3c!-- Before merge --\x3e\r\n<w:sdt>\r\n  <w:sdtPr><w:tag w:val="Field"/></w:sdtPr>\r\n  <w:sdtContent>\r\n    <w:p><w:r><w:t>[Placeholder]</w:t></w:r></w:p>\r\n  </w:sdtContent>\r\n</w:sdt>\r\n\r\n\x3c!-- After merge (SDT removed!) --\x3e\r\n<w:p>\r\n  <w:r><w:t>Actual Value</w:t></w:r>\r\n</w:p>\n'})}),"\n",(0,s.jsx)(n.h3,{id:"solution-in-appraisys",children:"Solution in AppraiSys"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"// Set ClearFields = false to keep SDT structure\r\nDestinationDocument.MailMerge.ClearFields = false;\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"repeating-sections",children:"Repeating Sections"}),"\n",(0,s.jsx)(n.h3,{id:"structure",children:"Structure"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"<w:sdt>\r\n  <w:sdtPr>\r\n    <w:repeatingSectionItem/>\r\n  </w:sdtPr>\r\n  <w:sdtContent>\r\n    \x3c!-- Template for each item --\x3e\r\n    <w:p>\r\n      <w:r><w:t>Item content</w:t></w:r>\r\n    </w:p>\r\n  </w:sdtContent>\r\n</w:sdt>\n"})}),"\n",(0,s.jsx)(n.h3,{id:"in-appraisys",children:"In AppraiSys"}),"\n",(0,s.jsx)(n.p,{children:"Used for comparable properties:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'// Create repeating section for comparables\r\nvar repeatingSdt = new SdtBlock();\r\nrepeatingSdt.SdtProperties = new SdtProperties(\r\n    new Tag { Val = "ComparablesList" },\r\n    new SdtRepeatingSection()\r\n);\r\n\r\n// Template for each comparable\r\nvar itemTemplate = new SdtBlock();\r\nitemTemplate.SdtProperties = new SdtProperties(\r\n    new SdtRepeatingItem()\r\n);\r\n\r\nvar itemContent = new SdtContentBlock();\r\nitemContent.Append(CreateComparableTemplate());\r\nitemTemplate.Append(itemContent);\r\n\r\nrepeatingSdt.SdtContentBlock.Append(itemTemplate);\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"visual-summary",children:"Visual Summary"}),"\n",(0,s.jsx)(n.mermaid,{value:"graph TD\r\n    A[SDT Types] --\x3e B[Block SDT]\r\n    A --\x3e C[Inline SDT]\r\n    \r\n    B --\x3e B1[Plain Text<br/>Multi-paragraph]\r\n    B --\x3e B2[Rich Text<br/>Formatted content]\r\n    B --\x3e B3[Table Container]\r\n    B --\x3e B4[Repeating Section]\r\n    \r\n    C --\x3e C1[Plain Text<br/>Single line]\r\n    C --\x3e C2[Drop-down]\r\n    C --\x3e C3[Date Picker]\r\n    C --\x3e C4[Checkbox]\r\n    \r\n    style A fill:#d4edda\r\n    style B fill:#fff3cd\r\n    style C fill:#e1f5ff"}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"quick-reference",children:"Quick Reference"}),"\n",(0,s.jsx)(n.h3,{id:"block-sdt-template",children:"Block SDT Template"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<w:sdt>\r\n  <w:sdtPr>\r\n    <w:id w:val="[unique-id]"/>\r\n    <w:tag w:val="[field-name]"/>\r\n  </w:sdtPr>\r\n  <w:sdtContent>\r\n    <w:p>\r\n      <w:r><w:t>[content]</w:t></w:r>\r\n    </w:p>\r\n  </w:sdtContent>\r\n</w:sdt>\n'})}),"\n",(0,s.jsx)(n.h3,{id:"inline-sdt-template",children:"Inline SDT Template"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<w:p>\r\n  <w:sdt>\r\n    <w:sdtPr>\r\n      <w:id w:val="[unique-id]"/>\r\n      <w:tag w:val="[field-name]"/>\r\n    </w:sdtPr>\r\n    <w:sdtContent>\r\n      <w:r><w:t>[content]</w:t></w:r>\r\n    </w:sdtContent>\r\n  </w:sdt>\r\n</w:p>\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,s.jsxs)(n.p,{children:["\u27a1\ufe0f ",(0,s.jsx)(n.strong,{children:"Next"}),": ",(0,s.jsx)(n.a,{href:"/docs/Intermediate/tables-in-ooxml",children:"Tables in OOXML"})," - Complete table guide"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Related"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/docs/Fundamentals/common-fatal-mistakes#fatal-mistake-1-sdt-inside-run",children:"Common Fatal Mistakes"})," - SDT placement errors"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/docs/Fundamentals/element-hierarchy-rules",children:"Element Hierarchy Rules"})," - Valid SDT locations"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"../05-Code%20examples/content-controls.md",children:"Code Examples"})," - Working code"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.p,{children:["\ud83d\udca1 ",(0,s.jsx)(n.strong,{children:"Remember"}),": SDTs are containers, not content. They hold paragraphs (block) or runs (inline), never the other way around!"]})]})}function p(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>d});var t=r(6540);const s={},l=t.createContext(s);function i(e){const n=t.useContext(l);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);