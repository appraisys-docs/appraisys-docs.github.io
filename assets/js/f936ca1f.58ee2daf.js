"use strict";(globalThis.webpackChunkappraisys_technical_documentation=globalThis.webpackChunkappraisys_technical_documentation||[]).push([[7958],{29087:(e,t,a)=>{a.d(t,{R:()=>i,x:()=>o});var n=a(96363);const r={},s=n.createContext(r);function i(e){const t=n.useContext(s);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),n.createElement(s.Provider,{value:t},e.children)}},52755:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>h,contentTitle:()=>o,default:()=>l,frontMatter:()=>i,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"OOXML-Specification/SpreadhsheetML/anatomyofOOXML-xlsx","title":"Package Structure","description":"A SpreadsheetML or .xlsx file is a zip file (a package) containing a number of \\"parts\\" (typically UTF-8 or UTF-16 encoded) or XML files.","source":"@site/docs/OOXML-Specification/SpreadhsheetML/anatomyofOOXML-xlsx.md","sourceDirName":"OOXML-Specification/SpreadhsheetML","slug":"/OOXML-Specification/SpreadhsheetML/anatomyofOOXML-xlsx","permalink":"/docs/OOXML-Specification/SpreadhsheetML/anatomyofOOXML-xlsx","draft":false,"unlisted":false,"editUrl":"https://gitlab.devcom.com/valuationpro/documentation/docs/OOXML-Specification/SpreadhsheetML/anatomyofOOXML-xlsx.md","tags":[],"version":"current","frontMatter":{"title":"Package Structure"},"sidebar":"tutorialSidebar","previous":{"title":"SpreadsheetStyles","permalink":"/docs/OOXML-Specification/SpreadhsheetML/SSstyles"},"next":{"title":"WordprocessingML","permalink":"/docs/OOXML-Specification/WordprocessingML/"}}');var r=a(47259),s=a(29087);const i={title:"Package Structure"},o="Package Structure",h={},c=[];function d(e){const t={a:"a",code:"code",h1:"h1",header:"header",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"package-structure",children:"Package Structure"})}),"\n",(0,r.jsx)(t.p,{children:'A SpreadsheetML or .xlsx file is a zip file (a package) containing a number of "parts" (typically UTF-8 or UTF-16 encoded) or XML files.\r\nThe package may also contain other media files such as images.\r\nThe structure is organized according to the Open Packaging Conventions as outlined in Part 2 of the OOXML standard ECMA-376.'}),"\n",(0,r.jsx)(t.p,{children:"You can look at the file structure and the files that comprise a SpreadsheetML file by simply unzipping the .xlsx file."}),"\n",(0,r.jsxs)(t.p,{children:["The number and types of parts will vary based on what is in the spreadsheet, but there will always be a [Content_Types].xml, one or more relationship parts, a workbook part , and at least one worksheet. The core data of the spreadsheet is contained within the worksheet part(s), discussed in more detail at ",(0,r.jsx)(t.a,{href:"/docs/OOXML-Specification/SpreadhsheetML/SScontentOverview",children:"xsxl Content Overview"}),"."]}),"\n",(0,r.jsx)(t.h1,{id:"content-types",children:"Content Types"}),"\n",(0,r.jsx)(t.p,{children:"Every package must have a [Content_Types].xml, found at the root of the package. This file contains a list of all of the content types of the\r\nparts in the package. Every part and its type must be listed in [Content_Types].xml. The following is a content type for the main content part:"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.code,{children:'<Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/>'})}),"\n",(0,r.jsx)(t.p,{children:"It's important to keep this in mind when adding new parts to the package."}),"\n",(0,r.jsx)(t.h1,{id:"relationships",children:"Relationships"}),"\n",(0,r.jsx)(t.p,{children:"Every package contains a relationships part that defines the relationships between the other parts and to resources outside of the package.\r\nThis separates the relationships from content and makes it easy to change relationships without changing the sources that reference targets."}),"\n",(0,r.jsx)(t.p,{children:"For an OOXML package, there is always a relationships part (.rels) within the _rels folder that identifies the starting parts of the package,\r\nor the package relationships.\r\nFor example, the following defines the identity of the start part for the content:"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.code,{children:'<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/>'}),"."]}),"\n",(0,r.jsx)(t.p,{children:"There are also typically relationships within .rels for app.xml and core.xml."}),"\n",(0,r.jsx)(t.p,{children:"In addition to the relationships part for the package, each part that is the source of one or more relationships will have its own relationships part.\r\nEach such relationship part is found within a _rels sub-folder of the part and is named by appending '.rels' to the name of the part."}),"\n",(0,r.jsx)(t.p,{children:"Typically the main content part (workbook.xml) has its own\r\nrelationships part (workbook.xml.rels). It will contain relationships to the other parts of the content, such as sheet1.xml, sharedStrings.xml, styles.xml, theme1,xml, as well as\r\nthe URIs for external links."}),"\n",(0,r.jsxs)(t.p,{children:["A relationship can be either explicit or implicit. For an explicit relationship, a resource is referenced using the\r\nId attribute of a ",(0,r.jsx)(t.code,{children:"<Relationship>"})," element. That is, the\r\nId in the source maps directly to an Id of a relationship item, with an explicit\r\nreference to the target."]}),"\n",(0,r.jsx)(t.p,{children:"For example, a worksheet might contain a hyperlink such as this:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-xml",children:'<w:hyperlink ref="A11" r:id="rId4">\n'})}),"\n",(0,r.jsxs)(t.p,{children:["The r",":id",'="rId4" references the following relationship within the relationships part for the worksheet (worksheet1.xml.rels).']}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-xml",children:'<Relationship Id="rId4" Type="http://. . ./hyperlink" Target="http://www.google.com/" TargetMode="External"/>\n'})}),"\n",(0,r.jsxs)(t.p,{children:["For an implicit relationship, there is no such direct reference to a ",(0,r.jsx)(t.code,{children:"<Relationship>"})," Id. Instead, the reference is understood."]}),"\n",(0,r.jsx)(t.h1,{id:"parts-specific-to-spreadsheetml-documents",children:"Parts Specific to SpreadsheetML Documents"}),"\n",(0,r.jsx)(t.p,{children:"Below is a list of the possible parts of a SpreadsheetML package that are specific to SpreadsheetML spreadsheets. Keep in mind that a spreadsheet may only have a few of these parts. For example, if a spreadsheet has no pivot table, then a pivot table part will not be included in the package."}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Part"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Calculation Chain"}),(0,r.jsx)(t.td,{children:"When the values of cells are calculated from formulas, the order of calculation can be affected by the order in which the values are calculated. This part contains specifies the ordering. A package can contain only one such part."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Chartsheet"}),(0,r.jsx)(t.td,{children:"Contains a chart that is stored in its owne sheet. A package can contain multiple such parts, referenced from the workbook part."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Comments"}),(0,r.jsx)(t.td,{children:"Contains the comments for a given worksheet. Since there may be more than one worksheet, there may be more than one comments part."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Connections"}),(0,r.jsx)(t.td,{children:"A spreadsheet may have connections to external data sources. This part contains such connections, explaining both how to get such externnal data and how the connection is used within the workbook. There may be only one such part."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Custom Property"}),(0,r.jsx)(t.td,{children:"Contains user-defined data. There may be zero or more such parts."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Customer XML Mappings"}),(0,r.jsx)(t.td,{children:"Contains a schema for an XML file, and information on the behavior to be used when allowing the schema to be mapped into the spreadsheet. There may be only one such part."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Dialogsheet"}),(0,r.jsx)(t.td,{children:"Contains information about a legacy customer dialog box for a user form. There may be zero or more such parts."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Drawings"}),(0,r.jsx)(t.td,{children:"Contains the presentation and layout information for one or more drawing elements that are present in the worksheet. There should be drawings part for each worksheet that has a drawing."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"External Workbook References"}),(0,r.jsx)(t.td,{children:"Contains information about data referenced in other spreadsheet packages. For example, a spreadsheet may have a cell whose value is calculated from data in another spreadsheet. There may be zero or more such parts."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Metadata"}),(0,r.jsx)(t.td,{children:"Contains information relating to a cell whose value is related to one or more other cells via Online Analytical Processing (OLAP) technology."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Pivot Table"}),(0,r.jsx)(t.td,{children:"Contains the definition of a pivot table. It describes the particulars of the layout of the pivot table, indicating what fields are on the row axis, the column axis, and values areas of the pivot table. And it indicates formatting for the pivot table. There is a pivot table part for each pivot table within the package."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Pivot Table Cache Definition"}),(0,r.jsx)(t.td,{children:"The pivot table cache definition defines each field in the pivot cache records part (i.e., the underlying data), including field name and information about the data contained in the field. There is a pivot table cahe definition part for each pivot table within the package."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Pivot Table Cache Records"}),(0,r.jsx)(t.td,{children:"Contains the underlying data for a pivot table. There will be zero or one such part for each pivot table in the package."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Query Table"}),(0,r.jsx)(t.td,{children:"Contains information that describes how the source table is connected to an external data source and defines the properties that are used when the table is refreshed from the source. There may be one such part for each table."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Shared String Table"}),(0,r.jsx)(t.td,{children:"Contains one occurrence of each unique string that occurs in any worksheet within the workbook. There is one such part for a package."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Shared Workbook Revision Log"}),(0,r.jsx)(t.td,{children:"Contains information about edits performed on individual cells in the workbook's worksheets. There should be one such part for each editing session"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Shared Workbook User Data"}),(0,r.jsx)(t.td,{children:"Contains a list of all users that are sharing the workbook. A package contained zero or one such part."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Single Cell Table Definition"}),(0,r.jsx)(t.td,{children:"Contains information on how to map non-repeating elements from a custom XML file into cells in a worksheet. There may be one such part per worksheet."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Styles"}),(0,r.jsx)(t.td,{children:"Contains all the characteristics for all cells in the workbook, including numeric and text formatting, alignment, font, color, and border. A package contains no more than one such part."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Table Definition"}),(0,r.jsx)(t.td,{children:"A spreadsheet can contain regions that have clearly labeled columns, rows, and data regions. Such regions are called tables, and each worksheet can have zero or more tables. For each table in a worksheet there must be a table definitions part containing a description of the table. (The data for the table is stored in the corresponding worksheet part.)"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Volatile Dependencies"}),(0,r.jsx)(t.td,{children:"Cells can contain real-time data formulas that return values that change over time and that require connectivity to programs outside of the workbook. In cases where those programs are not available, the formulas can use information stored in the volatile dependencies part. A package can have only one such part."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Workbook"}),(0,r.jsx)(t.td,{children:"Contains data and references to all of the worksheets. There must be one and only one workbook part."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Worksheet"}),(0,r.jsx)(t.td,{children:"Contains all the data, formulas, and characteristics of a given worksheet. There is one such part for each worksheet in the package."})]})]})]}),"\n",(0,r.jsx)(t.h1,{id:"parts-shared-by-other-ooxml-documents",children:"Parts Shared by Other OOXML Documents"}),"\n",(0,r.jsx)(t.p,{children:"There are a number of part types that may appear in any OOXML package. Below are some of the more relevant parts for SpreadsheetML documents."}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Part"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Embedded package"}),(0,r.jsx)(t.td,{children:"Contains a complete package, either internal or external to the referencing package. For example, a SpreadsheetML document might contain a Wordprocessing or PresentationML document."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Extended File Properties (often found at docProps/app.xml)"}),(0,r.jsx)(t.td,{children:"Contains properties specific to an OOXML document--properties such as the template used, the number of pages and words, and the application name and version."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"File Properties, Core"}),(0,r.jsxs)(t.td,{children:["Core file properties enable the user to discover and set common properties within a package--properties such as creator name, creation date, title. ",(0,r.jsx)(t.a,{href:"http://dublincore.org/",children:"Dublin Core"})," properties (a set of metadate terms used to describe resources) are used whenever possible."]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Image"}),(0,r.jsx)(t.td,{children:"Spreadsheets often contain images. An image can be stored in a package as a zip item. The item must be identified by an image part relationship and the appropriate content type."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Theme"}),(0,r.jsx)(t.td,{children:"DrawingML is a shared language across the OOXML document types. It includes a theme part that is included in SpreadsheetML documents when the spreadsheet uses a theme. The theme part contains information about a document's theme, that is, such information as the color scheme, font and format schemes."})]})]})]})]})}function l(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);