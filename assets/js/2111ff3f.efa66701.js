"use strict";(globalThis.webpackChunkappraisys_technical_documentation=globalThis.webpackChunkappraisys_technical_documentation||[]).push([[745],{9216:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"Fundamentals/document-structure-basics","title":"Document Structure Basics","description":"What is a DOCX File Really?","source":"@site/docs/01-Fundamentals/01-document-structure-basics.md","sourceDirName":"01-Fundamentals","slug":"/Fundamentals/document-structure-basics","permalink":"/docs/Fundamentals/document-structure-basics","draft":false,"unlisted":false,"editUrl":"https://gitlab.devcom.com/appraisys/Atlas/docs/01-Fundamentals/01-document-structure-basics.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{},"sidebar":"tutorialSidebar","next":{"title":"Relationship Files (.rels)","permalink":"/docs/Fundamentals/relationship-files"}}');var i=s(47259),l=s(29087);const t={},d="Document Structure Basics",o={},c=[{value:"What is a DOCX File Really?",id:"what-is-a-docx-file-really",level:2},{value:"The Big Revelation",id:"the-big-revelation",level:3},{value:"Exploring the Archive",id:"exploring-the-archive",level:2},{value:"Try It Yourself (5-minute exercise)",id:"try-it-yourself-5-minute-exercise",level:3},{value:"Key Files Breakdown",id:"key-files-breakdown",level:2},{value:"\ud83d\udcc4 <code>[Content_Types].xml</code>",id:"-content_typesxml",level:3},{value:"\ud83d\udcc1 <code>/_rels/</code> Folder",id:"-_rels-folder",level:3},{value:"\ud83d\udcc1 <code>/word/</code> Folder - The Heart of the Document",id:"-word-folder---the-heart-of-the-document",level:3},{value:"<code>document.xml</code> - <strong>THE MOST IMPORTANT FILE</strong>",id:"documentxml---the-most-important-file",level:4},{value:"<code>styles.xml</code> - Style Definitions",id:"stylesxml---style-definitions",level:4},{value:"<code>numbering.xml</code> - List Definitions",id:"numberingxml---list-definitions",level:4},{value:"<code>settings.xml</code> - Document Settings",id:"settingsxml---document-settings",level:4},{value:"<code>fontTable.xml</code> - Font Declarations",id:"fonttablexml---font-declarations",level:4},{value:"<code>/word/media/</code> - Embedded Images",id:"wordmedia---embedded-images",level:4},{value:"<code>/word/_rels/document.xml.rels</code> - Document Relationships",id:"word_relsdocumentxmlrels---document-relationships",level:4},{value:"Headers and Footers",id:"headers-and-footers",level:2},{value:"Document Properties (<code>/docProps/</code>)",id:"document-properties-docprops",level:2},{value:"<code>core.xml</code> - Core Properties",id:"corexml---core-properties",level:3},{value:"<code>app.xml</code> - Application Properties",id:"appxml---application-properties",level:3},{value:"Visual Summary",id:"visual-summary",level:2},{value:"Why This Matters",id:"why-this-matters",level:2},{value:"Practical Example: Manual Text Edit",id:"practical-example-manual-text-edit",level:2},{value:"How AppraiSys Uses This Structure",id:"how-appraisys-uses-this-structure",level:2},{value:"Reading Documents",id:"reading-documents",level:3},{value:"Creating Documents",id:"creating-documents",level:3},{value:"Working with Relationships",id:"working-with-relationships",level:3},{value:"Quick Reference: File Locations",id:"quick-reference-file-locations",level:2},{value:"Next Steps",id:"next-steps",level:2},{value:"Test Your Understanding",id:"test-your-understanding",level:2},{value:"Question 1",id:"question-1",level:3},{value:"Question 2",id:"question-2",level:3},{value:"Question 3",id:"question-3",level:3},{value:"\ud83d\udd27 Tools for Exploring DOCX Structure",id:"-tools-for-exploring-docx-structure",level:2},{value:"Open XML SDK Productivity Tool",id:"open-xml-sdk-productivity-tool",level:3},{value:"7-Zip / WinRAR",id:"7-zip--winrar",level:3},{value:"Oxygen XML Editor",id:"oxygen-xml-editor",level:3}];function a(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components},{Details:s}=n;return s||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"document-structure-basics",children:"Document Structure Basics"})}),"\n",(0,i.jsx)(n.h2,{id:"what-is-a-docx-file-really",children:"What is a DOCX File Really?"}),"\n",(0,i.jsxs)(n.p,{children:["A ",(0,i.jsx)(n.code,{children:".docx"})," file isn't a single file\u2014it's actually a ",(0,i.jsx)(n.strong,{children:"ZIP archive"})," containing multiple XML files and media resources. Understanding this structure is fundamental to working with OOXML."]}),"\n",(0,i.jsx)(n.h3,{id:"the-big-revelation",children:"The Big Revelation"}),"\n",(0,i.jsx)(n.mermaid,{value:'graph TD\r\n    A[sample.docx] --\x3e|Unzip| B[ZIP Archive]\r\n    B --\x3e C[/word/]\r\n    B --\x3e D[/_rels/]\r\n    B --\x3e E[/docProps/]\r\n    B --\x3e F["[Content_Types].xml"]\r\n    \r\n    C --\x3e C1[document.xml]\r\n    C --\x3e C2[styles.xml]\r\n    C --\x3e C3[numbering.xml]\r\n    C --\x3e C4[/media/]\r\n    C --\x3e C5[/_rels/]\r\n    \r\n    style A fill:#e1f5ff\r\n    style B fill:#fff3cd\r\n    style C fill:#d4edda'}),"\n",(0,i.jsxs)(n.p,{children:["\ud83d\udca1 ",(0,i.jsx)(n.strong,{children:"Pro Tip"}),": Rename any ",(0,i.jsx)(n.code,{children:".docx"})," file to ",(0,i.jsx)(n.code,{children:".zip"})," and open it with 7-Zip or WinRAR to explore its contents!"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"exploring-the-archive",children:"Exploring the Archive"}),"\n",(0,i.jsx)(n.h3,{id:"try-it-yourself-5-minute-exercise",children:"Try It Yourself (5-minute exercise)"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Take any DOCX file"}),"\n",(0,i.jsx)(n.li,{children:"Make a copy of it"}),"\n",(0,i.jsxs)(n.li,{children:["Rename the copy from ",(0,i.jsx)(n.code,{children:"document.docx"})," to ",(0,i.jsx)(n.code,{children:"document.zip"})]}),"\n",(0,i.jsx)(n.li,{children:"Open with 7-Zip, WinRAR, or Windows Explorer"}),"\n",(0,i.jsx)(n.li,{children:"Browse the internal structure"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"You'll see something like this:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"document.zip\r\n\u251c\u2500\u2500 [Content_Types].xml\r\n\u251c\u2500\u2500 _rels/\r\n\u2502   \u2514\u2500\u2500 .rels\r\n\u251c\u2500\u2500 docProps/\r\n\u2502   \u251c\u2500\u2500 app.xml\r\n\u2502   \u2514\u2500\u2500 core.xml\r\n\u2514\u2500\u2500 word/\r\n    \u251c\u2500\u2500 document.xml          \u2190 Main content here!\r\n    \u251c\u2500\u2500 styles.xml\r\n    \u251c\u2500\u2500 numbering.xml\r\n    \u251c\u2500\u2500 settings.xml\r\n    \u251c\u2500\u2500 fontTable.xml\r\n    \u251c\u2500\u2500 webSettings.xml\r\n    \u251c\u2500\u2500 _rels/\r\n    \u2502   \u2514\u2500\u2500 document.xml.rels \u2190 Relationships for images, etc.\r\n    \u251c\u2500\u2500 media/\r\n    \u2502   \u251c\u2500\u2500 image1.png\r\n    \u2502   \u2514\u2500\u2500 image2.jpg\r\n    \u251c\u2500\u2500 header1.xml           \u2190 If document has headers\r\n    \u2514\u2500\u2500 footer1.xml           \u2190 If document has footers\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"key-files-breakdown",children:"Key Files Breakdown"}),"\n",(0,i.jsxs)(n.h3,{id:"-content_typesxml",children:["\ud83d\udcc4 ",(0,i.jsx)(n.code,{children:"[Content_Types].xml"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Purpose"}),": MIME type registry for all parts in the package"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"What it does"}),": Tells Word what kind of content each file contains"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Example"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n<Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">\r\n  <Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/>\r\n  <Default Extension="xml" ContentType="application/xml"/>\r\n  <Default Extension="png" ContentType="image/png"/>\r\n  <Default Extension="jpeg" ContentType="image/jpeg"/>\r\n  <Override PartName="/word/document.xml" \r\n            ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml"/>\r\n  <Override PartName="/word/styles.xml" \r\n            ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml"/>\r\n</Types>\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\u26a0\ufe0f ",(0,i.jsx)(n.strong,{children:"Common Pitfall"}),": If you add a new part (like a header or image) but don't update this file, Word won't recognize it!"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h3,{id:"-_rels-folder",children:["\ud83d\udcc1 ",(0,i.jsx)(n.code,{children:"/_rels/"})," Folder"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Purpose"}),": Contains relationship files that connect document parts"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Key file"}),": ",(0,i.jsx)(n.code,{children:".rels"})," - The root relationships file"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"What it connects"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Main document part (",(0,i.jsx)(n.code,{children:"/word/document.xml"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:["Document properties (",(0,i.jsx)(n.code,{children:"/docProps/"}),")"]}),"\n",(0,i.jsx)(n.li,{children:"Custom XML parts"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsxs)(n.strong,{children:["Example ",(0,i.jsx)(n.code,{children:".rels"})]}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\r\n  <Relationship Id="rId1" \r\n                Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" \r\n                Target="word/document.xml"/>\r\n  <Relationship Id="rId2" \r\n                Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" \r\n                Target="docProps/core.xml"/>\r\n</Relationships>\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\ud83d\udd17 ",(0,i.jsx)(n.strong,{children:"See Also"}),": ",(0,i.jsx)(n.a,{href:"/docs/Fundamentals/relationship-files",children:"Relationship Files"})," for detailed explanation"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h3,{id:"-word-folder---the-heart-of-the-document",children:["\ud83d\udcc1 ",(0,i.jsx)(n.code,{children:"/word/"})," Folder - The Heart of the Document"]}),"\n",(0,i.jsx)(n.p,{children:"This is where all the document content lives."}),"\n",(0,i.jsxs)(n.h4,{id:"documentxml---the-most-important-file",children:[(0,i.jsx)(n.code,{children:"document.xml"})," - ",(0,i.jsx)(n.strong,{children:"THE MOST IMPORTANT FILE"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Purpose"}),": Contains the actual document content (all text, tables, images references)"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Structure"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n<w:document xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main">\r\n  <w:body>\r\n    <w:p>\r\n      <w:r>\r\n        <w:t>Hello World</w:t>\r\n      </w:r>\r\n    </w:p>\r\n  </w:body>\r\n</w:document>\n'})}),"\n",(0,i.jsx)(n.p,{children:"This simple example shows:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"w:document"})," - Root element"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"w:body"})," - Document body container"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"w:p"})," - Paragraph"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"w:r"})," - Run (text with consistent formatting)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"w:t"})," - Text node (actual text content)"]}),"\n"]}),"\n",(0,i.jsx)(n.mermaid,{value:"graph TD\r\n    A[document.xml] --\x3e B[w:document]\r\n    B --\x3e C[w:body]\r\n    C --\x3e D[w:p Paragraph]\r\n    C --\x3e E[w:tbl Table]\r\n    C --\x3e F[w:sdt Content Control]\r\n    \r\n    D --\x3e G[w:pPr Properties]\r\n    D --\x3e H[w:r Run]\r\n    \r\n    H --\x3e I[w:rPr Properties]\r\n    H --\x3e J[w:t Text]\r\n    \r\n    style A fill:#e1f5ff\r\n    style B fill:#fff3cd\r\n    style C fill:#d4edda"}),"\n",(0,i.jsxs)(n.h4,{id:"stylesxml---style-definitions",children:[(0,i.jsx)(n.code,{children:"styles.xml"})," - Style Definitions"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Purpose"}),": Defines all paragraph, character, table, and numbering styles"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Contains"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Built-in styles (Normal, Heading1, etc.)"}),"\n",(0,i.jsxs)(n.li,{children:["Custom styles (your system's ",(0,i.jsx)(n.code,{children:"NormalPlaceholder"}),", ",(0,i.jsx)(n.code,{children:"PropertyImagesTable"}),", etc.)"]}),"\n",(0,i.jsx)(n.li,{children:"Style hierarchy and inheritance"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Example"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<w:style w:type="paragraph" w:styleId="Normal">\r\n  <w:name w:val="Normal"/>\r\n  <w:qFormat/>\r\n  <w:rPr>\r\n    <w:rFonts w:ascii="Times New Roman" w:hAnsi="Times New Roman"/>\r\n    <w:sz w:val="24"/>  \x3c!-- 12pt font --\x3e\r\n  </w:rPr>\r\n</w:style>\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\ud83d\udd17 ",(0,i.jsx)(n.strong,{children:"See Also"}),": ",(0,i.jsx)(n.a,{href:"/docs/Intermediate/styles-in-depth",children:"Styles and Formatting"})]}),"\n",(0,i.jsxs)(n.h4,{id:"numberingxml---list-definitions",children:[(0,i.jsx)(n.code,{children:"numbering.xml"})," - List Definitions"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Purpose"}),": Defines numbering formats for ordered and unordered lists"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Why separate"}),": Multiple paragraphs can reference the same numbering definition"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Structure"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Abstract numbering definitions (templates)"}),"\n",(0,i.jsx)(n.li,{children:"Concrete numbering instances (actual usage)"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["\ud83d\udd17 ",(0,i.jsx)(n.strong,{children:"See Also"}),": ",(0,i.jsx)(n.a,{href:"/docs/Intermediate/numbering-and-lists",children:"Numbering and Lists"})]}),"\n",(0,i.jsxs)(n.h4,{id:"settingsxml---document-settings",children:[(0,i.jsx)(n.code,{children:"settings.xml"})," - Document Settings"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Purpose"}),": Document-level settings and configurations"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Contains"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"View settings (print view, web view)"}),"\n",(0,i.jsx)(n.li,{children:"Zoom level"}),"\n",(0,i.jsx)(n.li,{children:"Track changes settings"}),"\n",(0,i.jsx)(n.li,{children:"Compatibility settings"}),"\n",(0,i.jsx)(n.li,{children:"Default tab stop"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Usually"}),": Less critical for programmatic generation"]}),"\n",(0,i.jsxs)(n.h4,{id:"fonttablexml---font-declarations",children:[(0,i.jsx)(n.code,{children:"fontTable.xml"})," - Font Declarations"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Purpose"}),": Lists all fonts used in the document"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Example"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<w:font w:name="Times New Roman">\r\n  <w:panose1 w:val="02020603050405020304"/>\r\n  <w:charset w:val="00"/>\r\n  <w:family w:val="roman"/>\r\n  <w:pitch w:val="variable"/>\r\n</w:font>\n'})}),"\n",(0,i.jsxs)(n.h4,{id:"wordmedia---embedded-images",children:[(0,i.jsx)(n.code,{children:"/word/media/"})," - Embedded Images"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Purpose"}),": Stores all embedded images and media files"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"File naming"}),": Usually ",(0,i.jsx)(n.code,{children:"image1.png"}),", ",(0,i.jsx)(n.code,{children:"image2.jpeg"}),", etc."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Referenced by"}),": Relationship IDs in ",(0,i.jsx)(n.code,{children:"document.xml.rels"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Formats supported"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["PNG (",(0,i.jsx)(n.code,{children:".png"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:["JPEG (",(0,i.jsx)(n.code,{children:".jpg"}),", ",(0,i.jsx)(n.code,{children:".jpeg"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:["GIF (",(0,i.jsx)(n.code,{children:".gif"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:["SVG (",(0,i.jsx)(n.code,{children:".svg"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:["EMF/WMF (",(0,i.jsx)(n.code,{children:".emf"}),", ",(0,i.jsx)(n.code,{children:".wmf"}),") - Vector formats"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["\ud83d\udca1 ",(0,i.jsx)(n.strong,{children:"Pro Tip"}),": Images are stored as-is (no compression). Large images = large DOCX files!"]}),"\n",(0,i.jsxs)(n.h4,{id:"word_relsdocumentxmlrels---document-relationships",children:[(0,i.jsx)(n.code,{children:"/word/_rels/document.xml.rels"})," - Document Relationships"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Purpose"}),": Maps relationship IDs to actual resources"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"What it links"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Images to image files"}),"\n",(0,i.jsx)(n.li,{children:"Hyperlinks to URLs"}),"\n",(0,i.jsx)(n.li,{children:"Headers/footers to their XML files"}),"\n",(0,i.jsx)(n.li,{children:"Footnotes/endnotes to their XML files"}),"\n",(0,i.jsx)(n.li,{children:"Numbering definitions"}),"\n",(0,i.jsx)(n.li,{children:"Styles"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Example"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\r\n  <Relationship Id="rId1" \r\n                Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image" \r\n                Target="media/image1.png"/>\r\n  <Relationship Id="rId2" \r\n                Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink" \r\n                Target="https://example.com" \r\n                TargetMode="External"/>\r\n  <Relationship Id="rId3" \r\n                Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/header" \r\n                Target="header1.xml"/>\r\n</Relationships>\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"headers-and-footers",children:"Headers and Footers"}),"\n",(0,i.jsx)(n.p,{children:"If a document has headers or footers, you'll find them as separate XML files:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"/word/\r\n\u251c\u2500\u2500 header1.xml  \u2190 First page header\r\n\u251c\u2500\u2500 header2.xml  \u2190 Even pages header\r\n\u251c\u2500\u2500 header3.xml  \u2190 Odd pages header (default)\r\n\u251c\u2500\u2500 footer1.xml  \u2190 First page footer\r\n\u251c\u2500\u2500 footer2.xml  \u2190 Even pages footer\r\n\u2514\u2500\u2500 footer3.xml  \u2190 Odd pages footer (default)\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"How they work"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Each section can have different headers/footers"}),"\n",(0,i.jsxs)(n.li,{children:["Referenced via section properties (",(0,i.jsx)(n.code,{children:"w:sectPr"}),") in ",(0,i.jsx)(n.code,{children:"document.xml"})]}),"\n",(0,i.jsxs)(n.li,{children:["Linked through relationships in ",(0,i.jsx)(n.code,{children:"document.xml.rels"})]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["\ud83d\udd17 ",(0,i.jsx)(n.strong,{children:"See Also"}),": ",(0,i.jsx)(n.a,{href:"../03-Advanced/advanced-ooxml-internals.md#headers-and-footers",children:"Advanced OOXML Internals"})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h2,{id:"document-properties-docprops",children:["Document Properties (",(0,i.jsx)(n.code,{children:"/docProps/"}),")"]}),"\n",(0,i.jsxs)(n.h3,{id:"corexml---core-properties",children:[(0,i.jsx)(n.code,{children:"core.xml"})," - Core Properties"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Purpose"}),": Standard document metadata"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Contains"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Title"}),"\n",(0,i.jsx)(n.li,{children:"Subject"}),"\n",(0,i.jsx)(n.li,{children:"Author"}),"\n",(0,i.jsx)(n.li,{children:"Keywords"}),"\n",(0,i.jsx)(n.li,{children:"Created date"}),"\n",(0,i.jsx)(n.li,{children:"Modified date"}),"\n",(0,i.jsx)(n.li,{children:"Description"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Example"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<cp:coreProperties xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties">\r\n  <dc:title>Appraisal Report</dc:title>\r\n  <dc:creator>AppraiSys System</dc:creator>\r\n  <dcterms:created>2025-11-03T12:00:00Z</dcterms:created>\r\n  <dcterms:modified>2025-11-03T13:30:00Z</dcterms:modified>\r\n</cp:coreProperties>\n'})}),"\n",(0,i.jsxs)(n.h3,{id:"appxml---application-properties",children:[(0,i.jsx)(n.code,{children:"app.xml"})," - Application Properties"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Purpose"}),": Application-specific metadata"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Contains"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Application name (Microsoft Word)"}),"\n",(0,i.jsx)(n.li,{children:"Document template"}),"\n",(0,i.jsx)(n.li,{children:"Total editing time"}),"\n",(0,i.jsx)(n.li,{children:"Number of pages, words, characters"}),"\n",(0,i.jsx)(n.li,{children:"Company name"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"visual-summary",children:"Visual Summary"}),"\n",(0,i.jsx)(n.mermaid,{value:'graph TD\r\n    A["DOCX File<br/>(ZIP Archive)"] --\x3e B["[Content_Types].xml<br/>(MIME registry)"]\r\n    A --\x3e C["_rels/.rels<br/>(Root relationships)"]\r\n    A --\x3e D["docProps/<br/>(Metadata)"]\r\n    A --\x3e E["word/<br/>(MAIN CONTENT)"]\r\n    \r\n    E --\x3e E1["document.xml<br/>(Content)"]\r\n    E --\x3e E2["styles.xml<br/>(Styles)"]\r\n    E --\x3e E3["numbering.xml<br/>(Lists)"]\r\n    E --\x3e E4["settings.xml<br/>(Settings)"]\r\n    E --\x3e E5["media/<br/>(Images)"]\r\n    E --\x3e E6["_rels/document.xml.rels<br/>(Relationships)"]\r\n    E --\x3e E7["header/footer XML<br/>(If present)"]\r\n    \r\n    E1 -.->|References| E2\r\n    E1 -.->|References| E3\r\n    E1 -.->|References via| E6\r\n    E6 -.->|Links to| E5\r\n    E6 -.->|Links to| E7\r\n    \r\n    style A fill:#e1f5ff\r\n    style E fill:#d4edda\r\n    style E1 fill:#fff3cd'}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"why-this-matters",children:"Why This Matters"}),"\n",(0,i.jsx)(n.p,{children:"Understanding the DOCX structure helps you:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Debug Issues"}),": Know where to look when something breaks"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Understand Errors"}),': "Relationship not found" = check ',(0,i.jsx)(n.code,{children:".rels"})," files"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Programmatic Generation"}),": Know which files to create/modify"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Performance"}),": Understand why large documents are slow (many XML parts)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Manual Fixes"}),": Edit XML directly to repair corrupted documents"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"practical-example-manual-text-edit",children:"Practical Example: Manual Text Edit"}),"\n",(0,i.jsx)(n.p,{children:"Let's manually change text in a document:"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Steps"}),":"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Copy ",(0,i.jsx)(n.code,{children:"sample.docx"})," to ",(0,i.jsx)(n.code,{children:"sample.zip"})]}),"\n",(0,i.jsx)(n.li,{children:"Extract the ZIP"}),"\n",(0,i.jsxs)(n.li,{children:["Open ",(0,i.jsx)(n.code,{children:"/word/document.xml"})," in a text editor"]}),"\n",(0,i.jsxs)(n.li,{children:["Find ",(0,i.jsx)(n.code,{children:"<w:t>Original Text</w:t>"})]}),"\n",(0,i.jsxs)(n.li,{children:["Change to ",(0,i.jsx)(n.code,{children:"<w:t>New Text</w:t>"})]}),"\n",(0,i.jsx)(n.li,{children:"Save the file"}),"\n",(0,i.jsxs)(n.li,{children:["Re-ZIP all contents (important: ZIP the ",(0,i.jsx)(n.em,{children:"contents"}),", not the folder!)"]}),"\n",(0,i.jsxs)(n.li,{children:["Rename back to ",(0,i.jsx)(n.code,{children:".docx"})]}),"\n",(0,i.jsx)(n.li,{children:"Open in Word"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Result"}),": Text changed without opening Word!"]}),"\n",(0,i.jsxs)(n.p,{children:["\u26a0\ufe0f ",(0,i.jsx)(n.strong,{children:"Common Pitfall"}),": If you ZIP the folder instead of its contents, Word won't recognize the structure. The ",(0,i.jsx)(n.code,{children:"[Content_Types].xml"})," must be at the root of the ZIP."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"how-appraisys-uses-this-structure",children:"How AppraiSys Uses This Structure"}),"\n",(0,i.jsx)(n.p,{children:"In the AppraiSys codebase, you'll see:"}),"\n",(0,i.jsx)(n.h3,{id:"reading-documents",children:"Reading Documents"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"// Using DocumentFormat.OpenXml SDK\r\nusing var wordDoc = WordprocessingDocument.Open(stream, true);\r\nvar mainPart = wordDoc.MainDocumentPart;\r\nvar document = mainPart.Document;\r\nvar body = document.Body;\n"})}),"\n",(0,i.jsx)(n.h3,{id:"creating-documents",children:"Creating Documents"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"// From DefaultDocument.cs\r\nvar wordDocument = WordprocessingDocument.Create(stream, WordprocessingDocumentType.Document);\r\nvar mainPart = wordDocument.AddMainDocumentPart();\r\nmainPart.Document = new Document(new Body());\n"})}),"\n",(0,i.jsx)(n.h3,{id:"working-with-relationships",children:"Working with Relationships"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"// Adding an image\r\nvar imagePart = mainPart.AddImagePart(ImagePartType.Png);\r\nimagePart.FeedData(imageStream);\r\nstring relationshipId = mainPart.GetIdOfPart(imagePart);\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\ud83d\udd17 ",(0,i.jsx)(n.strong,{children:"See Also"}),": ",(0,i.jsx)(n.a,{href:"/docs/Code%20examples/creating-documents",children:"Creating Documents Code Examples"})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"quick-reference-file-locations",children:"Quick Reference: File Locations"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Content Type"}),(0,i.jsx)(n.th,{children:"File Location"}),(0,i.jsx)(n.th,{children:"Purpose"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Main content"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/word/document.xml"})}),(0,i.jsx)(n.td,{children:"All document content"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Styles"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/word/styles.xml"})}),(0,i.jsx)(n.td,{children:"Style definitions"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Lists"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/word/numbering.xml"})}),(0,i.jsx)(n.td,{children:"Numbering formats"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Images"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/word/media/"})}),(0,i.jsx)(n.td,{children:"Embedded images"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Headers"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/word/header*.xml"})}),(0,i.jsx)(n.td,{children:"Page headers"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Footers"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/word/footer*.xml"})}),(0,i.jsx)(n.td,{children:"Page footers"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Relationships"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/word/_rels/document.xml.rels"})}),(0,i.jsx)(n.td,{children:"Resource links"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Metadata"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/docProps/core.xml"})}),(0,i.jsx)(n.td,{children:"Document properties"})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,i.jsx)(n.p,{children:"Now that you understand the physical structure of DOCX files, learn how the parts connect:"}),"\n",(0,i.jsxs)(n.p,{children:["\u27a1\ufe0f ",(0,i.jsx)(n.strong,{children:"Next"}),": ",(0,i.jsx)(n.a,{href:"/docs/Fundamentals/relationship-files",children:"Relationship Files"})," - How document parts link together"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Also Important"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/docs/Fundamentals/wordprocessingml-core",children:"WordprocessingML Core"})," - Understanding the XML elements"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/docs/Fundamentals/element-hierarchy-rules",children:"Element Hierarchy Rules"})," - Valid structure rules"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"test-your-understanding",children:"Test Your Understanding"}),"\n",(0,i.jsx)(n.h3,{id:"question-1",children:"Question 1"}),"\n",(0,i.jsxs)(n.p,{children:["What happens if you add an image to ",(0,i.jsx)(n.code,{children:"/word/media/"})," but don't create a relationship in ",(0,i.jsx)(n.code,{children:"document.xml.rels"}),"?"]}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsx)("summary",{children:"Answer"}),(0,i.jsx)(n.p,{children:"The image won't appear in the document. Word needs the relationship to know that the image exists and how to reference it from the content."})]}),"\n",(0,i.jsx)(n.h3,{id:"question-2",children:"Question 2"}),"\n",(0,i.jsxs)(n.p,{children:["Can you have a valid DOCX file without a ",(0,i.jsx)(n.code,{children:"styles.xml"})," file?"]}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsx)("summary",{children:"Answer"}),(0,i.jsx)(n.p,{children:'Technically yes, but Word will use default styles. In practice, almost all documents have a styles.xml file defining at least the "Normal" style.'})]}),"\n",(0,i.jsx)(n.h3,{id:"question-3",children:"Question 3"}),"\n",(0,i.jsx)(n.p,{children:"What's the minimum set of files needed for a valid DOCX?"}),"\n",(0,i.jsxs)(s,{children:[(0,i.jsx)("summary",{children:"Answer"}),(0,i.jsx)(n.p,{children:"Minimum valid DOCX:"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"[Content_Types].xml"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"_rels/.rels"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"/word/document.xml"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"/word/_rels/document.xml.rels"})," (can be empty)"]}),"\n"]}),(0,i.jsx)(n.p,{children:"However, Word will add more files when you save."})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-tools-for-exploring-docx-structure",children:"\ud83d\udd27 Tools for Exploring DOCX Structure"}),"\n",(0,i.jsx)(n.h3,{id:"open-xml-sdk-productivity-tool",children:"Open XML SDK Productivity Tool"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Download"}),": ",(0,i.jsx)(n.a,{href:"https://github.com/OfficeDev/Open-XML-SDK/releases",children:"GitHub Releases"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Features"}),": Visual tree view, validation, C# code generation"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Best for"}),": Inspecting structure without manually unzipping"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"7-zip--winrar",children:"7-Zip / WinRAR"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Best for"}),": Quick extraction and exploration"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Tip"}),": Set to show XML files with syntax highlighting"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"oxygen-xml-editor",children:"Oxygen XML Editor"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Best for"}),": Advanced XML editing with validation"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Features"}),": Schema validation, XPath testing"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Note"}),": Commercial tool (optional)"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.p,{children:["\ud83d\udca1 ",(0,i.jsx)(n.strong,{children:"Remember"}),': A DOCX is just a ZIP file with XML inside. Once you understand this, the "magic" disappears and you can work with confidence!']})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},29087:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>d});var r=s(96363);const i={},l=r.createContext(i);function t(e){const n=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),r.createElement(l.Provider,{value:n},e.children)}}}]);